let n=window,e=60,r=performance.now(),t=0,o=0,f=r;const u=[],c=[],a=[],i=[];let s=[],l=[],m=-1,g=0;function p(){!function(){let n,m=0,g=1e3/e,p=0;for(m=0;m<u.length;m++)n=u[m],null!=n&&n.func(n.args);for(;s.length>0;)n=s.pop(),n.func(n.args);let h=performance.now();for(o=(h-r)/1e3,t=h-f,m=0;m<c.length;m++)n=c[m],h-n.time>n.delay&&(n.func(n.args),c.splice(m,1));for(h=performance.now();a.length>0;){if(n=a.shift(),p=performance.now(),!(p-h<g)){a.unshift(n);break}n.func(n.args)}for(h=performance.now();i.length>0;)n=i.shift(),p=performance.now(),p-h<g&&n.func(n.args);f=h,s=s.concat(l),l=[]}(),m=n.requestAnimationFrame(p)}p();var h={addEF:function(n,e){const r=++g;return u[r]={func:n,args:e},r},removeEF:function(n){return void 0!==u[n]&&(u[n]=null),-1},delay:function(n,e,r){const t=performance.now();c.push({func:n,args:e,delay:r,time:t})},next:function(n,e){l.push({func:n,args:e})},defer:function(n,e){a.push({func:n,args:e})},usurp:function(n,e){i.push({func:n,args:e})},setRequestAnimationFrameSource:function(e){m>-1&&window.cancelAnimationFrame(m),n=e,p()},setFrameRate:function(n){e=n},getElapsedTime:function(){return o},getDeltaTime:function(){return t}};export default h;
