import e from"events";import t from"shaders/height.frag";import r from"shaders/normal.frag";import n from"shaders/plane.vert";import i from"shaders/plane.frag";let a="123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ";window.fxhash="oo"+Array(49).fill(0).map((e=>a[Math.random()*a.length|0])).join("");let o=fxhash.slice(2),u=new RegExp(".{"+(fxhash.length/4|0)+"}","g"),s=o.match(u).map((e=>{return(t=e).split("").reduce(((e,r,n)=>e+a.indexOf(r)*Math.pow(a.length,t.length-n-1)),0);var t}));window.fxrand=((e,t,r,n)=>()=>{var i=((e|=0)+(t|=0)|0)+(n|=0)|0;return n=n+1|0,e=t^t>>>9,t=(r|=0)+(r<<3)|0,r=(r=r<<21|r>>>11)+i|0,(i>>>0)/4294967296})(...s);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var l={exports:{}};l.exports=function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=38)}([function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(1),u=n(r(44)),s=n(r(45)),l=n(r(46)),f=n(r(47)),c=(n(r(23)),r(48)),h=n(c),d=void 0,v=function(){function e(){i(this,e),this.canvas,this._viewport=[0,0,0,0],this._enabledVertexAttribute=[],this.identityMatrix=o.mat4.create(),this._normalMatrix=o.mat3.create(),this._inverseModelViewMatrix=o.mat3.create(),this._modelMatrix=o.mat4.create(),this._matrix=o.mat4.create(),this._matrixStacks=[],this._lastMesh=null,this._useWebGL2=!1,this._hasArrayInstance,this._extArrayInstance,this._hasCheckedExt=!1,o.mat4.identity(this.identityMatrix,this.identityMatrix),this.isMobile=!1,/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.isMobile=!0)}return a(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(null!=e){void 0!==this.canvas&&null!==this.canvas&&this.destroy(),this.canvas=e,this.setSize(window.innerWidth,window.innerHeight),t.useWebgl2=t.useWebgl2||!1;var r=void 0;t.useWebgl2&&(r=this.canvas.getContext("experimental-webgl2",t)||this.canvas.getContext("webgl2",t))?this._useWebGL2=!0:(r=this.canvas.getContext("webgl",t)||this.canvas.getContext("experimental-webgl",t),this._useWebGL2=!1),console.log("Using WebGL 2 ?",this.webgl2),this.initWithGL(r)}else console.error("Canvas not exist")}},{key:"initWithGL",value:function(e){this.canvas||(this.canvas=e.canvas),d=this.gl=e,this.extensions={};for(var t=0;t<h.default.length;t++)this.extensions[h.default[t]]=d.getExtension(h.default[t]);(0,s.default)(),(0,u.default)(d,"OES_vertex_array_object"),(0,u.default)(d,"ANGLE_instanced_arrays"),(0,u.default)(d,"WEBGL_draw_buffers"),this.enable(this.DEPTH_TEST),this.enable(this.CULL_FACE),this.enable(this.BLEND),this.enableAlphaBlending()}},{key:"setViewport",value:function(e,t,r,n){var i=!1;e!==this._viewport[0]&&(i=!0),t!==this._viewport[1]&&(i=!0),r!==this._viewport[2]&&(i=!0),n!==this._viewport[3]&&(i=!0),i&&(d.viewport(e,t,r,n),this._viewport=[e,t,r,n])}},{key:"scissor",value:function(e,t,r,n){d.scissor(e,t,r,n)}},{key:"clear",value:function(e,t,r,n){d.clearColor(e,t,r,n),d.clear(d.COLOR_BUFFER_BIT|d.DEPTH_BUFFER_BIT)}},{key:"setMatrices",value:function(e){this.camera=e,this.rotate(this.identityMatrix)}},{key:"useShader",value:function(e){this.shader=e,this.shaderProgram=this.shader.shaderProgram}},{key:"rotate",value:function(e){o.mat4.copy(this._modelMatrix,e),o.mat4.multiply(this._matrix,this.camera.matrix,this._modelMatrix),o.mat3.fromMat4(this._normalMatrix,this._matrix),o.mat3.invert(this._normalMatrix,this._normalMatrix),o.mat3.transpose(this._normalMatrix,this._normalMatrix),o.mat3.fromMat4(this._inverseModelViewMatrix,this._matrix),o.mat3.invert(this._inverseModelViewMatrix,this._inverseModelViewMatrix)}},{key:"draw",value:function(e,t){if(e.length)for(var r=0;r<e.length;r++)this.draw(e[r]);else{e.bind(this.shaderProgram),void 0!==this.camera&&(this.shader.uniform("uProjectionMatrix","mat4",this.camera.projection),this.shader.uniform("uViewMatrix","mat4",this.camera.matrix)),this.shader.uniform("uModelMatrix","mat4",this._modelMatrix),this.shader.uniform("uNormalMatrix","mat3",this._normalMatrix),this.shader.uniform("uModelViewMatrixInverse","mat3",this._inverseModelViewMatrix);var n=e.drawType;void 0!==t&&(n=t),e.isInstanced?d.drawElementsInstanced(e.drawType,e.iBuffer.numItems,d.UNSIGNED_SHORT,0,e.numInstance):n===d.POINTS?d.drawArrays(n,0,e.vertexSize):d.drawElements(n,e.iBuffer.numItems,d.UNSIGNED_SHORT,0),e.unbind()}}},{key:"drawTransformFeedback",value:function(e){var t=e.meshSource,r=e.meshDestination,n=e.numPoints,i=e.transformFeedback;t.bind(this.shaderProgram),r.generateBuffers(this.shaderProgram),d.bindTransformFeedback(d.TRANSFORM_FEEDBACK,i),r.attributes.forEach((function(e,t){d.bindBufferBase(d.TRANSFORM_FEEDBACK_BUFFER,t,e.buffer)})),d.enable(d.RASTERIZER_DISCARD),d.beginTransformFeedback(d.POINTS),d.drawArrays(d.POINTS,0,n),d.endTransformFeedback(),d.disable(d.RASTERIZER_DISCARD),d.useProgram(null),d.bindBuffer(d.ARRAY_BUFFER,null),r.attributes.forEach((function(e,t){d.bindBufferBase(d.TRANSFORM_FEEDBACK_BUFFER,t,null)})),d.bindTransformFeedback(d.TRANSFORM_FEEDBACK,null),t.unbind()}},{key:"setSize",value:function(e,t){this._width=e,this._height=t,this.canvas.width=this._width,this.canvas.height=this._height,this._aspectRatio=this._width/this._height,d&&this.viewport(0,0,this._width,this._height)}},{key:"showExtensions",value:function(){for(var e in console.log("Extensions : ",this.extensions),this.extensions)this.extensions[e]&&console.log(e,":",this.extensions[e])}},{key:"checkExtension",value:function(e){return!!this.extensions[e]}},{key:"getExtension",value:function(e){return this.extensions[e]}},{key:"enableAlphaBlending",value:function(){d.blendFunc(d.SRC_ALPHA,d.ONE_MINUS_SRC_ALPHA)}},{key:"enableAdditiveBlending",value:function(){d.blendFunc(d.ONE,d.ONE)}},{key:"pushMatrix",value:function(){var e=o.mat4.clone(this._modelMatrix);this._matrixStacks.push(e)}},{key:"popMatrix",value:function(){if(0==this._matrixStacks.length)return null;var e=this._matrixStacks.pop();this.rotate(e)}},{key:"enable",value:function(e){d.enable(e)}},{key:"disable",value:function(e){d.disable(e)}},{key:"viewport",value:function(e,t,r,n){this.setViewport(e,t,r,n)}},{key:"destroy",value:function(){if(this.canvas.parentNode)try{this.canvas.parentNode.removeChild(this.canvas)}catch(e){console.log("Error : ",e)}this.canvas=null}},{key:"FLOAT",get:function(){return(0,l.default)()}},{key:"HALF_FLOAT",get:function(){return(0,f.default)()}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"aspectRatio",get:function(){return this._aspectRatio}},{key:"webgl2",get:function(){return this._useWebGL2}}]),e}(),p=new v;t.default=p},function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0}),t.vec4=t.vec3=t.vec2=t.quat=t.mat4=t.mat3=t.mat2d=t.mat2=t.glMatrix=void 0;var i=n(r(3)),a=n(r(39)),o=n(r(40)),u=n(r(20)),s=n(r(41)),l=n(r(42)),f=n(r(43)),c=n(r(21)),h=n(r(22));t.glMatrix=i,t.mat2=a,t.mat2d=o,t.mat3=u,t.mat4=s,t.quat=l,t.vec2=f,t.vec3=c,t.vec4=h},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),s=(i=u)&&i.__esModule?i:{default:i},l=(r(49),function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}),f=function(e){for(var t=e.split("\n"),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t.join("\n")},c=function(e){return e.slice?e.slice(0):new Float32Array(e)},h=void 0,d=r(10),v=r(50),p={float:"uniform1f",vec2:"uniform2fv",vec3:"uniform3fv",vec4:"uniform4fv",int:"uniform1i",mat3:"uniformMatrix3fv",mat4:"uniformMatrix4fv"},_=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,i=arguments[2];n(this,e),h=s.default.gl,this.parameters=[],this.uniformTextures=[],this._varyings=i,t||(t=d),r||(r=d);var a=this._createShaderProgram(t,!0),o=this._createShaderProgram(r,!1);this._attachShaderProgram(a,o)}return o(e,[{key:"bind",value:function(){s.default.shader!==this&&(h.useProgram(this.shaderProgram),s.default.useShader(this),this.uniformTextures=[])}},{key:"uniform",value:function(e,t,r){if("object"!==(void 0===e?"undefined":a(e))){for(var n=p[t]||t,i=!1,o=void 0,u=-1,s=0;s<this.parameters.length;s++)if((o=this.parameters[s]).name===e){i=!0,u=s;break}var f=!1;i?(this.shaderProgram[e]=o.uniformLoc,f=o.isNumber):(f="uniform1i"===n||"uniform1f"===n,this.shaderProgram[e]=h.getUniformLocation(this.shaderProgram,e),f?this.parameters.push({name:e,type:n,value:r,uniformLoc:this.shaderProgram[e],isNumber:f}):this.parameters.push({name:e,type:n,value:c(r),uniformLoc:this.shaderProgram[e],isNumber:f}),u=this.parameters.length-1),this.parameters[u].uniformLoc&&(-1===n.indexOf("Matrix")?f?(this.parameters[u].value!==r||!i)&&(h[n](this.shaderProgram[e],r),this.parameters[u].value=r):l(this.parameters[u].value,r)&&i||(h[n](this.shaderProgram[e],r),this.parameters[u].value=c(r)):l(this.parameters[u].value,r)&&i||(h[n](this.shaderProgram[e],!1,r),this.parameters[u].value=c(r)))}else this.uniformObject(e)}},{key:"uniformObject",value:function(t){for(var r in t){var n=t[r],i=e.getUniformType(n);if(n.concat&&n[0].concat){for(var a=[],o=0;o<n.length;o++)a=a.concat(n[o]);n=a}this.uniform(r,i,n)}}},{key:"_createShaderProgram",value:function(e,t){var r=t?s.default.VERTEX_SHADER:s.default.FRAGMENT_SHADER,n=h.createShader(r);return h.shaderSource(n,e),h.compileShader(n),h.getShaderParameter(n,h.COMPILE_STATUS)?n:(console.warn("Error in Shader : ",h.getShaderInfoLog(n)),console.log(f(e)),null)}},{key:"_attachShaderProgram",value:function(e,t){this.shaderProgram=h.createProgram(),h.attachShader(this.shaderProgram,e),h.attachShader(this.shaderProgram,t),h.deleteShader(e),h.deleteShader(t),this._varyings&&(console.log("Transform feedback setup : ",this._varyings),h.transformFeedbackVaryings(this.shaderProgram,this._varyings,h.SEPARATE_ATTRIBS)),h.linkProgram(this.shaderProgram)}}]),e}();_.getUniformType=function(e){var t=function(e){return 9===e.length?"uniformMatrix3fv":16===e.length?"uniformMatrix4fv":"vec"+e.length};return e.concat?t(e[0].concat?e[0]:e):"float"},t.default=_},function(e,t,r){function n(e){t.ARRAY_TYPE=e}function i(e){return e*u}function a(e,t){return Math.abs(e-t)<=o*Math.max(1,Math.abs(e),Math.abs(t))}Object.defineProperty(t,"__esModule",{value:!0}),t.setMatrixArrayType=n,t.toRadian=i,t.equals=a;var o=t.EPSILON=1e-6;t.ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array;var u=(t.RANDOM=Math.random,Math.PI/180)},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(0),u=(i=o)&&i.__esModule?i:{default:i},s=function(){function e(t,r){n(this,e),this._mesh=t,this._shader=r}return a(e,[{key:"draw",value:function(){this._shader.bind(),u.default.draw(this.mesh)}},{key:"mesh",get:function(){return this._mesh}},{key:"shader",get:function(){return this._shader}}]),e}();t.default=s},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(0)),u=r(1),s=n(r(23)),l=void 0,f=function(e){var t=void 0;return void 0!==e.buffer?t=e.buffer:(t=l.createBuffer(),e.buffer=t),t},c=function(e,t){for(var r=[],n=0;n<e.length;n+=t){for(var i=[],a=0;a<t;a++)i.push(e[n+a]);r.push(i)}return r},h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];i(this,e),l=o.default.gl,this.drawType=t,this._attributes=[],this._numInstance=-1,this._enabledVertexAttribute=[],this._indices=[],this._faces=[],this._bufferChanged=[],this._hasIndexBufferChanged=!1,this._hasVAO=!1,this._isInstanced=!1,this._extVAO=!!o.default.gl.createVertexArray,this._useVAO=!!this._extVAO&&r}return a(e,[{key:"bufferVertex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this.bufferData(e,"aVertexPosition",3,t),this.normals.length<this.vertices.length&&this.bufferNormal(e,t),this}},{key:"bufferTexCoord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this.bufferData(e,"aTextureCoord",2,t),this}},{key:"bufferNormal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:35044;return this.bufferData(e,"aNormal",3,t),this}},{key:"bufferIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._drawType=t?l.DYNAMIC_DRAW:l.STATIC_DRAW,this._indices=new Uint16Array(e),this._numItems=this._indices.length,this}},{key:"bufferFlattenData",value:function(e,t,r){var n=c(e,r);return this.bufferData(n,t,r,35044,!1),this}},{key:"bufferData",value:function(e,t,r){var n=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:35044,o=[];for(r||(r=e[0].length),this._isInstanced=n||this._isInstanced,i=0;i<e.length;i++)for(var u=0;u<e[i].length;u++)o.push(e[i][u]);var s=new Float32Array(o),l=this.getAttribute(t);return l?(l.itemSize=r,l.dataArray=s,l.source=e):this._attributes.push({name:t,source:e,itemSize:r,drawType:a,dataArray:s,isInstanced:n}),this._bufferChanged.push(t),this}},{key:"bufferInstance",value:function(e,t){if(o.default.gl.vertexAttribDivisor){var r=e[0].length;this._numInstance=e.length,this.bufferData(e,t,r,35044,!0)}else console.error("Extension : ANGLE_instanced_arrays is not supported with this device !")}},{key:"bind",value:function(e){this.generateBuffers(e),this.hasVAO?l.bindVertexArray(this.vao):(this.attributes.forEach((function(e){l.bindBuffer(l.ARRAY_BUFFER,e.buffer);var t=e.attrPosition;l.vertexAttribPointer(t,e.itemSize,l.FLOAT,!1,0,0),e.isInstanced&&l.vertexAttribDivisor(t,1)})),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.iBuffer))}},{key:"generateBuffers",value:function(e){var t=this;0!=this._bufferChanged.length&&(this._useVAO?(this._vao||(this._vao=l.createVertexArray()),l.bindVertexArray(this._vao),this._attributes.forEach((function(r){if(-1!==t._bufferChanged.indexOf(r.name)){var n=f(r);l.bindBuffer(l.ARRAY_BUFFER,n),l.bufferData(l.ARRAY_BUFFER,r.dataArray,r.drawType);var i=(0,s.default)(l,e,r.name);l.enableVertexAttribArray(i),l.vertexAttribPointer(i,r.itemSize,l.FLOAT,!1,0,0),r.attrPosition=i,r.isInstanced&&l.vertexAttribDivisor(i,1)}})),this._updateIndexBuffer(),l.bindVertexArray(null),this._hasVAO=!0):(this._attributes.forEach((function(r){if(-1!==t._bufferChanged.indexOf(r.name)){var n=f(r);l.bindBuffer(l.ARRAY_BUFFER,n),l.bufferData(l.ARRAY_BUFFER,r.dataArray,r.drawType);var i=(0,s.default)(l,e,r.name);l.enableVertexAttribArray(i),l.vertexAttribPointer(i,r.itemSize,l.FLOAT,!1,0,0),r.attrPosition=i,r.isInstanced&&l.vertexAttribDivisor(i,1)}})),this._updateIndexBuffer()),this._hasIndexBufferChanged=!1,this._bufferChanged=[])}},{key:"unbind",value:function(){this._useVAO&&l.bindVertexArray(null),this._attributes.forEach((function(e){e.isInstanced&&l.vertexAttribDivisor(e.attrPosition,0)}))}},{key:"_updateIndexBuffer",value:function(){this._hasIndexBufferChanged||(this.iBuffer||(this.iBuffer=l.createBuffer()),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.iBuffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,this._indices,this._drawType),this.iBuffer.itemSize=1,this.iBuffer.numItems=this._numItems)}},{key:"computeNormals",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.generateFaces(),e?this._computeFaceNormals():this._computeVertexNormals()}},{key:"_computeFaceNormals",value:function(){for(var e=void 0,t=void 0,r=[],n=0;n<this._indices.length;n+=3){e=n/3;var i=(t=this._faces[e]).normal;r[t.indices[0]]=i,r[t.indices[1]]=i,r[t.indices[2]]=i}this.bufferNormal(r)}},{key:"_computeVertexNormals",value:function(){for(var e=void 0,t=u.vec3.create(),r=[],n=this.vertices,i=0;i<n.length;i++){u.vec3.set(t,0,0,0);for(var a=0;a<this._faces.length;a++)(e=this._faces[a]).indices.indexOf(i)>=0&&(t[0]+=e.normal[0],t[1]+=e.normal[1],t[2]+=e.normal[2]);u.vec3.normalize(t,t),r.push([t[0],t[1],t[2]])}this.bufferNormal(r)}},{key:"generateFaces",value:function(){for(var e=void 0,t=void 0,r=void 0,n=(u.vec3.create(),u.vec3.create(),u.vec3.create(),this.vertices),i=0;i<this._indices.length;i+=3){var a={indices:[e=this._indices[i],t=this._indices[i+1],r=this._indices[i+2]],vertices:[n[e],n[t],n[r]]};this._faces.push(a)}}},{key:"getAttribute",value:function(e){return this._attributes.find((function(t){return t.name===e}))}},{key:"getSource",value:function(e){var t=this.getAttribute(e);return t?t.source:[]}},{key:"vertices",get:function(){return this.getSource("aVertexPosition")}},{key:"normals",get:function(){return this.getSource("aNormal")}},{key:"coords",get:function(){return this.getSource("aTextureCoord")}},{key:"indices",get:function(){return this._indices}},{key:"vertexSize",get:function(){return this.vertices.length}},{key:"faces",get:function(){return this._faces}},{key:"attributes",get:function(){return this._attributes}},{key:"hasVAO",get:function(){return this._hasVAO}},{key:"vao",get:function(){return this._vao}},{key:"numInstance",get:function(){return this._numInstance}},{key:"isInstanced",get:function(){return this._isInstanced}}]),e}();t.default=h},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(5),a=(n=i)&&n.__esModule?n:{default:n},o={},u=void 0;o.plane=function(e,t,r){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"xy",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4,o=[],u=[],s=[],l=[],f=e/r,c=t/r,h=1/r,d=.5*-e,v=.5*-t,p=0,_=0;_<r;_++)for(var m=0;m<r;m++){var b=f*_+d,g=c*m+v,y=_/r,E=m/r;"xz"===n?(o.push([b,0,g+c]),o.push([b+f,0,g+c]),o.push([b+f,0,g]),o.push([b,0,g]),u.push([y,1-(E+h)]),u.push([y+h,1-(E+h)]),u.push([y+h,1-E]),u.push([y,1-E]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0]),l.push([0,1,0])):"yz"===n?(o.push([0,g,b]),o.push([0,g,b+f]),o.push([0,g+c,b+f]),o.push([0,g+c,b]),u.push([y,E]),u.push([y+h,E]),u.push([y+h,E+h]),u.push([y,E+h]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0]),l.push([1,0,0])):(o.push([b,g,0]),o.push([b+f,g,0]),o.push([b+f,g+c,0]),o.push([b,g+c,0]),u.push([y,E]),u.push([y+h,E]),u.push([y+h,E+h]),u.push([y,E+h]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1]),l.push([0,0,1])),s.push(4*p+0),s.push(4*p+1),s.push(4*p+2),s.push(4*p+0),s.push(4*p+2),s.push(4*p+3),p++}var M=new a.default(i);return M.bufferVertex(o),M.bufferTexCoord(u),M.bufferIndex(s),M.bufferNormal(l),M},o.sphere=function(e,t){function r(r,n){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=r/t*Math.PI-.5*Math.PI,o=n/t*Math.PI*2,u=i?1:e,s=[];s[1]=Math.sin(a)*u;var l=Math.cos(a)*u;return s[0]=Math.cos(o)*l,s[2]=Math.sin(o)*l,s[0]=Math.floor(1e4*s[0])/1e4,s[1]=Math.floor(1e4*s[1])/1e4,s[2]=Math.floor(1e4*s[2])/1e4,s}for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,o=[],u=[],s=[],l=[],f=1/t,c=0,h=0;h<t;h++)for(var d=0;d<t;d++){o.push(r(h,d)),o.push(r(h+1,d)),o.push(r(h+1,d+1)),o.push(r(h,d+1)),l.push(r(h,d,!0)),l.push(r(h+1,d,!0)),l.push(r(h+1,d+1,!0)),l.push(r(h,d+1,!0));var v=d/t,p=h/t;u.push([1-v,p]),u.push([1-v,p+f]),u.push([1-v-f,p+f]),u.push([1-v-f,p]),s.push(4*c+0),s.push(4*c+1),s.push(4*c+2),s.push(4*c+0),s.push(4*c+2),s.push(4*c+3),c++}n&&s.reverse();var _=new a.default(i);return _.bufferVertex(o),_.bufferTexCoord(u),_.bufferIndex(s),_.bufferNormal(l),_},o.cube=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:4,i=e/2,o=(t=t||e)/2,u=(r=r||e)/2,s=[],l=[],f=[],c=[],h=0;s.push([-i,o,-u]),s.push([i,o,-u]),s.push([i,-o,-u]),s.push([-i,-o,-u]),c.push([0,0,-1]),c.push([0,0,-1]),c.push([0,0,-1]),c.push([0,0,-1]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),f.push(4*h+0),f.push(4*h+1),f.push(4*h+2),f.push(4*h+0),f.push(4*h+2),f.push(4*h+3),h++,s.push([i,o,-u]),s.push([i,o,u]),s.push([i,-o,u]),s.push([i,-o,-u]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0]),c.push([1,0,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),f.push(4*h+0),f.push(4*h+1),f.push(4*h+2),f.push(4*h+0),f.push(4*h+2),f.push(4*h+3),h++,s.push([i,o,u]),s.push([-i,o,u]),s.push([-i,-o,u]),s.push([i,-o,u]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]),c.push([0,0,1]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),f.push(4*h+0),f.push(4*h+1),f.push(4*h+2),f.push(4*h+0),f.push(4*h+2),f.push(4*h+3),h++,s.push([-i,o,u]),s.push([-i,o,-u]),s.push([-i,-o,-u]),s.push([-i,-o,u]),c.push([-1,0,0]),c.push([-1,0,0]),c.push([-1,0,0]),c.push([-1,0,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),f.push(4*h+0),f.push(4*h+1),f.push(4*h+2),f.push(4*h+0),f.push(4*h+2),f.push(4*h+3),h++,s.push([i,o,-u]),s.push([-i,o,-u]),s.push([-i,o,u]),s.push([i,o,u]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0]),c.push([0,1,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),f.push(4*h+0),f.push(4*h+1),f.push(4*h+2),f.push(4*h+0),f.push(4*h+2),f.push(4*h+3),h++,s.push([i,-o,u]),s.push([-i,-o,u]),s.push([-i,-o,-u]),s.push([i,-o,-u]),c.push([0,-1,0]),c.push([0,-1,0]),c.push([0,-1,0]),c.push([0,-1,0]),l.push([0,0]),l.push([1,0]),l.push([1,1]),l.push([0,1]),f.push(4*h+0),f.push(4*h+1),f.push(4*h+2),f.push(4*h+0),f.push(4*h+2),f.push(4*h+3),h++;var d=new a.default(n);return d.bufferVertex(s),d.bufferTexCoord(l),d.bufferIndex(f),d.bufferNormal(c),d},o.skybox=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[],n=[],i=[],o=[],u=0;r.push([e,e,-e]),r.push([-e,e,-e]),r.push([-e,-e,-e]),r.push([e,-e,-e]),o.push([0,0,-1]),o.push([0,0,-1]),o.push([0,0,-1]),o.push([0,0,-1]),n.push([0,0]),n.push([1,0]),n.push([1,1]),n.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,r.push([e,-e,-e]),r.push([e,-e,e]),r.push([e,e,e]),r.push([e,e,-e]),o.push([1,0,0]),o.push([1,0,0]),o.push([1,0,0]),o.push([1,0,0]),n.push([0,0]),n.push([1,0]),n.push([1,1]),n.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,r.push([-e,e,e]),r.push([e,e,e]),r.push([e,-e,e]),r.push([-e,-e,e]),o.push([0,0,1]),o.push([0,0,1]),o.push([0,0,1]),o.push([0,0,1]),n.push([0,0]),n.push([1,0]),n.push([1,1]),n.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,r.push([-e,-e,e]),r.push([-e,-e,-e]),r.push([-e,e,-e]),r.push([-e,e,e]),o.push([-1,0,0]),o.push([-1,0,0]),o.push([-1,0,0]),o.push([-1,0,0]),n.push([0,0]),n.push([1,0]),n.push([1,1]),n.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,r.push([e,e,e]),r.push([-e,e,e]),r.push([-e,e,-e]),r.push([e,e,-e]),o.push([0,1,0]),o.push([0,1,0]),o.push([0,1,0]),o.push([0,1,0]),n.push([0,0]),n.push([1,0]),n.push([1,1]),n.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3),u++,r.push([e,-e,-e]),r.push([-e,-e,-e]),r.push([-e,-e,e]),r.push([e,-e,e]),o.push([0,-1,0]),o.push([0,-1,0]),o.push([0,-1,0]),o.push([0,-1,0]),n.push([0,0]),n.push([1,0]),n.push([1,1]),n.push([0,1]),i.push(4*u+0),i.push(4*u+1),i.push(4*u+2),i.push(4*u+0),i.push(4*u+2),i.push(4*u+3);var s=new a.default(t);return s.bufferVertex(r),s.bufferTexCoord(n),s.bufferIndex(i),s.bufferNormal(o),s},o.bigTriangle=function(){if(!u){var e=[2,1,0],t=[[-1,-1],[-1,4],[4,-1]];(u=new a.default).bufferData(t,"aPosition",2),u.bufferIndex(e)}return u},t.default=o},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this._delayTasks=[],this._nextTasks=[],this._deferTasks=[],this._highTasks=[],this._usurpTask=[],this._enterframeTasks=[],this._idTable=0,this._startTime=(new Date).getTime(),this._deltaTime=0,this._loop()}return i(e,[{key:"addEF",value:function(e,t){t=t||[];var r=this._idTable;return this._enterframeTasks[r]={func:e,params:t},this._idTable++,r}},{key:"removeEF",value:function(e){return void 0!==this._enterframeTasks[e]&&(this._enterframeTasks[e]=null),-1}},{key:"delay",value:function(e,t,r){var n={func:e,params:t,delay:r,time:(new Date).getTime()};this._delayTasks.push(n)}},{key:"defer",value:function(e,t){var r={func:e,params:t};this._deferTasks.push(r)}},{key:"next",value:function(e,t){var r={func:e,params:t};this._nextTasks.push(r)}},{key:"usurp",value:function(e,t){var r={func:e,params:t};this._usurpTask.push(r)}},{key:"_process",value:function(){var e=0,t=void 0,r=void 0;for(e=0;e<this._enterframeTasks.length;e++)null!==(t=this._enterframeTasks[e])&&void 0!==t&&t.func(t.params);for(;this._highTasks.length>0;)(t=this._highTasks.pop()).func(t.params);var n=(new Date).getTime();for(this._deltaTime=(n-this._startTime)/1e3,e=0;e<this._delayTasks.length;e++)n-(t=this._delayTasks[e]).time>t.delay&&(t.func(t.params),this._delayTasks.splice(e,1));for(n=(new Date).getTime(),this._deltaTime=(n-this._startTime)/1e3,r=1e3/60;this._deferTasks.length>0;){if(t=this._deferTasks.shift(),!((new Date).getTime()-n<r)){this._deferTasks.unshift(t);break}t.func(t.params)}for(n=(new Date).getTime(),this._deltaTime=(n-this._startTime)/1e3,r=1e3/60;this._usurpTask.length>0;)t=this._usurpTask.shift(),(new Date).getTime()-n<r&&t.func(t.params);this._highTasks=this._highTasks.concat(this._nextTasks),this._nextTasks=[],this._usurpTask=[]}},{key:"_loop",value:function(){var e=this;this._process(),window.requestAnimationFrame((function(){return e._loop()}))}},{key:"deltaTime",get:function(){return this._deltaTime}}]),e}(),o=new a;t.default=o},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(2)),u=n(r(12)),s=n(r(29)),l=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;i(this,e),this.shader=new o.default(s.default.bigTriangleVert,t),this._width=r,this._height=n,this._uniforms={},this._hasOwnFbo=this._width>0&&this._width>0,this._uniforms={},this._hasOwnFbo&&(this._fbo=new u.default(this._width,this.height,mParmas))}return a(e,[{key:"uniform",value:function(e,t){this._uniforms[e]=t}},{key:"render",value:function(e){this.shader.bind(),this.shader.uniform("texture","uniform1i",0),e.bind(0),this.shader.uniform(this._uniforms)}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"fbo",get:function(){return this._fbo}},{key:"hasFbo",get:function(){return this._hasOwnFbo}}]),e}();t.default=l},function(e,t){e.exports="// simpleColor.frag\n\n#define SHADER_NAME SIMPLE_COLOR\n\nprecision mediump float;\n#define GLSLIFY 1\n\nuniform vec3 color;\nuniform float opacity;\n\nvoid main(void) {\n    gl_FragColor = vec4(color, opacity);\n}"},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n}"},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return 0!==e&&!(e&e-1)}function a(e){var t=e.width||e.videoWidth,r=e.height||e.videoHeight;return!(!t||!r)&&i(t)&&i(r)}Object.defineProperty(t,"__esModule",{value:!0});var o,u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(0),l=(o=s)&&o.__esModule?o:{default:o},f=void 0,c=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(n(this,e),f=l.default.gl,r)this._texture=t;else{this._mSource=t,this._texture=f.createTexture(),this._isVideo="VIDEO"===t.tagName,this._premultiplyAlpha=!0,this._magFilter=i.magFilter||f.LINEAR,this._minFilter=i.minFilter||f.NEAREST_MIPMAP_LINEAR,this._wrapS=i.wrapS||f.MIRRORED_REPEAT,this._wrapT=i.wrapT||f.MIRRORED_REPEAT,(t.width||t.videoWidth)&&a(t)||(this._wrapS=this._wrapT=f.CLAMP_TO_EDGE,this._minFilter===f.NEAREST_MIPMAP_LINEAR&&(this._minFilter=f.LINEAR)),f.bindTexture(f.TEXTURE_2D,this._texture),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!0),t.exposure?f.texImage2D(f.TEXTURE_2D,0,f.RGBA,t.shape[0],t.shape[1],0,f.RGBA,f.FLOAT,t.data):f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,this._magFilter),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this._minFilter),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,this._wrapS),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,this._wrapT);var o=l.default.getExtension("EXT_texture_filter_anisotropic");if(o){var u=f.getParameter(o.MAX_TEXTURE_MAX_ANISOTROPY_EXT);f.texParameterf(f.TEXTURE_2D,o.TEXTURE_MAX_ANISOTROPY_EXT,u)}this._canGenerateMipmap()&&f.generateMipmap(f.TEXTURE_2D),f.bindTexture(f.TEXTURE_2D,null)}}return u(e,[{key:"generateMipmap",value:function(){this._canGenerateMipmap()&&(f.bindTexture(f.TEXTURE_2D,this._texture),f.generateMipmap(f.TEXTURE_2D),f.bindTexture(f.TEXTURE_2D,null))}},{key:"updateTexture",value:function(e){e&&(this._mSource=e),f.bindTexture(f.TEXTURE_2D,this._texture),f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,!0),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,this._mSource),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,this._magFilter),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this._minFilter),this._canGenerateMipmap()&&f.generateMipmap(f.TEXTURE_2D),f.bindTexture(f.TEXTURE_2D,null)}},{key:"bind",value:function(e){void 0===e&&(e=0),l.default.shader&&(f.activeTexture(f.TEXTURE0+e),f.bindTexture(f.TEXTURE_2D,this._texture),this._bindIndex=e)}},{key:"_canGenerateMipmap",value:function(){return this._minFilter===f.LINEAR_MIPMAP_NEAREST||this._minFilter===f.NEAREST_MIPMAP_LINEAR||this._minFilter===f.LINEAR_MIPMAP_LINEAR||this._minFilter===f.NEAREST_MIPMAP_NEAREST}},{key:"minFilter",set:function(e){if(e!==f.LINEAR&&e!==f.NEAREST&&e!==f.NEAREST_MIPMAP_LINEAR&&e!==f.NEAREST_MIPMAP_LINEAR&&e!==f.LINEAR_MIPMAP_LINEAR&&e!==f.NEAREST_MIPMAP_NEAREST)return this;this._minFilter=e,f.bindTexture(f.TEXTURE_2D,this._texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this._minFilter),f.bindTexture(f.TEXTURE_2D,null)},get:function(){return this._minFilter}},{key:"magFilter",set:function(e){if(e!==f.LINEAR&&e!==f.NEAREST)return this;this._magFilter=e,f.bindTexture(f.TEXTURE_2D,this._texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,this._magFilter),f.bindTexture(f.TEXTURE_2D,null)},get:function(){return this._magFilter}},{key:"wrapS",set:function(e){if(e!==f.CLAMP_TO_EDGE&&e!==f.REPEAT&&e!==f.MIRRORED_REPEAT)return this;this._wrapS=e,f.bindTexture(f.TEXTURE_2D,this._texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,this._wrapS),f.bindTexture(f.TEXTURE_2D,null)},get:function(){return this._wrapS}},{key:"wrapT",set:function(e){if(e!==f.CLAMP_TO_EDGE&&e!==f.REPEAT&&e!==f.MIRRORED_REPEAT)return this;this._wrapT=e,f.bindTexture(f.TEXTURE_2D,this._texture),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,this._wrapT),f.bindTexture(f.TEXTURE_2D,null)},get:function(){return this._wrapT}},{key:"premultiplyAlpha",set:function(e){this._premultiplyAlpha=e,f.bindTexture(f.TEXTURE_2D,this._texture),console.log("premultiplyAlpha:",e),f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this._premultiplyAlpha),f.bindTexture(f.TEXTURE_2D,null)},get:function(){return this._premultiplyAlpha}},{key:"texture",get:function(){return this._texture}}]),e}(),h=void 0,d=void 0,v=void 0;c.whiteTexture=function(){if(void 0===h){var e=document.createElement("canvas");e.width=e.height=4;var t=e.getContext("2d");t.fillStyle="#fff",t.fillRect(0,0,4,4),h=new c(e)}return h},c.greyTexture=function(){if(void 0===d){var e=document.createElement("canvas");e.width=e.height=4;var t=e.getContext("2d");t.fillStyle="rgb(127, 127, 127)",t.fillRect(0,0,4,4),d=new c(e)}return d},c.blackTexture=function(){if(void 0===v){var e=document.createElement("canvas");e.width=e.height=4;var t=e.getContext("2d");t.fillStyle="rgb(127, 127, 127)",t.fillRect(0,0,4,4),v=new c(e)}return v},t.default=c},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return 0!==e&&!(e&e-1)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=n(r(0)),s=n(r(11)),l=void 0,f=void 0,c=void 0,h=function(){return!!u.default.webgl2||!!(c=u.default.getExtension("WEBGL_draw_buffers"))},d=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i(this,e),l=u.default.gl,f=u.default.checkExtension("WEBGL_depth_texture"),this.width=t,this.height=r,this._multipleTargets=o,this.magFilter=n.magFilter||l.LINEAR,this.minFilter=n.minFilter||l.LINEAR_MIPMAP_NEAREST,this.wrapS=n.wrapS||l.CLAMP_TO_EDGE,this.wrapT=n.wrapT||l.CLAMP_TO_EDGE,this.useDepth=n.useDepth||!0,this.useStencil=n.useStencil||!1,this.texelType=n.type,a(this.width)&&a(this.height)||(this.wrapS=this.wrapT=l.CLAMP_TO_EDGE,this.minFilter===l.LINEAR_MIPMAP_NEAREST&&(this.minFilter=l.LINEAR)),h(),this._init()}return o(e,[{key:"_init",value:function(){var e=l.UNSIGNED_BYTE;if(this.texelType&&(e=this.texelType),this.texelType=e,this._textures=[],this._initTextures(),this.frameBuffer=l.createFramebuffer(),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer),u.default.webgl2){for(var t=[],r=0;r<this._textures.length;r++)l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0+r,l.TEXTURE_2D,this._textures[r].texture,0),t.push(l["COLOR_ATTACHMENT"+r]);l.drawBuffers(t),l.framebufferTexture2D(l.DRAW_FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,this.glDepthTexture.texture,0)}else{for(var n=0;n<this._textures.length;n++)l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0+n,l.TEXTURE_2D,this._textures[n].texture,0);this._multipleTargets&&c.drawBuffersWEBGL([c.COLOR_ATTACHMENT0_WEBGL,c.COLOR_ATTACHMENT1_WEBGL,c.COLOR_ATTACHMENT2_WEBGL,c.COLOR_ATTACHMENT3_WEBGL]),f&&l.framebufferTexture2D(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.TEXTURE_2D,this.glDepthTexture.texture,0)}if(this.minFilter===l.LINEAR_MIPMAP_NEAREST)for(var i=0;i<this._textures.length;i++)l.bindTexture(l.TEXTURE_2D,this._textures[i].texture),l.generateMipmap(l.TEXTURE_2D);l.checkFramebufferStatus(l.FRAMEBUFFER)!=l.FRAMEBUFFER_COMPLETE&&console.log("GL_FRAMEBUFFER_COMPLETE failed, CANNOT use Framebuffer"),l.bindTexture(l.TEXTURE_2D,null),l.bindRenderbuffer(l.RENDERBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,null),this.clear()}},{key:"_initTextures",value:function(){for(var e=(this._multipleTargets,0);e<4;e++){var t=this._createTexture();this._textures.push(t)}u.default.webgl2?this.glDepthTexture=this._createTexture(l.DEPTH_COMPONENT16,l.UNSIGNED_SHORT,l.DEPTH_COMPONENT,!0):this.glDepthTexture=this._createTexture(l.DEPTH_COMPONENT,l.UNSIGNED_SHORT)}},{key:"_createTexture",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];void 0===e&&(e=l.RGBA),void 0===t&&(t=this.texelType),r||(r=e);var i=l.createTexture(),a=new s.default(i,!0),o=n?u.default.NEAREST:this.magFilter,f=n?u.default.NEAREST:this.minFilter;return l.bindTexture(l.TEXTURE_2D,i),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,o),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,f),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,this.wrapS),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,this.wrapT),l.texImage2D(l.TEXTURE_2D,0,e,this.width,this.height,0,r,t,null),l.bindTexture(l.TEXTURE_2D,null),a}},{key:"bind",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&u.default.viewport(0,0,this.width,this.height),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer)}},{key:"unbind",value:function(){if((!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&u.default.viewport(0,0,u.default.width,u.default.height),l.bindFramebuffer(l.FRAMEBUFFER,null),this.minFilter===l.LINEAR_MIPMAP_NEAREST)for(var e=0;e<this._textures.length;e++)l.bindTexture(l.TEXTURE_2D,this._textures[e].texture),l.generateMipmap(l.TEXTURE_2D)}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.bind(),u.default.clear(e,t,r,n),this.unbind()}},{key:"getTexture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this._textures[e]}},{key:"getDepthTexture",value:function(){return this.glDepthTexture}},{key:"minFilter",value:function(e){return e!==l.LINEAR&&e!==l.NEAREST&&e!==l.LINEAR_MIPMAP_NEAREST||(this.minFilter=e),this}},{key:"magFilter",value:function(e){return e!==l.LINEAR&&e!==l.NEAREST&&e!==l.LINEAR_MIPMAP_NEAREST||(this.magFilter=e),this}},{key:"wrapS",value:function(e){return e!==l.CLAMP_TO_EDGE&&e!==l.REPEAT&&e!==l.MIRRORED_REPEAT||(this.wrapS=e),this}},{key:"wrapT",value:function(e){return e!==l.CLAMP_TO_EDGE&&e!==l.REPEAT&&e!==l.MIRRORED_REPEAT||(this.wrapT=e),this}}]),e}();t.default=d},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(7),u=(i=o)&&i.__esModule?i:{default:i},s=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;n(this,e),this.easing=i,this._value=t,this._targetValue=t,this._efIndex=u.default.addEF((function(){return r._update()}))}return a(e,[{key:"_update",value:function(){this._checkLimit(),this._value+=(this._targetValue-this._value)*this.easing,Math.abs(this._targetValue-this._value)<1e-4&&(this._value=this._targetValue)}},{key:"setTo",value:function(e){this._targetValue=this._value=e}},{key:"add",value:function(e){this._targetValue+=e}},{key:"limit",value:function(e,t){e>t?this.limit(t,e):(this._min=e,this._max=t,this._checkLimit())}},{key:"_checkLimit",value:function(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)}},{key:"destroy",value:function(){u.default.removeEF(this._efIndex)}},{key:"value",set:function(e){this._targetValue=e},get:function(){return this._value}},{key:"targetValue",get:function(){return this._targetValue}}]),e}();t.default=s},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),o=a.vec3.create(),u=a.vec3.create(),s=a.vec3.create(),l=a.vec3.create(),f=a.vec3.create(),c=a.vec3.create(),h=a.vec3.create(),d=a.vec3.create(),v=function(){function e(t,r){n(this,e),this.origin=a.vec3.clone(t),this.direction=a.vec3.clone(r)}return i(e,[{key:"at",value:function(e){return a.vec3.copy(l,this.direction),a.vec3.scale(l,l,e),a.vec3.add(l,l,this.origin),l}},{key:"lookAt",value:function(e){a.vec3.sub(this.direction,e,this.origin),a.vec3.normalize(this.origin,this.origin)}},{key:"closestPointToPoint",value:function(e){var t=a.vec3.create();a.vec3.sub(e,this.origin);var r=a.vec3.dot(t,this.direction);return r<0?a.vec3.clone(this.origin):(a.vec3.copy(t,this.direction),a.vec3.scale(t,t,r),a.vec3.add(t,t,this.origin),t)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=a.vec3.create();a.vec3.sub(t,e,this.origin);var r=a.vec3.dot(t,this.direction);return r<0?a.vec3.squaredDistance(this.origin,e):(a.vec3.copy(t,this.direction),a.vec3.scale(t,t,r),a.vec3.add(t,t,this.origin),a.vec3.squaredDistance(t,e))}},{key:"intersectsSphere",value:function(e,t){return this.distanceToPoint(e)<=t}},{key:"intersectSphere",value:function(e,t){var r=a.vec3.create();a.vec3.sub(r,e,this.origin);var n=a.vec3.dot(r,this.direction),i=a.vec3.dot(r,r)-n*n,o=t*t;if(i>o)return null;var u=Math.sqrt(o-i),s=n-u,l=n+u;return s<0&&l<0?null:s<0?this.at(l):this.at(s)}},{key:"distanceToPlane",value:function(e,t){a.vec3.dot(t,this.direction)}},{key:"intersectTriangle",value:function(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];a.vec3.copy(o,e),a.vec3.copy(u,t),a.vec3.copy(s,r),a.vec3.sub(f,u,o),a.vec3.sub(c,s,o),a.vec3.cross(h,f,c);var i=a.vec3.dot(this.direction,h),l=void 0;if(i>0){if(n)return null;l=1}else{if(!(i<0))return null;l=-1,i=-i}a.vec3.sub(d,this.origin,o),a.vec3.cross(c,d,c);var v=l*a.vec3.dot(this.direction,c);if(v<0)return null;a.vec3.cross(f,f,d);var p=l*a.vec3.dot(this.direction,f);if(p<0)return null;if(v+p>i)return null;var _=-l*a.vec3.dot(d,h);return _<0?null:this.at(_/i)}}]),e}();t.default=v},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),o=function(){function e(){n(this,e),this._matrix=a.mat4.create(),this._quat=a.quat.create(),this._orientation=a.mat4.create(),this._projection=a.mat4.create(),this.position=vec3.create()}return i(e,[{key:"lookAt",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,1,0];this._eye=vec3.clone(e),this._center=vec3.clone(t),vec3.copy(this.position,e),a.mat4.identity(this._matrix),a.mat4.lookAt(this._matrix,e,t,r)}},{key:"setFromOrientation",value:function(e,t,r,n){a.quat.set(this._quat,e,t,r,n),a.mat4.fromQuat(this._orientation,this._quat),a.mat4.translate(this._matrix,this._orientation,this.positionOffset)}},{key:"setProjection",value:function(e){this._projection=a.mat4.clone(e)}},{key:"setView",value:function(e){this._matrix=a.mat4.clone(e)}},{key:"setFromViewProj",value:function(e,t){this.setView(e),this.setProjection(t)}},{key:"matrix",get:function(){return this._matrix}},{key:"viewMatrix",get:function(){return this._matrix}},{key:"projection",get:function(){return this._projection}},{key:"projectionMatrix",get:function(){return this._projection}},{key:"eye",get:function(){return this._eye}},{key:"center",get:function(){return this._center}}]),e}();t.default=o},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=n(r(15)),l=n(r(14)),f=r(1),c=f.mat4.create(),h=f.vec3.create(),d=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"setPerspective",value:function(e,t,r,n){this._fov=e,this._near=r,this._far=n,this._aspectRatio=t,f.mat4.perspective(this._projection,e,t,r,n)}},{key:"setAspectRatio",value:function(e){this._aspectRatio=e,f.mat4.perspective(this.projection,this._fov,e,this._near,this._far)}},{key:"generateRay",value:function(e,t){var r=this.projectionMatrix,n=this.viewMatrix;return f.mat4.multiply(c,r,n),f.mat4.invert(c,c),f.vec3.transformMat4(h,e,c),f.vec3.sub(h,h,this.position),f.vec3.normalize(h,h),t?(t.origin=this.position,t.direction=h):t=new l.default(this.position,h),t}}]),t}(s.default);t.default=d},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]&&arguments[0];n(this,e),this._req=new XMLHttpRequest,this._req.addEventListener("load",(function(e){return t._onLoaded(e)})),this._req.addEventListener("progress",(function(e){return t._onProgress(e)})),r&&(this._req.responseType="arraybuffer")}return i(e,[{key:"load",value:function(e,t){console.log("Loading : ",e),this._callback=t,this._req.open("GET",e),this._req.send()}},{key:"_onLoaded",value:function(){this._callback(this._req.response)}},{key:"_onProgress",value:function(){}}]),e}();t.default=a},function(e,t){e.exports="// bigTriangle.vert\n\n#define SHADER_NAME BIG_TRIANGLE_VERTEX\n\nprecision mediump float;\n#define GLSLIFY 1\nattribute vec2 aPosition;\nvarying vec2 vTextureCoord;\n\nvoid main(void) {\n    gl_Position = vec4(aPosition, 0.0, 1.0);\n    vTextureCoord = aPosition * .5 + .5;\n}"},function(e,t){e.exports="// copy.frag\n\n#define SHADER_NAME COPY_FRAGMENT\n\nprecision mediump float;\n#define GLSLIFY 1\n\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = texture2D(texture, vTextureCoord);\n}"},function(e,t,r){function n(){var e=new I.ARRAY_TYPE(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function i(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function a(e){var t=new I.ARRAY_TYPE(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function u(e,t,r,n,i,a,o,u,s){var l=new I.ARRAY_TYPE(9);return l[0]=e,l[1]=t,l[2]=r,l[3]=n,l[4]=i,l[5]=a,l[6]=o,l[7]=u,l[8]=s,l}function s(e,t,r,n,i,a,o,u,s,l){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=u,e[7]=s,e[8]=l,e}function l(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function f(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function c(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],f=t[8],c=f*o-u*l,h=-f*a+u*s,d=l*a-o*s,v=r*c+n*h+i*d;return v?(v=1/v,e[0]=c*v,e[1]=(-f*n+i*l)*v,e[2]=(u*n-i*o)*v,e[3]=h*v,e[4]=(f*r-i*s)*v,e[5]=(-u*r+i*a)*v,e[6]=d*v,e[7]=(-l*r+n*s)*v,e[8]=(o*r-n*a)*v,e):null}function h(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],f=t[8];return e[0]=o*f-u*l,e[1]=i*l-n*f,e[2]=n*u-i*o,e[3]=u*s-a*f,e[4]=r*f-i*s,e[5]=i*a-r*u,e[6]=a*l-o*s,e[7]=n*s-r*l,e[8]=r*o-n*a,e}function d(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],u=e[6],s=e[7],l=e[8];return t*(l*a-o*s)+r*(-l*i+o*u)+n*(s*i-a*u)}function v(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],f=t[7],c=t[8],h=r[0],d=r[1],v=r[2],p=r[3],_=r[4],m=r[5],b=r[6],g=r[7],y=r[8];return e[0]=h*n+d*o+v*l,e[1]=h*i+d*u+v*f,e[2]=h*a+d*s+v*c,e[3]=p*n+_*o+m*l,e[4]=p*i+_*u+m*f,e[5]=p*a+_*s+m*c,e[6]=b*n+g*o+y*l,e[7]=b*i+g*u+y*f,e[8]=b*a+g*s+y*c,e}function p(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],f=t[7],c=t[8],h=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=u,e[5]=s,e[6]=h*n+d*o+l,e[7]=h*i+d*u+f,e[8]=h*a+d*s+c,e}function _(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],f=t[7],c=t[8],h=Math.sin(r),d=Math.cos(r);return e[0]=d*n+h*o,e[1]=d*i+h*u,e[2]=d*a+h*s,e[3]=d*o-h*n,e[4]=d*u-h*i,e[5]=d*s-h*a,e[6]=l,e[7]=f,e[8]=c,e}function m(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function b(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=t[0],e[7]=t[1],e[8]=1,e}function g(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function y(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=t[1],e[5]=0,e[6]=0,e[7]=0,e[8]=1,e}function E(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e}function M(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,u=n+n,s=i+i,l=r*o,f=n*o,c=n*u,h=i*o,d=i*u,v=i*s,p=a*o,_=a*u,m=a*s;return e[0]=1-c-v,e[3]=f-m,e[6]=h+_,e[1]=f+m,e[4]=1-l-v,e[7]=d-p,e[2]=h-_,e[5]=d+p,e[8]=1-l-c,e}function T(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],f=t[8],c=t[9],h=t[10],d=t[11],v=t[12],p=t[13],_=t[14],m=t[15],b=r*u-n*o,g=r*s-i*o,y=r*l-a*o,E=n*s-i*u,M=n*l-a*u,T=i*l-a*s,x=f*p-c*v,w=f*_-h*v,A=f*m-d*v,R=c*_-h*p,P=c*m-d*p,O=h*m-d*_,S=b*O-g*P+y*R+E*A-M*w+T*x;return S?(S=1/S,e[0]=(u*O-s*P+l*R)*S,e[1]=(s*A-o*O-l*w)*S,e[2]=(o*P-u*A+l*x)*S,e[3]=(i*P-n*O-a*R)*S,e[4]=(r*O-i*A+a*w)*S,e[5]=(n*A-r*P-a*x)*S,e[6]=(p*T-_*M+m*E)*S,e[7]=(_*y-v*T-m*g)*S,e[8]=(v*M-p*y+m*b)*S,e):null}function x(e,t,r){return e[0]=2/t,e[1]=0,e[2]=0,e[3]=0,e[4]=-2/r,e[5]=0,e[6]=-1,e[7]=1,e[8]=1,e}function w(e){return"mat3("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+")"}function A(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))}function R(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e}function P(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e}function O(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e}function S(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e}function L(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]}function N(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],f=e[8],c=t[0],h=t[1],d=t[2],v=t[3],p=t[4],_=t[5],m=t[6],b=t[7],g=t[8];return Math.abs(r-c)<=I.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(n-h)<=I.EPSILON*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-d)<=I.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-v)<=I.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(o-p)<=I.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(u-_)<=I.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(s-m)<=I.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(l-b)<=I.EPSILON*Math.max(1,Math.abs(l),Math.abs(b))&&Math.abs(f-g)<=I.EPSILON*Math.max(1,Math.abs(f),Math.abs(g))}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=n,t.fromMat4=i,t.clone=a,t.copy=o,t.fromValues=u,t.set=s,t.identity=l,t.transpose=f,t.invert=c,t.adjoint=h,t.determinant=d,t.multiply=v,t.translate=p,t.rotate=_,t.scale=m,t.fromTranslation=b,t.fromRotation=g,t.fromScaling=y,t.fromMat2d=E,t.fromQuat=M,t.normalFromMat4=T,t.projection=x,t.str=w,t.frob=A,t.add=R,t.subtract=P,t.multiplyScalar=O,t.multiplyScalarAndAdd=S,t.exactEquals=L,t.equals=N;var I=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3));t.mul=v,t.sub=P},function(e,t,r){function n(){var e=new V.ARRAY_TYPE(3);return e[0]=0,e[1]=0,e[2]=0,e}function i(e){var t=new V.ARRAY_TYPE(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function a(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}function o(e,t,r){var n=new V.ARRAY_TYPE(3);return n[0]=e,n[1]=t,n[2]=r,n}function u(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function l(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function f(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function c(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function h(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function d(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function v(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function p(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function _(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function m(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}function b(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function g(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function y(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)}function E(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i}function M(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function x(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function w(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e}function A(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function R(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],u=r[1],s=r[2];return e[0]=i*s-a*u,e[1]=a*o-n*s,e[2]=n*u-i*o,e}function P(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e}function O(e,t,r,n,i,a){var o=a*a,u=o*(2*a-3)+1,s=o*(a-2)+a,l=o*(a-1),f=o*(3-2*a);return e[0]=t[0]*u+r[0]*s+n[0]*l+i[0]*f,e[1]=t[1]*u+r[1]*s+n[1]*l+i[1]*f,e[2]=t[2]*u+r[2]*s+n[2]*l+i[2]*f,e}function S(e,t,r,n,i,a){var o=1-a,u=o*o,s=a*a,l=u*o,f=3*a*u,c=3*s*o,h=s*a;return e[0]=t[0]*l+r[0]*f+n[0]*c+i[0]*h,e[1]=t[1]*l+r[1]*f+n[1]*c+i[1]*h,e[2]=t[2]*l+r[2]*f+n[2]*c+i[2]*h,e}function L(e,t){t=t||1;var r=2*V.RANDOM()*Math.PI,n=2*V.RANDOM()-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e}function N(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e}function I(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}function k(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],u=r[1],s=r[2],l=r[3],f=l*n+u*a-s*i,c=l*i+s*n-o*a,h=l*a+o*i-u*n,d=-o*n-u*i-s*a;return e[0]=f*l+d*-o+c*-s-h*-u,e[1]=c*l+d*-u+h*-o-f*-s,e[2]=h*l+d*-s+f*-u-c*-o,e}function F(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function C(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function D(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e}function B(e,t){var r=o(e[0],e[1],e[2]),n=o(t[0],t[1],t[2]);w(r,r),w(n,n);var i=A(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}function j(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"}function U(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function q(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],o=t[1],u=t[2];return Math.abs(r-a)<=V.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-o)<=V.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-u)<=V.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=i,t.length=a,t.fromValues=o,t.copy=u,t.set=s,t.add=l,t.subtract=f,t.multiply=c,t.divide=h,t.ceil=d,t.floor=v,t.min=p,t.max=_,t.round=m,t.scale=b,t.scaleAndAdd=g,t.distance=y,t.squaredDistance=E,t.squaredLength=M,t.negate=T,t.inverse=x,t.normalize=w,t.dot=A,t.cross=R,t.lerp=P,t.hermite=O,t.bezier=S,t.random=L,t.transformMat4=N,t.transformMat3=I,t.transformQuat=k,t.rotateX=F,t.rotateY=C,t.rotateZ=D,t.angle=B,t.str=j,t.exactEquals=U,t.equals=q;var X,V=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3));t.sub=f,t.mul=c,t.div=h,t.dist=y,t.sqrDist=E,t.len=a,t.sqrLen=M,t.forEach=(X=n(),function(e,t,r,n,i,a){var o=void 0,u=void 0;for(t||(t=3),r||(r=0),u=n?Math.min(n*t+r,e.length):e.length,o=r;o<u;o+=t)X[0]=e[o],X[1]=e[o+1],X[2]=e[o+2],i(X,X,a),e[o]=X[0],e[o+1]=X[1],e[o+2]=X[2];return e})},function(e,t,r){function n(){var e=new F.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function i(e){var t=new F.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t,r,n){var i=new F.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function u(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function s(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function l(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function f(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function c(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function h(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function d(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function v(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function p(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function _(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e[3]=Math.round(t[3]),e}function m(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function b(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}function g(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)}function y(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a}function E(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)}function M(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function x(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function w(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o),e}function A(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function R(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=u+n*(r[3]-u),e}function P(e,t){return t=t||1,e[0]=F.RANDOM(),e[1]=F.RANDOM(),e[2]=F.RANDOM(),e[3]=F.RANDOM(),w(e,e),m(e,e,t),e}function O(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e}function S(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],u=r[1],s=r[2],l=r[3],f=l*n+u*a-s*i,c=l*i+s*n-o*a,h=l*a+o*i-u*n,d=-o*n-u*i-s*a;return e[0]=f*l+d*-o+c*-s-h*-u,e[1]=c*l+d*-u+h*-o-f*-s,e[2]=h*l+d*-s+f*-u-c*-o,e[3]=t[3],e}function L(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function N(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function I(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],u=t[1],s=t[2],l=t[3];return Math.abs(r-o)<=F.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-u)<=F.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-s)<=F.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-l)<=F.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.len=t.sqrDist=t.dist=t.div=t.mul=t.sub=void 0,t.create=n,t.clone=i,t.fromValues=a,t.copy=o,t.set=u,t.add=s,t.subtract=l,t.multiply=f,t.divide=c,t.ceil=h,t.floor=d,t.min=v,t.max=p,t.round=_,t.scale=m,t.scaleAndAdd=b,t.distance=g,t.squaredDistance=y,t.length=E,t.squaredLength=M,t.negate=T,t.inverse=x,t.normalize=w,t.dot=A,t.lerp=R,t.random=P,t.transformMat4=O,t.transformQuat=S,t.str=L,t.exactEquals=N,t.equals=I;var k,F=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3));t.sub=l,t.mul=f,t.div=c,t.dist=g,t.sqrDist=y,t.len=E,t.sqrLen=M,t.forEach=(k=n(),function(e,t,r,n,i,a){var o=void 0,u=void 0;for(t||(t=4),r||(r=0),u=n?Math.min(n*t+r,e.length):e.length,o=r;o<u;o+=t)k[0]=e[o],k[1]=e[o+1],k[2]=e[o+2],k[3]=e[o+3],i(k,k,a),e[o]=k[0],e[o+1]=k[1],e[o+2]=k[2],e[o+3]=k[3];return e})},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,r){return void 0===t.cacheAttribLoc&&(t.cacheAttribLoc={}),void 0===t.cacheAttribLoc[r]&&(t.cacheAttribLoc[r]=e.getAttribLocation(t,r)),t.cacheAttribLoc[r]}},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(0)),u=n(r(51)),s=void 0,l=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(i(this,e),s=o.default.gl,n)this.texture=t;else{var a=t.length>6;t[0].mipmapCount&&(a=t[0].mipmapCount>1),this.texture=s.createTexture(),this.magFilter=r.magFilter||s.LINEAR,this.minFilter=r.minFilter||s.LINEAR_MIPMAP_LINEAR,this.wrapS=r.wrapS||s.CLAMP_TO_EDGE,this.wrapT=r.wrapT||s.CLAMP_TO_EDGE,a||this.minFilter!=s.LINEAR_MIPMAP_LINEAR||(this.minFilter=s.LINEAR),s.bindTexture(s.TEXTURE_CUBE_MAP,this.texture);var u=[s.TEXTURE_CUBE_MAP_POSITIVE_X,s.TEXTURE_CUBE_MAP_NEGATIVE_X,s.TEXTURE_CUBE_MAP_POSITIVE_Y,s.TEXTURE_CUBE_MAP_NEGATIVE_Y,s.TEXTURE_CUBE_MAP_POSITIVE_Z,s.TEXTURE_CUBE_MAP_NEGATIVE_Z],l=1,f=0;if(l=t.length/6,this.numLevels=l,a)for(var c=0;c<6;c++)for(var h=0;h<l;h++)s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),t[f=c*l+h].shape?s.texImage2D(u[c],h,s.RGBA,t[f].shape[0],t[f].shape[1],0,s.RGBA,s.FLOAT,t[f].data):s.texImage2D(u[c],h,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t[f]),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,this.wrapS),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,this.wrapT),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,this.magFilter),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,this.minFilter);else{for(var d=0,v=0;v<6;v++)d=v*l,s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),t[d].shape?s.texImage2D(u[v],0,s.RGBA,t[d].shape[0],t[d].shape[1],0,s.RGBA,s.FLOAT,t[d].data):s.texImage2D(u[v],0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,t[d]),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,this.wrapS),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,this.wrapT),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,this.magFilter),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,this.minFilter);s.generateMipmap(s.TEXTURE_CUBE_MAP)}s.bindTexture(s.TEXTURE_CUBE_MAP,null)}}return a(e,[{key:"bind",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;o.default.shader&&(s.activeTexture(s.TEXTURE0+e),s.bindTexture(s.TEXTURE_CUBE_MAP,this.texture),s.uniform1i(o.default.shader.uniformTextures[e],e),this._bindIndex=e)}},{key:"unbind",value:function(){s.bindTexture(s.TEXTURE_CUBE_MAP,null)}}]),e}();l.parseDDS=function(e){var t=(0,u.default)(e),r=t.flags,n=new Int32Array(e,0,31),i=1;131072&r&&(i=Math.max(1,n[7]));var a=t.images.map((function(t){return{data:new Float32Array(e.slice(t.offset,t.offset+t.length)),shape:t.shape,mipmapCount:i}}));return new l(a)},t.default=l},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=!0;try{document.createEvent("CustomEvent")}catch(e){a=!1}var o=function(){function e(){n(this,e),this._eventListeners={}}return i(e,[{key:"addEventListener",value:function(e,t){return null!==this._eventListeners&&void 0!==this._eventListeners||(this._eventListeners={}),this._eventListeners[e]||(this._eventListeners[e]=[]),this._eventListeners[e].push(t),this}},{key:"on",value:function(e,t){return this.addEventListener(e,t)}},{key:"removeEventListener",value:function(e,t){null!==this._eventListeners&&void 0!==this._eventListeners||(this._eventListeners={});var r=this._eventListeners[e];if(void 0===r)return this;for(var n=r.length,i=0;i<n;i++)r[i]===t&&(r.splice(i,1),i--,n--);return this}},{key:"off",value:function(e,t){return this.removeEventListener(e,t)}},{key:"dispatchEvent",value:function(e){null!==this._eventListeners&&void 0!==this._eventListeners||(this._eventListeners={});var t=e.type;try{null===e.target&&(e.target=this),e.currentTarget=this}catch(n){var r={type:t,detail:e.detail,dispatcher:this};return this.dispatchEvent(r)}var n=this._eventListeners[t];if(null!=n)for(var i=this._copyArray(n),a=i.length,o=0;o<a;o++)i[o].call(this,e);return this}},{key:"dispatchCustomEvent",value:function(e,t){var r=void 0;return a?((r=document.createEvent("CustomEvent")).dispatcher=this,r.initCustomEvent(e,!1,!1,t)):r={type:e,detail:t,dispatcher:this},this.dispatchEvent(r)}},{key:"trigger",value:function(e,t){return this.dispatchCustomEvent(e,t)}},{key:"_destroy",value:function(){if(null!==this._eventListeners){for(var e in this._eventListeners)if(this._eventListeners.hasOwnProperty(e)){for(var t=this._eventListeners[e],r=t.length,n=0;n<r;n++)t[n]=null;delete this._eventListeners[e]}this._eventListeners=null}}},{key:"_copyArray",value:function(e){for(var t=new Array(e.length),r=t.length,n=0;n<r;n++)t[n]=e[n];return t}}]),e}();t.default=o},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(13)),u=n(r(7)),s=r(1),l=function(e,t){var r=t||{};return e.touches?(r.x=e.touches[0].pageX,r.y=e.touches[0].pageY):(r.x=e.clientX,r.y=e.clientY),r},f=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;i(this,e),this._target=t,this._listenerTarget=n,this._mouse={},this._preMouse={},this.center=s.vec3.create(),this._up=s.vec3.fromValues(0,1,0),this.radius=new o.default(a),this.position=s.vec3.fromValues(0,0,this.radius.value),this.positionOffset=s.vec3.create(),this._rx=new o.default(0),this._rx.limit(-Math.PI/2,Math.PI/2),this._ry=new o.default(0),this._preRX=0,this._preRY=0,this._isLockZoom=!1,this._isLockRotation=!1,this._isInvert=!1,this.sensitivity=1,this._wheelBind=function(e){return r._onWheel(e)},this._downBind=function(e){return r._onDown(e)},this._moveBind=function(e){return r._onMove(e)},this._upBind=function(){return r._onUp()},this.connect(),u.default.addEF((function(){return r._loop()}))}return a(e,[{key:"connect",value:function(){this.disconnect(),this._listenerTarget.addEventListener("mousewheel",this._wheelBind),this._listenerTarget.addEventListener("DOMMouseScroll",this._wheelBind),this._listenerTarget.addEventListener("mousedown",this._downBind),this._listenerTarget.addEventListener("touchstart",this._downBind),this._listenerTarget.addEventListener("mousemove",this._moveBind),this._listenerTarget.addEventListener("touchmove",this._moveBind),window.addEventListener("touchend",this._upBind),window.addEventListener("mouseup",this._upBind)}},{key:"disconnect",value:function(){this._listenerTarget.removeEventListener("mousewheel",this._wheelBind),this._listenerTarget.removeEventListener("DOMMouseScroll",this._wheelBind),this._listenerTarget.removeEventListener("mousedown",this._downBind),this._listenerTarget.removeEventListener("touchstart",this._downBind),this._listenerTarget.removeEventListener("mousemove",this._moveBind),this._listenerTarget.removeEventListener("touchmove",this._moveBind),window.removeEventListener("touchend",this._upBind),window.removeEventListener("mouseup",this._upBind)}},{key:"lock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e,this._isLockRotation=e,this._isMouseDown=!1}},{key:"lockZoom",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockZoom=e}},{key:"lockRotation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLockRotation=e}},{key:"inverseControl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isInvert=e}},{key:"_onDown",value:function(e){this._isLockRotation||(this._isMouseDown=!0,l(e,this._mouse),l(e,this._preMouse),this._preRX=this._rx.targetValue,this._preRY=this._ry.targetValue)}},{key:"_onMove",value:function(e){if(!this._isLockRotation&&(l(e,this._mouse),e.touches&&e.preventDefault(),this._isMouseDown)){var t=-(this._mouse.x-this._preMouse.x);this._isInvert&&(t*=-1),this._ry.value=this._preRY-.01*t*this.sensitivity;var r=-(this._mouse.y-this._preMouse.y);this._isInvert&&(r*=-1),this._rx.value=this._preRX-.01*r*this.sensitivity}}},{key:"_onUp",value:function(){this._isLockRotation||(this._isMouseDown=!1)}},{key:"_onWheel",value:function(e){if(!this._isLockZoom){var t=e.wheelDelta,r=e.detail,n=0;n=r?t?t/r/40*r>0?1:-1:-r/3:t/120,this.radius.add(2*-n)}}},{key:"_loop",value:function(){this._updatePosition(),this._target&&this._updateCamera()}},{key:"_updatePosition",value:function(){this.position[1]=Math.sin(this._rx.value)*this.radius.value;var e=Math.cos(this._rx.value)*this.radius.value;this.position[0]=Math.cos(this._ry.value+.5*Math.PI)*e,this.position[2]=Math.sin(this._ry.value+.5*Math.PI)*e,s.vec3.add(this.position,this.position,this.positionOffset)}},{key:"_updateCamera",value:function(){this._target.lookAt(this.position,this.center,this._up)}},{key:"rx",get:function(){return this._rx}},{key:"ry",get:function(){return this._ry}}]),e}();t.default=f},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o,u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(15),l=(o=s)&&o.__esModule?o:{default:o},f=r(1),c=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),r=f.vec3.clone([0,0,15]),a=f.vec3.create(),o=f.vec3.clone([0,-1,0]);return e.lookAt(r,a,o),e.ortho(1,-1,1,-1),e}return a(t,e),u(t,[{key:"setBoundary",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;this.ortho(e,t,r,n,i,a)}},{key:"ortho",value:function(e,t,r,n){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:100;this.left=e,this.right=t,this.top=r,this.bottom=n,mat4.ortho(this._projection,e,t,r,n,i,a)}}]),t}(l.default);t.default=c},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(1),o=function(){function e(){n(this,e),this._needUpdate=!0,this._x=0,this._y=0,this._z=0,this._sx=1,this._sy=1,this._sz=1,this._rx=0,this._ry=0,this._rz=0,this._position=a.vec3.create(),this._scale=a.vec3.fromValues(1,1,1),this._rotation=a.vec3.create(),this._matrix=a.mat4.create(),this._matrixRotation=a.mat4.create(),this._matrixScale=a.mat4.create(),this._matrixTranslation=a.mat4.create(),this._matrixQuaternion=a.mat4.create(),this._quat=a.quat.create()}return i(e,[{key:"_update",value:function(){a.vec3.set(this._scale,this._sx,this._sy,this._sz),a.vec3.set(this._rotation,this._rx,this._ry,this._rz),a.vec3.set(this._position,this._x,this._y,this._z),a.mat4.identity(this._matrixTranslation,this._matrixTranslation),a.mat4.identity(this._matrixScale,this._matrixScale),a.mat4.identity(this._matrixRotation,this._matrixRotation),a.mat4.rotateX(this._matrixRotation,this._matrixRotation,this._rx),a.mat4.rotateY(this._matrixRotation,this._matrixRotation,this._ry),a.mat4.rotateZ(this._matrixRotation,this._matrixRotation,this._rz),a.mat4.fromQuat(this._matrixQuaternion,this._quat),a.mat4.mul(this._matrixRotation,this._matrixQuaternion,this._matrixRotation),a.mat4.scale(this._matrixScale,this._matrixScale,this._scale),a.mat4.translate(this._matrixTranslation,this._matrixTranslation,this._position),a.mat4.mul(this._matrix,this._matrixTranslation,this._matrixRotation),a.mat4.mul(this._matrix,this._matrix,this._matrixScale),this._needUpdate=!1}},{key:"setRotationFromQuaternion",value:function(e){a.quat.copy(this._quat,e),this._needUpdate=!0}},{key:"matrix",get:function(){return this._needUpdate&&this._update(),this._matrix}},{key:"x",get:function(){return this._x},set:function(e){this._needUpdate=!0,this._x=e}},{key:"y",get:function(){return this._y},set:function(e){this._needUpdate=!0,this._y=e}},{key:"z",get:function(){return this._z},set:function(e){this._needUpdate=!0,this._z=e}},{key:"scaleX",get:function(){return this._sx},set:function(e){this._needUpdate=!0,this._sx=e}},{key:"scaleY",get:function(){return this._sy},set:function(e){this._needUpdate=!0,this._sy=e}},{key:"scaleZ",get:function(){return this._sz},set:function(e){this._needUpdate=!0,this._sz=e}},{key:"rotationX",get:function(){return this._rx},set:function(e){this._needUpdate=!0,this._rx=e}},{key:"rotationY",get:function(){return this._ry},set:function(e){this._needUpdate=!0,this._ry=e}},{key:"rotationZ",get:function(){return this._rz},set:function(e){this._needUpdate=!0,this._rz=e}}]),e}();t.default=o},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(9)),a=n(r(18)),o=n(r(30)),u=n(r(19)),s=n(r(10)),l=n(r(31)),f=n(r(32)),c={simpleColorFrag:i.default,bigTriangleVert:a.default,generalVert:o.default,copyFrag:u.default,basicVert:s.default,skyboxVert:l.default,skyboxFrag:f.default};t.default=c},function(e,t){e.exports="// generalWithNormal.vert\n\n#define SHADER_NAME GENERAL_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\nuniform mat3 uNormalMatrix;\n\nuniform vec3 position;\nuniform vec3 scale;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tvec3 pos      = aVertexPosition * scale;\n\tpos           += position;\n\tgl_Position   = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(pos, 1.0);\n\t\n\tvTextureCoord = aTextureCoord;\n\tvNormal       = normalize(uNormalMatrix * aNormal);\n}"},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME SKYBOX_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vVertex;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tmat4 matView = uViewMatrix;\n\tmatView[3][0] = 0.0;\n\tmatView[3][1] = 0.0;\n\tmatView[3][2] = 0.0;\n\t\n\tgl_Position = uProjectionMatrix * matView * uModelMatrix * vec4(aVertexPosition, 1.0);\n\tvTextureCoord = aTextureCoord;\n\t\n\tvVertex = aVertexPosition;\n\tvNormal = aNormal;\n}"},function(e,t){e.exports="// basic.frag\n\n#define SHADER_NAME SKYBOX_FRAGMENT\n\nprecision mediump float;\n#define GLSLIFY 1\nuniform samplerCube texture;\nvarying vec2 vTextureCoord;\nvarying vec3 vVertex;\n\nvoid main(void) {\n    gl_FragColor = textureCube(texture, vVertex);\n}"},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this._passes=[]}return i(e,[{key:"addPass",value:function(e){this._passes.push(e)}},{key:"passes",get:function(){return this._passes}}]),e}();t.default=a},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o,u=r(35),s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,r=arguments[1],a=arguments[2],o=arguments[3];return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,[0,1],r,a,o))}return a(t,e),t}(((o=u)&&o.__esModule?o:{default:o}).default);t.default=s},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(0)),s=n(r(8)),l=r(69),f=r(70),c=r(71),h=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,r=arguments[1],n=arguments[2],o=arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};i(this,t);var h=void 0;switch(e){case 5:default:h=l;break;case 9:h=f;break;case 13:h=c}var d=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,h,n,o,s));return d.uniform("uDirection",r),d.uniform("uResolution",[u.default.width,u.default.height]),d}return o(t,e),t}(s.default);t.default=h},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o,u=r(35),s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,r=arguments[1],a=arguments[2],o=arguments[3];return n(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,[1,0],r,a,o))}return a(t,e),t}(((o=u)&&o.__esModule?o:{default:o}).default);t.default=s},function(e,t){e.exports="// fxaa.frag\n\n#define SHADER_NAME FXAA\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform vec2 uResolution;\n\n\nfloat FXAA_SUBPIX_SHIFT = 1.0/4.0;\n#define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#define FXAA_SPAN_MAX     8.0\n\n\nvec4 applyFXAA(sampler2D tex) {\n    vec4 color;\n    vec2 fragCoord = gl_FragCoord.xy;\n    vec3 rgbNW = texture2D(tex, (fragCoord + vec2(-1.0, -1.0)) * uResolution).xyz;\n    vec3 rgbNE = texture2D(tex, (fragCoord + vec2(1.0, -1.0)) * uResolution).xyz;\n    vec3 rgbSW = texture2D(tex, (fragCoord + vec2(-1.0, 1.0)) * uResolution).xyz;\n    vec3 rgbSE = texture2D(tex, (fragCoord + vec2(1.0, 1.0)) * uResolution).xyz;\n    vec3 rgbM  = texture2D(tex, fragCoord  * uResolution).xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * uResolution;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * uResolution + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * uResolution + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * uResolution + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * uResolution + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, 1.0);\n    else\n        color = vec4(rgbB, 1.0);\n    return color;\n}\n\nvoid main(void) {\n \tvec4 color = applyFXAA(texture);\n    gl_FragColor = color;\n}"},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.ShaderLibs=t.View3D=t.View=t.Scene=t.BatchFXAA=t.BatchSky=t.BatchSkybox=t.BatchLine=t.BatchDotsPlane=t.BatchBall=t.BatchAxis=t.BatchCopy=t.PassFxaa=t.PassHBlur=t.PassVBlur=t.PassBlur=t.PassMacro=t.Pass=t.EffectComposer=t.ColladaParser=t.HDRLoader=t.ObjLoader=t.BinaryLoader=t.Object3D=t.Ray=t.CameraCube=t.CameraPerspective=t.CameraOrtho=t.Camera=t.TouchDetector=t.QuatRotation=t.OrbitalControl=t.TweenNumber=t.EaseNumber=t.EventDispatcher=t.Scheduler=t.TransformFeedbackObject=t.MultisampleFrameBuffer=t.CubeFrameBuffer=t.FrameBuffer=t.Batch=t.Geom=t.Mesh=t.GLCubeTexture=t.GLTexture=t.GLShader=t.GL=void 0;var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(1)),u=n(r(0)),s=n(r(2)),l=n(r(11)),f=n(r(24)),c=n(r(5)),h=n(r(6)),d=n(r(4)),v=n(r(12)),p=n(r(52)),_=n(r(53)),m=n(r(54)),b=n(r(7)),g=n(r(25)),y=n(r(13)),E=n(r(55)),M=n(r(26)),T=n(r(56)),x=n(r(57)),w=n(r(15)),A=n(r(27)),R=n(r(16)),P=n(r(59)),O=n(r(14)),S=n(r(28)),L=n(r(17)),N=n(r(60)),I=n(r(61)),k=n(r(63)),F=n(r(67)),C=n(r(8)),D=n(r(33)),B=n(r(68)),j=n(r(34)),U=n(r(36)),q=n(r(72)),X=n(r(73)),V=n(r(74)),G=n(r(77)),Y=n(r(78)),H=n(r(80)),W=n(r(81)),z=n(r(82)),Z=n(r(84)),Q=n(r(85)),K=n(r(86)),J=n(r(87)),$=n(r(29)),ee=function(){function e(){for(var t in i(this,e),this.glm=o,this.GL=u.default,this.GLTool=u.default,this.GLShader=s.default,this.GLTexture=l.default,this.GLCubeTexture=f.default,this.Mesh=c.default,this.Geom=h.default,this.Batch=d.default,this.FrameBuffer=v.default,this.CubeFrameBuffer=p.default,this.Scheduler=b.default,this.EventDispatcher=g.default,this.EaseNumber=y.default,this.TweenNumber=E.default,this.Camera=w.default,this.CameraOrtho=A.default,this.CameraPerspective=R.default,this.Ray=O.default,this.CameraCube=P.default,this.OrbitalControl=M.default,this.QuatRotation=T.default,this.BinaryLoader=L.default,this.ObjLoader=N.default,this.ColladaParser=k.default,this.HDRLoader=I.default,this.BatchCopy=X.default,this.BatchAxis=V.default,this.BatchBall=G.default,this.BatchBall=G.default,this.BatchLine=H.default,this.BatchSkybox=W.default,this.BatchSky=z.default,this.BatchFXAA=Z.default,this.BatchDotsPlane=Y.default,this.Scene=Q.default,this.View=K.default,this.View3D=J.default,this.Object3D=S.default,this.ShaderLibs=$.default,this.EffectComposer=F.default,this.Pass=C.default,this.PassMacro=D.default,this.PassBlur=B.default,this.PassVBlur=j.default,this.PassHBlur=U.default,this.PassFxaa=q.default,this.MultisampleFrameBuffer=_.default,this.TransformFeedbackObject=m.default,o)o[t]&&(window[t]=o[t])}return a(e,[{key:"log",value:function(){for(var e in navigator.userAgent.indexOf("Chrome")>-1?console.log("%clib alfrid : VERSION 0.2.0","background: #193441; color: #FCFFF5"):console.log("lib alfrid : VERSION ","0.2.0"),console.log("%cClasses : ","color: #193441"),this)this[e]&&console.log("%c - "+e,"color: #3E606F")}}]),e}(),te=new ee;t.default=te,t.GL=u.default,t.GLShader=s.default,t.GLTexture=l.default,t.GLCubeTexture=f.default,t.Mesh=c.default,t.Geom=h.default,t.Batch=d.default,t.FrameBuffer=v.default,t.CubeFrameBuffer=p.default,t.MultisampleFrameBuffer=_.default,t.TransformFeedbackObject=m.default,t.Scheduler=b.default,t.EventDispatcher=g.default,t.EaseNumber=y.default,t.TweenNumber=E.default,t.OrbitalControl=M.default,t.QuatRotation=T.default,t.TouchDetector=x.default,t.Camera=w.default,t.CameraOrtho=A.default,t.CameraPerspective=R.default,t.CameraCube=P.default,t.Ray=O.default,t.Object3D=S.default,t.BinaryLoader=L.default,t.ObjLoader=N.default,t.HDRLoader=I.default,t.ColladaParser=k.default,t.EffectComposer=F.default,t.Pass=C.default,t.PassMacro=D.default,t.PassBlur=B.default,t.PassVBlur=j.default,t.PassHBlur=U.default,t.PassFxaa=q.default,t.BatchCopy=X.default,t.BatchAxis=V.default,t.BatchBall=G.default,t.BatchDotsPlane=Y.default,t.BatchLine=H.default,t.BatchSkybox=W.default,t.BatchSky=z.default,t.BatchFXAA=Z.default,t.Scene=Q.default,t.View=K.default,t.View3D=J.default,t.ShaderLibs=$.default},function(e,t,r){function n(){var e=new R.ARRAY_TYPE(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function i(e){var t=new R.ARRAY_TYPE(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}function u(e,t,r,n){var i=new R.ARRAY_TYPE(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function s(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function l(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}function f(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null}function c(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e}function h(e){return e[0]*e[3]-e[2]*e[1]}function d(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=r[0],s=r[1],l=r[2],f=r[3];return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=n*l+a*f,e[3]=i*l+o*f,e}function v(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+a*u,e[1]=i*s+o*u,e[2]=n*-u+a*s,e[3]=i*-u+o*s,e}function p(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=r[0],s=r[1];return e[0]=n*u,e[1]=i*u,e[2]=a*s,e[3]=o*s,e}function _(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e}function m(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e}function b(e){return"mat2("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}function g(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}function y(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]}function E(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function M(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function T(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function x(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=t[0],u=t[1],s=t[2],l=t[3];return Math.abs(r-o)<=R.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-u)<=R.EPSILON*Math.max(1,Math.abs(n),Math.abs(u))&&Math.abs(i-s)<=R.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(a-l)<=R.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))}function w(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function A(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=n,t.clone=i,t.copy=a,t.identity=o,t.fromValues=u,t.set=s,t.transpose=l,t.invert=f,t.adjoint=c,t.determinant=h,t.multiply=d,t.rotate=v,t.scale=p,t.fromRotation=_,t.fromScaling=m,t.str=b,t.frob=g,t.LDU=y,t.add=E,t.subtract=M,t.exactEquals=T,t.equals=x,t.multiplyScalar=w,t.multiplyScalarAndAdd=A;var R=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3));t.mul=d,t.sub=M},function(e,t,r){function n(){var e=new A.ARRAY_TYPE(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function i(e){var t=new A.ARRAY_TYPE(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function u(e,t,r,n,i,a){var o=new A.ARRAY_TYPE(6);return o[0]=e,o[1]=t,o[2]=r,o[3]=n,o[4]=i,o[5]=a,o}function s(e,t,r,n,i,a,o){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e}function l(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=r*a-n*i;return s?(s=1/s,e[0]=a*s,e[1]=-n*s,e[2]=-i*s,e[3]=r*s,e[4]=(i*u-a*o)*s,e[5]=(n*o-r*u)*s,e):null}function f(e){return e[0]*e[3]-e[1]*e[2]}function c(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=r[0],f=r[1],c=r[2],h=r[3],d=r[4],v=r[5];return e[0]=n*l+a*f,e[1]=i*l+o*f,e[2]=n*c+a*h,e[3]=i*c+o*h,e[4]=n*d+a*v+u,e[5]=i*d+o*v+s,e}function h(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=Math.sin(r),f=Math.cos(r);return e[0]=n*f+a*l,e[1]=i*f+o*l,e[2]=n*-l+a*f,e[3]=i*-l+o*f,e[4]=u,e[5]=s,e}function d(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=r[0],f=r[1];return e[0]=n*l,e[1]=i*l,e[2]=a*f,e[3]=o*f,e[4]=u,e[5]=s,e}function v(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=r[0],f=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*l+a*f+u,e[5]=i*l+o*f+s,e}function p(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=-r,e[3]=n,e[4]=0,e[5]=0,e}function _(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=t[1],e[4]=0,e[5]=0,e}function m(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=t[0],e[5]=t[1],e}function b(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function g(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)}function y(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e}function E(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e}function M(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e}function T(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e}function x(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]}function w(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=t[0],l=t[1],f=t[2],c=t[3],h=t[4],d=t[5];return Math.abs(r-s)<=A.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-l)<=A.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-f)<=A.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-c)<=A.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(o-h)<=A.EPSILON*Math.max(1,Math.abs(o),Math.abs(h))&&Math.abs(u-d)<=A.EPSILON*Math.max(1,Math.abs(u),Math.abs(d))}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=n,t.clone=i,t.copy=a,t.identity=o,t.fromValues=u,t.set=s,t.invert=l,t.determinant=f,t.multiply=c,t.rotate=h,t.scale=d,t.translate=v,t.fromRotation=p,t.fromScaling=_,t.fromTranslation=m,t.str=b,t.frob=g,t.add=y,t.subtract=E,t.multiplyScalar=M,t.multiplyScalarAndAdd=T,t.exactEquals=x,t.equals=w;var A=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3));t.mul=c,t.sub=E},function(e,t,r){function n(){var e=new W.ARRAY_TYPE(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function i(e){var t=new W.ARRAY_TYPE(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(e,t,r,n,i,a,o,u,s,l,f,c,h,d,v,p){var _=new W.ARRAY_TYPE(16);return _[0]=e,_[1]=t,_[2]=r,_[3]=n,_[4]=i,_[5]=a,_[6]=o,_[7]=u,_[8]=s,_[9]=l,_[10]=f,_[11]=c,_[12]=h,_[13]=d,_[14]=v,_[15]=p,_}function u(e,t,r,n,i,a,o,u,s,l,f,c,h,d,v,p,_){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e[4]=a,e[5]=o,e[6]=u,e[7]=s,e[8]=l,e[9]=f,e[10]=c,e[11]=h,e[12]=d,e[13]=v,e[14]=p,e[15]=_,e}function s(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function l(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],u=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=u}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function f(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],f=t[8],c=t[9],h=t[10],d=t[11],v=t[12],p=t[13],_=t[14],m=t[15],b=r*u-n*o,g=r*s-i*o,y=r*l-a*o,E=n*s-i*u,M=n*l-a*u,T=i*l-a*s,x=f*p-c*v,w=f*_-h*v,A=f*m-d*v,R=c*_-h*p,P=c*m-d*p,O=h*m-d*_,S=b*O-g*P+y*R+E*A-M*w+T*x;return S?(S=1/S,e[0]=(u*O-s*P+l*R)*S,e[1]=(i*P-n*O-a*R)*S,e[2]=(p*T-_*M+m*E)*S,e[3]=(h*M-c*T-d*E)*S,e[4]=(s*A-o*O-l*w)*S,e[5]=(r*O-i*A+a*w)*S,e[6]=(_*y-v*T-m*g)*S,e[7]=(f*T-h*y+d*g)*S,e[8]=(o*P-u*A+l*x)*S,e[9]=(n*A-r*P-a*x)*S,e[10]=(v*M-p*y+m*b)*S,e[11]=(c*y-f*M-d*b)*S,e[12]=(u*w-o*R-s*x)*S,e[13]=(r*R-n*w+i*x)*S,e[14]=(p*g-v*E-_*b)*S,e[15]=(f*E-c*g+h*b)*S,e):null}function c(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],u=t[5],s=t[6],l=t[7],f=t[8],c=t[9],h=t[10],d=t[11],v=t[12],p=t[13],_=t[14],m=t[15];return e[0]=u*(h*m-d*_)-c*(s*m-l*_)+p*(s*d-l*h),e[1]=-(n*(h*m-d*_)-c*(i*m-a*_)+p*(i*d-a*h)),e[2]=n*(s*m-l*_)-u*(i*m-a*_)+p*(i*l-a*s),e[3]=-(n*(s*d-l*h)-u*(i*d-a*h)+c*(i*l-a*s)),e[4]=-(o*(h*m-d*_)-f*(s*m-l*_)+v*(s*d-l*h)),e[5]=r*(h*m-d*_)-f*(i*m-a*_)+v*(i*d-a*h),e[6]=-(r*(s*m-l*_)-o*(i*m-a*_)+v*(i*l-a*s)),e[7]=r*(s*d-l*h)-o*(i*d-a*h)+f*(i*l-a*s),e[8]=o*(c*m-d*p)-f*(u*m-l*p)+v*(u*d-l*c),e[9]=-(r*(c*m-d*p)-f*(n*m-a*p)+v*(n*d-a*c)),e[10]=r*(u*m-l*p)-o*(n*m-a*p)+v*(n*l-a*u),e[11]=-(r*(u*d-l*c)-o*(n*d-a*c)+f*(n*l-a*u)),e[12]=-(o*(c*_-h*p)-f*(u*_-s*p)+v*(u*h-s*c)),e[13]=r*(c*_-h*p)-f*(n*_-i*p)+v*(n*h-i*c),e[14]=-(r*(u*_-s*p)-o*(n*_-i*p)+v*(n*s-i*u)),e[15]=r*(u*h-s*c)-o*(n*h-i*c)+f*(n*s-i*u),e}function h(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],u=e[6],s=e[7],l=e[8],f=e[9],c=e[10],h=e[11],d=e[12],v=e[13],p=e[14],_=e[15];return(t*o-r*a)*(c*_-h*p)-(t*u-n*a)*(f*_-h*v)+(t*s-i*a)*(f*p-c*v)+(r*u-n*o)*(l*_-h*d)-(r*s-i*o)*(l*p-c*d)+(n*s-i*u)*(l*v-f*d)}function d(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=t[4],s=t[5],l=t[6],f=t[7],c=t[8],h=t[9],d=t[10],v=t[11],p=t[12],_=t[13],m=t[14],b=t[15],g=r[0],y=r[1],E=r[2],M=r[3];return e[0]=g*n+y*u+E*c+M*p,e[1]=g*i+y*s+E*h+M*_,e[2]=g*a+y*l+E*d+M*m,e[3]=g*o+y*f+E*v+M*b,g=r[4],y=r[5],E=r[6],M=r[7],e[4]=g*n+y*u+E*c+M*p,e[5]=g*i+y*s+E*h+M*_,e[6]=g*a+y*l+E*d+M*m,e[7]=g*o+y*f+E*v+M*b,g=r[8],y=r[9],E=r[10],M=r[11],e[8]=g*n+y*u+E*c+M*p,e[9]=g*i+y*s+E*h+M*_,e[10]=g*a+y*l+E*d+M*m,e[11]=g*o+y*f+E*v+M*b,g=r[12],y=r[13],E=r[14],M=r[15],e[12]=g*n+y*u+E*c+M*p,e[13]=g*i+y*s+E*h+M*_,e[14]=g*a+y*l+E*d+M*m,e[15]=g*o+y*f+E*v+M*b,e}function v(e,t,r){var n=r[0],i=r[1],a=r[2],o=void 0,u=void 0,s=void 0,l=void 0,f=void 0,c=void 0,h=void 0,d=void 0,v=void 0,p=void 0,_=void 0,m=void 0;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],u=t[1],s=t[2],l=t[3],f=t[4],c=t[5],h=t[6],d=t[7],v=t[8],p=t[9],_=t[10],m=t[11],e[0]=o,e[1]=u,e[2]=s,e[3]=l,e[4]=f,e[5]=c,e[6]=h,e[7]=d,e[8]=v,e[9]=p,e[10]=_,e[11]=m,e[12]=o*n+f*i+v*a+t[12],e[13]=u*n+c*i+p*a+t[13],e[14]=s*n+h*i+_*a+t[14],e[15]=l*n+d*i+m*a+t[15]),e}function p(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function _(e,t,r,n){var i=n[0],a=n[1],o=n[2],u=Math.sqrt(i*i+a*a+o*o),s=void 0,l=void 0,f=void 0,c=void 0,h=void 0,d=void 0,v=void 0,p=void 0,_=void 0,m=void 0,b=void 0,g=void 0,y=void 0,E=void 0,M=void 0,T=void 0,x=void 0,w=void 0,A=void 0,R=void 0,P=void 0,O=void 0,S=void 0,L=void 0;return Math.abs(u)<W.EPSILON?null:(i*=u=1/u,a*=u,o*=u,s=Math.sin(r),f=1-(l=Math.cos(r)),c=t[0],h=t[1],d=t[2],v=t[3],p=t[4],_=t[5],m=t[6],b=t[7],g=t[8],y=t[9],E=t[10],M=t[11],T=i*i*f+l,x=a*i*f+o*s,w=o*i*f-a*s,A=i*a*f-o*s,R=a*a*f+l,P=o*a*f+i*s,O=i*o*f+a*s,S=a*o*f-i*s,L=o*o*f+l,e[0]=c*T+p*x+g*w,e[1]=h*T+_*x+y*w,e[2]=d*T+m*x+E*w,e[3]=v*T+b*x+M*w,e[4]=c*A+p*R+g*P,e[5]=h*A+_*R+y*P,e[6]=d*A+m*R+E*P,e[7]=v*A+b*R+M*P,e[8]=c*O+p*S+g*L,e[9]=h*O+_*S+y*L,e[10]=d*O+m*S+E*L,e[11]=v*O+b*S+M*L,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function m(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],u=t[6],s=t[7],l=t[8],f=t[9],c=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+l*n,e[5]=o*i+f*n,e[6]=u*i+c*n,e[7]=s*i+h*n,e[8]=l*i-a*n,e[9]=f*i-o*n,e[10]=c*i-u*n,e[11]=h*i-s*n,e}function b(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],u=t[2],s=t[3],l=t[8],f=t[9],c=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-l*n,e[1]=o*i-f*n,e[2]=u*i-c*n,e[3]=s*i-h*n,e[8]=a*n+l*i,e[9]=o*n+f*i,e[10]=u*n+c*i,e[11]=s*n+h*i,e}function g(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],u=t[2],s=t[3],l=t[4],f=t[5],c=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+l*n,e[1]=o*i+f*n,e[2]=u*i+c*n,e[3]=s*i+h*n,e[4]=l*i-a*n,e[5]=f*i-o*n,e[6]=c*i-u*n,e[7]=h*i-s*n,e}function y(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function E(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function M(e,t,r){var n=r[0],i=r[1],a=r[2],o=Math.sqrt(n*n+i*i+a*a),u=void 0,s=void 0,l=void 0;return Math.abs(o)<W.EPSILON?null:(n*=o=1/o,i*=o,a*=o,u=Math.sin(t),l=1-(s=Math.cos(t)),e[0]=n*n*l+s,e[1]=i*n*l+a*u,e[2]=a*n*l-i*u,e[3]=0,e[4]=n*i*l-a*u,e[5]=i*i*l+s,e[6]=a*i*l+n*u,e[7]=0,e[8]=n*a*l+i*u,e[9]=i*a*l-n*u,e[10]=a*a*l+s,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function T(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function x(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=n,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function w(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function A(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=n+n,s=i+i,l=a+a,f=n*u,c=n*s,h=n*l,d=i*s,v=i*l,p=a*l,_=o*u,m=o*s,b=o*l;return e[0]=1-(d+p),e[1]=c+b,e[2]=h-m,e[3]=0,e[4]=c-b,e[5]=1-(f+p),e[6]=v+_,e[7]=0,e[8]=h+m,e[9]=v-_,e[10]=1-(f+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function R(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function P(e,t){var r=t[0],n=t[1],i=t[2],a=t[4],o=t[5],u=t[6],s=t[8],l=t[9],f=t[10];return e[0]=Math.sqrt(r*r+n*n+i*i),e[1]=Math.sqrt(a*a+o*o+u*u),e[2]=Math.sqrt(s*s+l*l+f*f),e}function O(e,t){var r=t[0]+t[5]+t[10],n=0;return r>0?(n=2*Math.sqrt(r+1),e[3]=.25*n,e[0]=(t[6]-t[9])/n,e[1]=(t[8]-t[2])/n,e[2]=(t[1]-t[4])/n):t[0]>t[5]&t[0]>t[10]?(n=2*Math.sqrt(1+t[0]-t[5]-t[10]),e[3]=(t[6]-t[9])/n,e[0]=.25*n,e[1]=(t[1]+t[4])/n,e[2]=(t[8]+t[2])/n):t[5]>t[10]?(n=2*Math.sqrt(1+t[5]-t[0]-t[10]),e[3]=(t[8]-t[2])/n,e[0]=(t[1]+t[4])/n,e[1]=.25*n,e[2]=(t[6]+t[9])/n):(n=2*Math.sqrt(1+t[10]-t[0]-t[5]),e[3]=(t[1]-t[4])/n,e[0]=(t[8]+t[2])/n,e[1]=(t[6]+t[9])/n,e[2]=.25*n),e}function S(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=t[3],s=i+i,l=a+a,f=o+o,c=i*s,h=i*l,d=i*f,v=a*l,p=a*f,_=o*f,m=u*s,b=u*l,g=u*f,y=n[0],E=n[1],M=n[2];return e[0]=(1-(v+_))*y,e[1]=(h+g)*y,e[2]=(d-b)*y,e[3]=0,e[4]=(h-g)*E,e[5]=(1-(c+_))*E,e[6]=(p+m)*E,e[7]=0,e[8]=(d+b)*M,e[9]=(p-m)*M,e[10]=(1-(c+v))*M,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function L(e,t,r,n,i){var a=t[0],o=t[1],u=t[2],s=t[3],l=a+a,f=o+o,c=u+u,h=a*l,d=a*f,v=a*c,p=o*f,_=o*c,m=u*c,b=s*l,g=s*f,y=s*c,E=n[0],M=n[1],T=n[2],x=i[0],w=i[1],A=i[2];return e[0]=(1-(p+m))*E,e[1]=(d+y)*E,e[2]=(v-g)*E,e[3]=0,e[4]=(d-y)*M,e[5]=(1-(h+m))*M,e[6]=(_+b)*M,e[7]=0,e[8]=(v+g)*T,e[9]=(_-b)*T,e[10]=(1-(h+p))*T,e[11]=0,e[12]=r[0]+x-(e[0]*x+e[4]*w+e[8]*A),e[13]=r[1]+w-(e[1]*x+e[5]*w+e[9]*A),e[14]=r[2]+A-(e[2]*x+e[6]*w+e[10]*A),e[15]=1,e}function N(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,u=n+n,s=i+i,l=r*o,f=n*o,c=n*u,h=i*o,d=i*u,v=i*s,p=a*o,_=a*u,m=a*s;return e[0]=1-c-v,e[1]=f+m,e[2]=h-_,e[3]=0,e[4]=f-m,e[5]=1-l-v,e[6]=d+p,e[7]=0,e[8]=h+_,e[9]=d-p,e[10]=1-l-c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function I(e,t,r,n,i,a,o){var u=1/(r-t),s=1/(i-n),l=1/(a-o);return e[0]=2*a*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*a*s,e[6]=0,e[7]=0,e[8]=(r+t)*u,e[9]=(i+n)*s,e[10]=(o+a)*l,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*l,e[15]=0,e}function k(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e}function F(e,t,r,n){var i=Math.tan(t.upDegrees*Math.PI/180),a=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),u=Math.tan(t.rightDegrees*Math.PI/180),s=2/(o+u),l=2/(i+a);return e[0]=s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=l,e[6]=0,e[7]=0,e[8]=-(o-u)*s*.5,e[9]=(i-a)*l*.5,e[10]=n/(r-n),e[11]=-1,e[12]=0,e[13]=0,e[14]=n*r/(r-n),e[15]=0,e}function C(e,t,r,n,i,a,o){var u=1/(t-r),s=1/(n-i),l=1/(a-o);return e[0]=-2*u,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*s,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*l,e[11]=0,e[12]=(t+r)*u,e[13]=(i+n)*s,e[14]=(o+a)*l,e[15]=1,e}function D(e,t,r,n){var i=void 0,a=void 0,o=void 0,u=void 0,s=void 0,l=void 0,f=void 0,c=void 0,h=void 0,d=void 0,v=t[0],p=t[1],_=t[2],m=n[0],b=n[1],g=n[2],y=r[0],E=r[1],M=r[2];return Math.abs(v-y)<W.EPSILON&&Math.abs(p-E)<W.EPSILON&&Math.abs(_-M)<W.EPSILON?mat4.identity(e):(f=v-y,c=p-E,h=_-M,i=b*(h*=d=1/Math.sqrt(f*f+c*c+h*h))-g*(c*=d),a=g*(f*=d)-m*h,o=m*c-b*f,(d=Math.sqrt(i*i+a*a+o*o))?(i*=d=1/d,a*=d,o*=d):(i=0,a=0,o=0),u=c*o-h*a,s=h*i-f*o,l=f*a-c*i,(d=Math.sqrt(u*u+s*s+l*l))?(u*=d=1/d,s*=d,l*=d):(u=0,s=0,l=0),e[0]=i,e[1]=u,e[2]=f,e[3]=0,e[4]=a,e[5]=s,e[6]=c,e[7]=0,e[8]=o,e[9]=l,e[10]=h,e[11]=0,e[12]=-(i*v+a*p+o*_),e[13]=-(u*v+s*p+l*_),e[14]=-(f*v+c*p+h*_),e[15]=1,e)}function B(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=n[0],s=n[1],l=n[2],f=i-r[0],c=a-r[1],h=o-r[2],d=f*f+c*c+h*h;d>0&&(f*=d=1/Math.sqrt(d),c*=d,h*=d);var v=s*h-l*c,p=l*f-u*h,_=u*c-s*f;return e[0]=v,e[1]=p,e[2]=_,e[3]=0,e[4]=c*_-h*p,e[5]=h*v-f*_,e[6]=f*p-c*v,e[7]=0,e[8]=f,e[9]=c,e[10]=h,e[11]=0,e[12]=i,e[13]=a,e[14]=o,e[15]=1,e}function j(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"}function U(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))}function q(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function X(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function V(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function G(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e[4]=t[4]+r[4]*n,e[5]=t[5]+r[5]*n,e[6]=t[6]+r[6]*n,e[7]=t[7]+r[7]*n,e[8]=t[8]+r[8]*n,e[9]=t[9]+r[9]*n,e[10]=t[10]+r[10]*n,e[11]=t[11]+r[11]*n,e[12]=t[12]+r[12]*n,e[13]=t[13]+r[13]*n,e[14]=t[14]+r[14]*n,e[15]=t[15]+r[15]*n,e}function Y(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function H(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],o=e[4],u=e[5],s=e[6],l=e[7],f=e[8],c=e[9],h=e[10],d=e[11],v=e[12],p=e[13],_=e[14],m=e[15],b=t[0],g=t[1],y=t[2],E=t[3],M=t[4],T=t[5],x=t[6],w=t[7],A=t[8],R=t[9],P=t[10],O=t[11],S=t[12],L=t[13],N=t[14],I=t[15];return Math.abs(r-b)<=W.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-g)<=W.EPSILON*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-y)<=W.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(a-E)<=W.EPSILON*Math.max(1,Math.abs(a),Math.abs(E))&&Math.abs(o-M)<=W.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(u-T)<=W.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(s-x)<=W.EPSILON*Math.max(1,Math.abs(s),Math.abs(x))&&Math.abs(l-w)<=W.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(f-A)<=W.EPSILON*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(c-R)<=W.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(h-P)<=W.EPSILON*Math.max(1,Math.abs(h),Math.abs(P))&&Math.abs(d-O)<=W.EPSILON*Math.max(1,Math.abs(d),Math.abs(O))&&Math.abs(v-S)<=W.EPSILON*Math.max(1,Math.abs(v),Math.abs(S))&&Math.abs(p-L)<=W.EPSILON*Math.max(1,Math.abs(p),Math.abs(L))&&Math.abs(_-N)<=W.EPSILON*Math.max(1,Math.abs(_),Math.abs(N))&&Math.abs(m-I)<=W.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))}Object.defineProperty(t,"__esModule",{value:!0}),t.sub=t.mul=void 0,t.create=n,t.clone=i,t.copy=a,t.fromValues=o,t.set=u,t.identity=s,t.transpose=l,t.invert=f,t.adjoint=c,t.determinant=h,t.multiply=d,t.translate=v,t.scale=p,t.rotate=_,t.rotateX=m,t.rotateY=b,t.rotateZ=g,t.fromTranslation=y,t.fromScaling=E,t.fromRotation=M,t.fromXRotation=T,t.fromYRotation=x,t.fromZRotation=w,t.fromRotationTranslation=A,t.getTranslation=R,t.getScaling=P,t.getRotation=O,t.fromRotationTranslationScale=S,t.fromRotationTranslationScaleOrigin=L,t.fromQuat=N,t.frustum=I,t.perspective=k,t.perspectiveFromFieldOfView=F,t.ortho=C,t.lookAt=D,t.targetTo=B,t.str=j,t.frob=U,t.add=q,t.subtract=X,t.multiplyScalar=V,t.multiplyScalarAndAdd=G,t.exactEquals=Y,t.equals=H;var W=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3));t.mul=d,t.sub=X},function(e,t,r){function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function i(){var e=new w.ARRAY_TYPE(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function a(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function o(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function u(e,t){var r=2*Math.acos(t[3]),n=Math.sin(r/2);return 0!=n?(e[0]=t[0]/n,e[1]=t[1]/n,e[2]=t[2]/n):(e[0]=1,e[1]=0,e[2]=0),r}function s(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],u=r[0],s=r[1],l=r[2],f=r[3];return e[0]=n*f+o*u+i*l-a*s,e[1]=i*f+o*s+a*u-n*l,e[2]=a*f+o*l+n*s-i*u,e[3]=o*f-n*u-i*s-a*l,e}function l(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+o*u,e[1]=i*s+a*u,e[2]=a*s-i*u,e[3]=o*s-n*u,e}function f(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s-a*u,e[1]=i*s+o*u,e[2]=a*s+n*u,e[3]=o*s-i*u,e}function c(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],u=Math.sin(r),s=Math.cos(r);return e[0]=n*s+i*u,e[1]=i*s-n*u,e[2]=a*s+o*u,e[3]=o*s-a*u,e}function h(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e}function d(e,t,r,n){var i=t[0],a=t[1],o=t[2],u=t[3],s=r[0],l=r[1],f=r[2],c=r[3],h=void 0,d=void 0,v=void 0,p=void 0,_=void 0;return(d=i*s+a*l+o*f+u*c)<0&&(d=-d,s=-s,l=-l,f=-f,c=-c),1-d>1e-6?(h=Math.acos(d),v=Math.sin(h),p=Math.sin((1-n)*h)/v,_=Math.sin(n*h)/v):(p=1-n,_=n),e[0]=p*i+_*s,e[1]=p*a+_*l,e[2]=p*o+_*f,e[3]=p*u+_*c,e}function v(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,u=o?1/o:0;return e[0]=-r*u,e[1]=-n*u,e[2]=-i*u,e[3]=a*u,e}function p(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function _(e,t){var r=t[0]+t[4]+t[8],n=void 0;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[3*i+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[3*i+i]-t[3*a+a]-t[3*o+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[3*a+o]-t[3*o+a])*n,e[a]=(t[3*a+i]+t[3*i+a])*n,e[o]=(t[3*o+i]+t[3*i+o])*n}return e}function m(e,t,r,n){var i=.5*Math.PI/180;t*=i,r*=i,n*=i;var a=Math.sin(t),o=Math.cos(t),u=Math.sin(r),s=Math.cos(r),l=Math.sin(n),f=Math.cos(n);return e[0]=a*s*f-o*u*l,e[1]=o*u*f+a*s*l,e[2]=o*s*l-a*u*f,e[3]=o*s*f+a*u*l,e}function b(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}Object.defineProperty(t,"__esModule",{value:!0}),t.setAxes=t.sqlerp=t.rotationTo=t.equals=t.exactEquals=t.normalize=t.sqrLen=t.squaredLength=t.len=t.length=t.lerp=t.dot=t.scale=t.mul=t.add=t.set=t.copy=t.fromValues=t.clone=void 0,t.create=i,t.identity=a,t.setAxisAngle=o,t.getAxisAngle=u,t.multiply=s,t.rotateX=l,t.rotateY=f,t.rotateZ=c,t.calculateW=h,t.slerp=d,t.invert=v,t.conjugate=p,t.fromMat3=_,t.fromEuler=m,t.str=b;var g,y,E,M,T,x,w=n(r(3)),A=n(r(20)),R=n(r(21)),P=n(r(22)),O=(t.clone=P.clone,t.fromValues=P.fromValues,t.copy=P.copy,t.set=P.set,t.add=P.add,t.mul=s,t.scale=P.scale,t.dot=P.dot,t.lerp=P.lerp,t.length=P.length),S=(t.len=O,t.squaredLength=P.squaredLength),L=(t.sqrLen=S,t.normalize=P.normalize);t.exactEquals=P.exactEquals,t.equals=P.equals,t.rotationTo=(M=R.create(),T=R.fromValues(1,0,0),x=R.fromValues(0,1,0),function(e,t,r){var n=R.dot(t,r);return n<-.999999?(R.cross(M,T,t),R.len(M)<1e-6&&R.cross(M,x,t),R.normalize(M,M),o(e,M,Math.PI),e):n>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(R.cross(M,t,r),e[0]=M[0],e[1]=M[1],e[2]=M[2],e[3]=1+n,L(e,e))}),t.sqlerp=(y=i(),E=i(),function(e,t,r,n,i,a){return d(y,t,i,a),d(E,r,n,a),d(e,y,E,2*a*(1-a)),e}),t.setAxes=(g=A.create(),function(e,t,r,n){return g[0]=r[0],g[3]=r[1],g[6]=r[2],g[1]=n[0],g[4]=n[1],g[7]=n[2],g[2]=-t[0],g[5]=-t[1],g[8]=-t[2],L(e,_(e,g))})},function(e,t,r){function n(){var e=new B.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e}function i(e){var t=new B.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t}function a(e,t){var r=new B.ARRAY_TYPE(2);return r[0]=e,r[1]=t,r}function o(e,t){return e[0]=t[0],e[1]=t[1],e}function u(e,t,r){return e[0]=t,e[1]=r,e}function s(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function l(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function f(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function c(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function h(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function d(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function v(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function p(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function _(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}function m(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function b(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function g(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function y(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}function E(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function M(e){var t=e[0],r=e[1];return t*t+r*r}function T(e,t){return e[0]=-t[0],e[1]=-t[1],e}function x(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function w(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e}function A(e,t){return e[0]*t[0]+e[1]*t[1]}function R(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}function P(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}function O(e,t){t=t||1;var r=2*B.RANDOM()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function S(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e}function L(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function N(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e}function I(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e}function k(e){return"vec2("+e[0]+", "+e[1]+")"}function F(e,t){return e[0]===t[0]&&e[1]===t[1]}function C(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=B.EPSILON*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-a)<=B.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))}Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=t.sqrLen=t.sqrDist=t.dist=t.div=t.mul=t.sub=t.len=void 0,t.create=n,t.clone=i,t.fromValues=a,t.copy=o,t.set=u,t.add=s,t.subtract=l,t.multiply=f,t.divide=c,t.ceil=h,t.floor=d,t.min=v,t.max=p,t.round=_,t.scale=m,t.scaleAndAdd=b,t.distance=g,t.squaredDistance=y,t.length=E,t.squaredLength=M,t.negate=T,t.inverse=x,t.normalize=w,t.dot=A,t.cross=R,t.lerp=P,t.random=O,t.transformMat2=S,t.transformMat2d=L,t.transformMat3=N,t.transformMat4=I,t.str=k,t.exactEquals=F,t.equals=C;var D,B=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}(r(3));t.len=E,t.sub=l,t.mul=f,t.div=c,t.dist=g,t.sqrDist=y,t.sqrLen=M,t.forEach=(D=n(),function(e,t,r,n,i,a){var o=void 0,u=void 0;for(t||(t=2),r||(r=0),u=n?Math.min(n*t+r,e.length):e.length,o=r;o<u;o+=t)D[0]=e[o],D[1]=e[o+1],i(D,D,a),e[o]=D[0],e[o+1]=D[1];return e})},function(e,t,r){function n(e,t){var r=e.getExtension(t);if(!r)return!1;var n=t.split("_")[0],i=new RegExp(n+"$");for(var a in r)if("function"==typeof r[a]){var o=a.replace(i,"");a.substring&&(e[o]=r[a].bind(r))}return!0}Object.defineProperty(t,"__esModule",{value:!0}),t.default=n},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),a=(n=i)&&n.__esModule?n:{default:n},o=function(){a.default.VERTEX_SHADER=a.default.gl.VERTEX_SHADER,a.default.FRAGMENT_SHADER=a.default.gl.FRAGMENT_SHADER,a.default.COMPILE_STATUS=a.default.gl.COMPILE_STATUS,a.default.DEPTH_TEST=a.default.gl.DEPTH_TEST,a.default.CULL_FACE=a.default.gl.CULL_FACE,a.default.BLEND=a.default.gl.BLEND,a.default.POINTS=a.default.gl.POINTS,a.default.LINES=a.default.gl.LINES,a.default.TRIANGLES=a.default.gl.TRIANGLES,a.default.LINEAR=a.default.gl.LINEAR,a.default.NEAREST=a.default.gl.NEAREST,a.default.LINEAR_MIPMAP_NEAREST=a.default.gl.LINEAR_MIPMAP_NEAREST,a.default.NEAREST_MIPMAP_LINEAR=a.default.gl.NEAREST_MIPMAP_LINEAR,a.default.LINEAR_MIPMAP_LINEAR=a.default.gl.LINEAR_MIPMAP_LINEAR,a.default.NEAREST_MIPMAP_NEAREST=a.default.gl.NEAREST_MIPMAP_NEAREST,a.default.MIRRORED_REPEAT=a.default.gl.MIRRORED_REPEAT,a.default.CLAMP_TO_EDGE=a.default.gl.CLAMP_TO_EDGE,a.default.SCISSOR_TEST=a.default.gl.SCISSOR_TEST,a.default.UNSIGNED_BYTE=a.default.gl.UNSIGNED_BYTE};t.default=o},function(e,t,r){function n(){return o.default.webgl2||o.default.getExtension("OES_texture_float")?o.default.gl.FLOAT:(console.warn("USING FLOAT BUT OES_texture_float NOT SUPPORTED"),o.default.gl.UNSIGNED_BYTE)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return u||(s=n()),s};var i,a=r(0),o=(i=a)&&i.__esModule?i:{default:i},u=!1,s=void 0},function(e,t,r){function n(){if(o.default.webgl2)return o.default.gl.HALF_FLOAT;var e=o.default.getExtension("OES_texture_half_float");return e?e.HALF_FLOAT_OES:(console.warn("USING HALF FLOAT BUT OES_texture_half_float NOT SUPPORTED"),o.default.gl.UNSIGNED_BYTE)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return u||(s=n()),s};var i,a=r(0),o=(i=a)&&i.__esModule?i:{default:i},u=!1,s=void 0},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=["EXT_shader_texture_lod","EXT_sRGB","EXT_frag_depth","OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","WEBGL_depth_texture","EXT_texture_filter_anisotropic","OES_vertex_array_object","ANGLE_instanced_arrays","WEBGL_draw_buffers"]},function(e,t,r){e.exports=function(e){"string"==typeof e&&(e=[e]);for(var t=[].slice.call(arguments,1),r=[],n=0;n<e.length-1;n++)r.push(e[n],t[n]||"");return r.push(e[n]),r.join("")}},function(e,t){e.exports="// basic.frag\n\n#define SHADER_NAME BASIC_FRAGMENT\n\nprecision lowp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform float time;\n// uniform sampler2D texture;\n\nvoid main(void) {\n    gl_FragColor = vec4(vTextureCoord, sin(time) * .5 + .5, 1.0);\n}"},function(e,t,r){function n(e){var t=new Int32Array(e,0,m);if(t[b]!==o)throw new Error("Invalid magic number in DDS header");if(!t[x]&s)throw new Error("Unsupported format, must contain a FourCC code");var r,n,i=t[w];switch(i){case l:r=8,n="dxt1";break;case f:r=16,n="dxt3";break;case c:r=16,n="dxt5";break;case d:n="rgba32f";break;case h:var R=new Uint32Array(e.slice(128,148));n=R[0];var P=R[1];if(R[2],R[3],R[4],P!==p||n!==_)throw new Error("Unsupported DX10 texture format "+n);n="rgba32f";break;default:throw new Error("Unsupported FourCC code: "+a(i))}var O=t[y],S=1;O&u&&(S=Math.max(1,t[T]));var L=!1;t[A]&v&&(L=!0);var N,I=t[M],k=t[E],F=t[g]+4,C=I,D=k,B=[];if(i===h&&(F+=20),L)for(var j=0;j<6;j++){if("rgba32f"!==n)throw new Error("Only RGBA32f cubemaps are supported");I=C,k=D;for(var U=Math.log(I)/Math.log(2)+1,q=0;q<U;q++)N=I*k*16,B.push({offset:F,length:N,shape:[I,k]}),q<S&&(F+=N),I=Math.floor(I/2),k=Math.floor(k/2)}else for(q=0;q<S;q++)N=Math.max(4,I)/4*Math.max(4,k)/4*r,B.push({offset:F,length:N,shape:[I,k]}),F+=N,I=Math.floor(I/2),k=Math.floor(k/2);return{shape:[C,D],images:B,format:n,flags:O,cubemap:L}}function i(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}function a(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)}var o=542327876,u=131072,s=4,l=i("DXT1"),f=i("DXT3"),c=i("DXT5"),h=i("DX10"),d=116,v=512,p=3,_=2,m=31,b=0,g=1,y=2,E=3,M=4,T=7,x=20,w=21,A=28;e.exports=n},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(0)),u=n(r(24)),s=void 0,l=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};i(this,e),s=o.default.gl,this._size=t,this.magFilter=r.magFilter||s.LINEAR,this.minFilter=r.minFilter||s.LINEAR,this.wrapS=r.wrapS||s.CLAMP_TO_EDGE,this.wrapT=r.wrapT||s.CLAMP_TO_EDGE,this._init()}return a(e,[{key:"_init",value:function(){this.texture=s.createTexture(),this.glTexture=new u.default(this.texture,{},!0),s.bindTexture(s.TEXTURE_CUBE_MAP,this.texture),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MAG_FILTER,this.magFilter),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_MIN_FILTER,this.minFilter),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_S,this.wrapS),s.texParameteri(s.TEXTURE_CUBE_MAP,s.TEXTURE_WRAP_T,this.wrapT);for(var e=[s.TEXTURE_CUBE_MAP_POSITIVE_X,s.TEXTURE_CUBE_MAP_NEGATIVE_X,s.TEXTURE_CUBE_MAP_POSITIVE_Y,s.TEXTURE_CUBE_MAP_NEGATIVE_Y,s.TEXTURE_CUBE_MAP_POSITIVE_Z,s.TEXTURE_CUBE_MAP_NEGATIVE_Z],t=0;t<e.length;t++)s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),s.texImage2D(e[t],0,s.RGBA,this.width,this.height,0,s.RGBA,s.FLOAT,null);this._frameBuffers=[];for(var r=0;r<e.length;r++){var n=s.createFramebuffer();s.bindFramebuffer(s.FRAMEBUFFER,n),s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,e[r],this.texture,0);var i=s.checkFramebufferStatus(s.FRAMEBUFFER);i!==s.FRAMEBUFFER_COMPLETE&&console.log("'gl.checkFramebufferStatus() returned '"+i),this._frameBuffers.push(n)}s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindRenderbuffer(s.RENDERBUFFER,null),s.bindTexture(s.TEXTURE_CUBE_MAP,null)}},{key:"bind",value:function(e){o.default.viewport(0,0,this.width,this.height),s.bindFramebuffer(s.FRAMEBUFFER,this._frameBuffers[e])}},{key:"unbind",value:function(){s.bindFramebuffer(s.FRAMEBUFFER,null),o.default.viewport(0,0,o.default.width,o.default.height)}},{key:"getTexture",value:function(){return this.glTexture}},{key:"width",get:function(){return this._size}},{key:"height",get:function(){return this._size}}]),e}();t.default=l},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){return 0!==e&&!(e&e-1)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=n(r(0)),s=n(r(11)),l=void 0,f=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i(this,e),l=u.default.gl,this.width=t,this.height=r,this.magFilter=n.magFilter||l.LINEAR,this.minFilter=n.minFilter||l.LINEAR,this.wrapS=n.wrapS||l.CLAMP_TO_EDGE,this.wrapT=n.wrapT||l.CLAMP_TO_EDGE,this.useDepth=n.useDepth||!0,this.useStencil=n.useStencil||!1,this.texelType=n.type,this._numSample=n.numSample||8,a(this.width)&&a(this.height)||(this.wrapS=this.wrapT=l.CLAMP_TO_EDGE,this.minFilter===l.LINEAR_MIPMAP_NEAREST&&(this.minFilter=l.LINEAR)),this._init()}return o(e,[{key:"_init",value:function(){var e=l.UNSIGNED_BYTE;this.texelType&&(e=this.texelType),this.texelType=e,this.frameBuffer=l.createFramebuffer(),this.frameBufferColor=l.createFramebuffer(),this.renderBufferColor=l.createRenderbuffer(),this.renderBufferDepth=l.createRenderbuffer(),this.glTexture=this._createTexture(),this.glDepthTexture=this._createTexture(l.DEPTH_COMPONENT16,l.UNSIGNED_SHORT,l.DEPTH_COMPONENT,!0),l.bindRenderbuffer(l.RENDERBUFFER,this.renderBufferColor),l.renderbufferStorageMultisample(l.RENDERBUFFER,this._numSample,l.RGBA8,this.width,this.height),l.bindRenderbuffer(l.RENDERBUFFER,this.renderBufferDepth),l.renderbufferStorageMultisample(l.RENDERBUFFER,this._numSample,l.DEPTH_COMPONENT16,this.width,this.height),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.RENDERBUFFER,this.renderBufferColor),l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,this.renderBufferDepth),l.bindFramebuffer(l.FRAMEBUFFER,null),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBufferColor),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,this.glTexture.texture,0),l.bindFramebuffer(l.FRAMEBUFFER,null)}},{key:"_createTexture",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];void 0===e&&(e=l.RGBA),void 0===t&&(t=this.texelType),r||(r=e);var i=l.createTexture(),a=new s.default(i,!0),o=n?u.default.NEAREST:this.magFilter,f=n?u.default.NEAREST:this.minFilter;return l.bindTexture(l.TEXTURE_2D,i),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,o),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,f),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,this.wrapS),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,this.wrapT),l.texImage2D(l.TEXTURE_2D,0,e,this.width,this.height,0,r,t,null),l.bindTexture(l.TEXTURE_2D,null),a}},{key:"bind",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&u.default.viewport(0,0,this.width,this.height),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer)}},{key:"unbind",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&u.default.viewport(0,0,u.default.width,u.default.height);var e=this.width,t=this.height;l.bindFramebuffer(l.FRAMEBUFFER,null),l.bindFramebuffer(l.READ_FRAMEBUFFER,this.frameBuffer),l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.frameBufferColor),l.clearBufferfv(l.COLOR,0,[0,0,0,0]),l.blitFramebuffer(0,0,e,t,0,0,e,t,l.COLOR_BUFFER_BIT,u.default.NEAREST),l.bindFramebuffer(l.FRAMEBUFFER,null)}},{key:"getTexture",value:function(){return this.glTexture}},{key:"getDepthTexture",value:function(){return this.glDepthTexture}}]),e}();t.default=f},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(0)),u=n(r(2)),s=n(r(5)),l=void 0,f=function(){function e(t,r){i(this,e),l=o.default.gl,this._vs=t,this._fs=r,this._init()}return a(e,[{key:"_init",value:function(){this._meshCurrent=new s.default,this._meshTarget=new s.default,this._numPoints=-1,this._varyings=[],this.transformFeedback=l.createTransformFeedback()}},{key:"bufferData",value:function(e,t,r){var n=!!r;console.log("is Transform feedback ?",t,n),this._meshCurrent.bufferData(e,t,null,l.STREAM_COPY,!1),this._meshTarget.bufferData(e,t,null,l.STREAM_COPY,!1),n&&(this._varyings.push(r),this._numPoints<0&&(this._numPoints=e.length))}},{key:"bufferIndex",value:function(e){this._meshCurrent.bufferIndex(e),this._meshTarget.bufferIndex(e)}},{key:"uniform",value:function(e,t,r){this.shader&&this.shader.uniform(e,t,r)}},{key:"generate",value:function(){this.shader=new u.default(this._vs,this._fs,this._varyings)}},{key:"render",value:function(){this.shader||this.generate(),this.shader.bind(),o.default.drawTransformFeedback(this),this._swap()}},{key:"_swap",value:function(){var e=this._meshCurrent;this._meshCurrent=this._meshTarget,this._meshTarget=e}},{key:"numPoints",get:function(){return this._numPoints}},{key:"meshCurrent",get:function(){return this._meshCurrent}},{key:"meshTarget",get:function(){return this._meshTarget}},{key:"meshSource",get:function(){return this._meshCurrent}},{key:"meshDestination",get:function(){return this._meshTarget}}]),e}();t.default=f},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){switch(e){default:case"linear":return l.Linear.None;case"expIn":return l.Exponential.In;case"expOut":return l.Exponential.Out;case"expInOut":return l.Exponential.InOut;case"cubicIn":return l.Cubic.In;case"cubicOut":return l.Cubic.Out;case"cubicInOut":return l.Cubic.InOut;case"quarticIn":return l.Quartic.In;case"quarticOut":return l.Quartic.Out;case"quarticInOut":return l.Quartic.InOut;case"quinticIn":return l.Quintic.In;case"quinticOut":return l.Quintic.Out;case"quinticInOut":return l.Quintic.InOut;case"sinusoidalIn":return l.Sinusoidal.In;case"sinusoidalOut":return l.Sinusoidal.Out;case"sinusoidalInOut":return l.Sinusoidal.InOut;case"circularIn":return l.Circular.In;case"circularOut":return l.Circular.Out;case"circularInOut":return l.Circular.InOut;case"elasticIn":return l.Elastic.In;case"elasticOut":return l.Elastic.Out;case"elasticInOut":return l.Elastic.InOut;case"backIn":return l.Back.In;case"backOut":return l.Back.Out;case"backInOut":return l.Back.InOut;case"bounceIn":return l.Bounce.in;case"bounceOut":return l.Bounce.out;case"bounceInOut":return l.Bounce.inOut}}Object.defineProperty(t,"__esModule",{value:!0});var a,o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(7),s=(a=u)&&a.__esModule?a:{default:a},l={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t=void 0,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),-r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out:function(e){var t=void 0,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut:function(e){var t=void 0,r=.1;return 0===e?0:1===e?1:(!r||r<1?(r=1,t=.1):t=.4*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{in:function(e){return 1-l.Bounce.out(1-e)},out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},inOut:function(e){return e<.5?.5*l.Bounce.in(2*e):.5*l.Bounce.out(2*e-1)+.5}}},f=function(){function e(t){var r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"expOut",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.01;n(this,e),this._value=t,this._startValue=t,this._targetValue=t,this._counter=1,this.speed=a,this.easing=i,this._needUpdate=!0,this._efIndex=s.default.addEF((function(){return r._update()}))}return o(e,[{key:"_update",value:function(){var e=this._counter+this.speed;e>1&&(e=1),this._counter!==e?(this._counter=e,this._needUpdate=!0):this._needUpdate=!1}},{key:"limit",value:function(e,t){e>t?this.limit(t,e):(this._min=e,this._max=t,this._checkLimit())}},{key:"setTo",value:function(e){this._value=e,this._targetValue=e,this._counter=1}},{key:"_checkLimit",value:function(){void 0!==this._min&&this._targetValue<this._min&&(this._targetValue=this._min),void 0!==this._max&&this._targetValue>this._max&&(this._targetValue=this._max)}},{key:"destroy",value:function(){s.default.removeEF(this._efIndex)}},{key:"value",set:function(e){this._startValue=this._value,this._targetValue=e,this._checkLimit(),this._counter=0},get:function(){if(this._needUpdate){var e=i(this.easing)(this._counter);this._value=this._startValue+e*(this._targetValue-this._startValue),this._needUpdate=!1}return this._value}},{key:"targetValue",get:function(){return this._targetValue}}]),e}();t.default=f},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(1)),u=n(r(13)),s=n(r(7)),l=function(e,t){var r=t||{};return e.touches?(r.x=e.touches[0].pageX,r.y=e.touches[0].pageY):(r.x=e.clientX,r.y=e.clientY),r},f=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1;i(this,e),this._target=t,this._listenerTarget=n,this.matrix=o.default.mat4.create(),this.m=o.default.mat4.create(),this._vZaxis=o.default.vec3.clone([0,0,0]),this._zAxis=o.default.vec3.clone([0,0,1]),this.preMouse={x:0,y:0},this.mouse={x:0,y:0},this._isMouseDown=!1,this._rotation=o.default.quat.create(),this.tempRotation=o.default.quat.create(),this._rotateZMargin=0,this._offset=.004,this._slerp=-1,this._isLocked=!1,this._diffX=new u.default(0,a),this._diffY=new u.default(0,a),this._listenerTarget.addEventListener("mousedown",(function(e){return r._onDown(e)})),this._listenerTarget.addEventListener("touchstart",(function(e){return r._onDown(e)})),this._listenerTarget.addEventListener("mousemove",(function(e){return r._onMove(e)})),this._listenerTarget.addEventListener("touchmove",(function(e){return r._onMove(e)})),window.addEventListener("touchend",(function(){return r._onUp()})),window.addEventListener("mouseup",(function(){return r._onUp()})),s.default.addEF((function(){return r._loop()}))}return a(e,[{key:"inverseControl",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isInvert=e}},{key:"lock",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._isLocked=e}},{key:"setCameraPos",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;if(this.easing=t,!(this._slerp>0)){var r=o.default.quat.clone(this._rotation);this._updateRotation(r),this._rotation=o.default.quat.clone(r),this._currDiffX=this.diffX=0,this._currDiffY=this.diffY=0,this._isMouseDown=!1,this._isRotateZ=0,this._targetQuat=o.default.quat.clone(e),this._slerp=1}}},{key:"resetQuat",value:function(){this._rotation=o.default.quat.clone([0,0,1,0]),this.tempRotation=o.default.quat.clone([0,0,0,0]),this._targetQuat=void 0,this._slerp=-1}},{key:"_onDown",value:function(e){if(!this._isLocked){var t=l(e),r=o.default.quat.clone(this._rotation);this._updateRotation(r),this._rotation=r,this._isMouseDown=!0,this._isRotateZ=0,this.preMouse={x:t.x,y:t.y},t.y<this._rotateZMargin||t.y>window.innerHeight-this._rotateZMargin?this._isRotateZ=1:(t.x<this._rotateZMargin||t.x>window.innerWidth-this._rotateZMargin)&&(this._isRotateZ=2),this._diffX.setTo(0),this._diffY.setTo(0)}}},{key:"_onMove",value:function(e){this._isLocked||l(e,this.mouse)}},{key:"_onUp",value:function(){this._isLocked||(this._isMouseDown=!1)}},{key:"_updateRotation",value:function(e){this._isMouseDown&&!this._isLocked&&(this._diffX.value=-(this.mouse.x-this.preMouse.x),this._diffY.value=this.mouse.y-this.preMouse.y,this._isInvert&&(this._diffX.value=-this._diffX.targetValue,this._diffY.value=-this._diffY.targetValue));var t=void 0,r=void 0;if(this._isRotateZ>0)1===this._isRotateZ?(t=-this._diffX.value*this._offset,t*=this.preMouse.y<this._rotateZMargin?-1:1,r=o.default.quat.clone([0,0,Math.sin(t),Math.cos(t)]),o.default.quat.multiply(r,e,r)):(t=-this._diffY.value*this._offset,t*=this.preMouse.x<this._rotateZMargin?1:-1,r=o.default.quat.clone([0,0,Math.sin(t),Math.cos(t)]),o.default.quat.multiply(r,e,r));else{var n=o.default.vec3.clone([this._diffX.value,this._diffY.value,0]),i=o.default.vec3.create();o.default.vec3.cross(i,n,this._zAxis),o.default.vec3.normalize(i,i),t=o.default.vec3.length(n)*this._offset,r=o.default.quat.clone([Math.sin(t)*i[0],Math.sin(t)*i[1],Math.sin(t)*i[2],Math.cos(t)]),o.default.quat.multiply(e,r,e)}}},{key:"_loop",value:function(){o.default.mat4.identity(this.m),void 0===this._targetQuat?(o.default.quat.set(this.tempRotation,this._rotation[0],this._rotation[1],this._rotation[2],this._rotation[3]),this._updateRotation(this.tempRotation)):(this._slerp+=.1*(0-this._slerp),this._slerp<5e-4?(o.default.quat.copy(this._rotation,this._targetQuat),o.default.quat.copy(this.tempRotation,this._targetQuat),this._targetQuat=void 0,this._diffX.setTo(0),this._diffY.setTo(0),this._slerp=-1):(o.default.quat.set(this.tempRotation,0,0,0,0),o.default.quat.slerp(this.tempRotation,this._targetQuat,this._rotation,this._slerp))),o.default.vec3.transformQuat(this._vZaxis,this._vZaxis,this.tempRotation),o.default.mat4.fromQuat(this.matrix,this.tempRotation)}},{key:"easing",set:function(e){this._diffX.easing=e,this._diffY.easing=e},get:function(){return this._diffX.easing}}]),e}();t.default=f},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){var r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=n(r(0)),f=n(r(25)),c=n(r(14)),h=n(r(58)),d=function(e){function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;i(this,t);var u=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return u._mesh=e,u._mesh.generateFaces(),u._camera=r,u.faceVertices=e.faces.map((function(e){return e.vertices})),u.clickTolerance=8,u._ray=new c.default([0,0,0],[0,0,-1]),u._hit=vec3.fromValues(-999,-999,-999),u._lastPos,u._firstPos,u.mtxModel=mat4.create(),u._listenerTarget=o,u._skippingMove=n,u._onMoveBind=function(e){return u._onMove(e)},u._onDownBind=function(e){return u._onDown(e)},u._onUpBind=function(){return u._onUp()},u.connect(),u}return o(t,e),s(t,[{key:"connect",value:function(){this._listenerTarget.addEventListener("mousedown",this._onDownBind),this._listenerTarget.addEventListener("mousemove",this._onMoveBind),this._listenerTarget.addEventListener("mouseup",this._onUpBind)}},{key:"disconnect",value:function(){this._listenerTarget.removeEventListener("mousedown",this._onDownBind),this._listenerTarget.removeEventListener("mousemove",this._onMoveBind),this._listenerTarget.removeEventListener("mouseup",this._onUpBind)}},{key:"_checkHit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"onHit",r=this._camera;if(r){var n=this._lastPos.x/l.default.width*2-1,i=-this._lastPos.y/l.default.height*2+1;r.generateRay([n,i,0],this._ray);for(var a=void 0,o=vec3.create(),u=vec3.create(),s=vec3.create(),f=0,c=function(t,r){vec3.transformMat4(r,t,e.mtxModel)},h=0;h<this.faceVertices.length;h++){var d=this.faceVertices[h];c(d[0],o),c(d[1],u),c(d[2],s);var v=this._ray.intersectTriangle(o,u,s);if(v)if(a){var p=vec3.dist(v,r.position);p<f&&(a=vec3.clone(v),f=p)}else a=vec3.clone(v),f=vec3.dist(a,r.position)}a?(this._hit=vec3.clone(a),this.dispatchCustomEvent(t,{hit:a})):this.dispatchCustomEvent("onUp")}}},{key:"_onDown",value:function(e){this._firstPos=(0,h.default)(e),this._lastPos=(0,h.default)(e),this._checkHit("onDown")}},{key:"_onMove",value:function(e){this._lastPos=(0,h.default)(e),this._skippingMove||this._checkHit()}},{key:"_onUp",value:function(){u(this._firstPos,this._lastPos)<this.clickTolerance&&this._checkHit()}}]),t}(f.default);t.default=d},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=void 0,r=void 0;return e.touches?(t=e.touches[0].pageX,r=e.touches[0].pageY):(t=e.clientX,r=e.clientY),{x:t,y:r}}},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o,u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(16),l=(o=s)&&o.__esModule?o:{default:o},f=r(1),c=[[f.vec3.fromValues(0,0,0),f.vec3.fromValues(1,0,0),f.vec3.fromValues(0,-1,0)],[f.vec3.fromValues(0,0,0),f.vec3.fromValues(-1,0,0),f.vec3.fromValues(0,-1,0)],[f.vec3.fromValues(0,0,0),f.vec3.fromValues(0,1,0),f.vec3.fromValues(0,0,1)],[f.vec3.fromValues(0,0,0),f.vec3.fromValues(0,-1,0),f.vec3.fromValues(0,0,-1)],[f.vec3.fromValues(0,0,0),f.vec3.fromValues(0,0,1),f.vec3.fromValues(0,-1,0)],[f.vec3.fromValues(0,0,0),f.vec3.fromValues(0,0,-1),f.vec3.fromValues(0,-1,0)]],h=function(e){function t(){n(this,t);var e=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.setPerspective(Math.PI/2,1,.1,1e3),e}return a(t,e),u(t,[{key:"face",value:function(e){var t=c[e];this.lookAt(t[0],t[1],t[2])}}]),t}(l.default);t.default=h},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(17)),f=n(r(5)),c=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return o(t,e),u(t,[{key:"load",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4;this._drawType=n,s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"load",this).call(this,e,r)}},{key:"_onLoaded",value:function(){this.parseObj(this._req.response)}},{key:"parseObj",value:function(e){function t(e){var t=parseInt(e);return 3*(t>=0?t-1:t+h.length/3)}function r(e){var t=parseInt(e);return 3*(t>=0?t-1:t+d.length/3)}function n(e){var t=parseInt(e);return 2*(t>=0?t-1:t+v.length/2)}function i(e,t,r){l.push([h[e],h[e+1],h[e+2]]),l.push([h[t],h[t+1],h[t+2]]),l.push([h[r],h[r+1],h[r+2]]),p.push(3*_+0),p.push(3*_+1),p.push(3*_+2),_++}function a(e,t,r){f.push([v[e],v[e+1]]),f.push([v[t],v[t+1]]),f.push([v[r],v[r+1]])}function o(e,t,r){c.push([d[e],d[e+1],d[e+2]]),c.push([d[t],d[t+1],d[t+2]]),c.push([d[r],d[r+1],d[r+2]])}function u(e,u,s,l,f,c,h,d,v,p,_,m){var b=t(e),g=t(u),y=t(s),E=void 0;void 0===l?i(b,g,y):(i(b,g,E=t(l)),i(g,y,E)),void 0!==f&&(b=n(f),g=n(c),y=n(h),void 0===l?a(b,g,y):(a(b,g,E=n(d)),a(g,y,E))),void 0!==v&&(b=r(v),g=r(p),y=r(_),void 0===l?o(b,g,y):(o(b,g,E=r(m)),o(g,y,E)))}for(var s=e.split("\n"),l=[],f=[],c=[],h=[],d=[],v=[],p=[],_=0,m=void 0,b=/v( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,g=/vn( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,y=/vt( +[\d|\.|\+|\-|e|E]+)( +[\d|\.|\+|\-|e|E]+)/,E=/f( +-?\d+)( +-?\d+)( +-?\d+)( +-?\d+)?/,M=/f( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+))?/,T=/f( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))( +(-?\d+)\/(-?\d+)\/(-?\d+))?/,x=/f( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))( +(-?\d+)\/\/(-?\d+))?/,w=0;w<s.length;w++){var A=s[w];0!==(A=A.trim()).length&&"#"!==A.charAt(0)&&(null!==(m=b.exec(A))?h.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])):null!==(m=g.exec(A))?d.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])):null!==(m=y.exec(A))?v.push(parseFloat(m[1]),parseFloat(m[2])):null!==(m=E.exec(A))?u(m[1],m[2],m[3],m[4]):null!==(m=M.exec(A))?u(m[2],m[5],m[8],m[11],m[3],m[6],m[9],m[12]):null!==(m=T.exec(A))?u(m[2],m[6],m[10],m[14],m[3],m[7],m[11],m[15],m[4],m[8],m[12],m[16]):null!==(m=x.exec(A))&&u(m[2],m[5],m[8],m[11],void 0,void 0,void 0,void 0,m[3],m[6],m[9],m[12]))}return this._generateMeshes({positions:l,coords:f,normals:c,indices:p})}},{key:"_generateMeshes",value:function(e){var t=e.normals.length>0,r=e.coords.length>0,n=void 0;if(e.positions.length>65535){var i=[],a=0,o={};for(o.positions=e.positions.concat(),o.coords=e.coords.concat(),o.indices=e.indices.concat(),o.normals=e.normals.concat();e.indices.length>0;){for(var u=Math.min(65535,e.positions.length),s=e.indices.splice(0,u),l=[],c=[],h=[],d=void 0,v=0,p=0;p<s.length;p++)s[p]>v&&(v=s[p]),d=s[p],l.push(o.positions[d]),r&&c.push(o.coords[d]),t&&h.push(o.normals[d]),s[p]-=a;a=v+1,(n=new f.default(this._drawType)).bufferVertex(l),r&&n.bufferTexCoord(c),n.bufferIndex(s),t&&n.bufferNormal(h),i.push(n)}return this._callback&&this._callback(i,o),i}return(n=new f.default(this._drawType)).bufferVertex(e.positions),r&&n.bufferTexCoord(e.coords),n.bufferIndex(e.indices),t&&n.bufferNormal(e.normals),this._callback&&this._callback(n,e),n}}]),t}(l.default);c.parse=function(e){return(new c).parseObj(e)},t.default=c},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=n(r(17)),l=n(r(62)),f=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,!0))}return o(t,e),u(t,[{key:"parse",value:function(e){return(0,l.default)(e)}},{key:"_onLoaded",value:function(){var e=this.parse(this._req.response);this._callback&&this._callback(e)}}]),t}(s.default);f.parse=function(e){return(0,l.default)(e)},t.default=f},function(e,t,r){function n(e,t,r,n,i,a){function o(t){var r=0;do{t[r++]=e[n]}while(++n<v&&r<t.length);return r}function u(t,r,i){var a=0;do{t[r+a++]=e[n]}while(++n<v&&a<i);return a}for(var s=new Array(4),l=null,f=void 0,c=void 0,h=void 0,d=new Array(2),v=e.length;a>0;){if(o(s)<s.length)throw new Error("Error reading bytes: expected "+s.length);if(2!==s[0]||2!==s[1]||0!=(128&s[2]))return t[r++]=s[0],t[r++]=s[1],t[r++]=s[2],t[r++]=s[3],void function(e,t,r,n){var i=4*n,a=u(t,r,i);if(a<i)throw new Error("Error reading raw pixels: got "+a+" bytes, expected "+i)}(0,t,r,i*a-1);if(((255&s[2])<<8|255&s[3])!==i)throw new Error("Wrong scanline width "+((255&s[2])<<8|255&s[3])+", expected "+i);null===l&&(l=new Array(4*i)),f=0;for(var p=0;p<4;p++)for(c=(p+1)*i;f<c;){if(o(d)<d.length)throw new Error("Error reading 2-byte buffer");if((255&d[0])>128){if(0==(h=(255&d[0])-128)||h>c-f)throw new Error("Bad scanline data");for(;h-- >0;)l[f++]=d[1]}else{if(0==(h=255&d[0])||h>c-f)throw new Error("Bad scanline data");if(l[f++]=d[1],--h>0){if(u(l,f,h)<h)throw new Error("Error reading non-run data");f+=h}}}for(var _=0;_<i;_++)t[r+0]=l[_],t[r+1]=l[_+i],t[r+2]=l[_+2*i],t[r+3]=l[_+3*i],r+=4;a--}}function i(e){e instanceof ArrayBuffer&&(e=new Uint8Array(e));for(var t=0,r=e.length,i=10,f=0,c=0,h=1,d=!1,v=0;v<20;v++){var p=function(){var n="";do{var a=e[t];if(a===i){++t;break}n+=String.fromCharCode(a)}while(++t<r);return n}(),_=void 0;if(_=p.match(a));else if(_=p.match(s))d=!0;else if(_=p.match(u))h=Number(_[1]);else if(_=p.match(o));else if(_=p.match(l)){c=Number(_[1]),f=Number(_[2]);break}}if(!d)throw new Error("File is not run length encoded!");var m=new Uint8Array(f*c*4);n(e,m,0,t,f,c);for(var b=new Float32Array(f*c*4),g=0;g<m.length;g+=4){var y=m[g+0]/255,E=m[g+1]/255,M=m[g+2]/255,T=m[g+3],x=Math.pow(2,T-128);y*=x,E*=x,M*=x;var w=g;b[w+0]=y,b[w+1]=E,b[w+2]=M,b[w+3]=1}return{shape:[f,c],exposure:h,gamma:1,data:b}}Object.defineProperty(t,"__esModule",{value:!0});var a="#\\?RADIANCE",o="#.*",u="EXPOSURE=\\s*([0-9]*[.][0-9]*)",s="FORMAT=32-bit_rle_rgbe",l="-Y ([0-9]+) \\+X ([0-9]+)";t.default=i},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=n(r(64)),a=n(r(5)),o=function(e){var t={};e.forEach((function(e){var r=e.mesh,n=r.vertices,i=r.normals,o=r.coords,u=r.triangles,s=r.name;if(!t[s]){var l=(new a.default).bufferFlattenData(n,"aVertexPosition",3).bufferFlattenData(o,"aTextureCoord",2).bufferFlattenData(i,"aNormal",3).bufferIndex(u);t[s]=l}e.glMesh=t[s]}))},u={parse:function(e){var t=i.default.parse(e);return o(t),t},load:function(e,t){i.default.load(e,(function(e){o(e),t(e)}))}};t.default=u},function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(65),a=(n=i)&&n.__esModule?n:{default:n},o=r(1),u=function(e){function t(e){var t=void 0;for(var r in n)r===e&&(t=n[r]);var i={};return t.diffuse&&(i.diffuseColor=t.diffuse),i.diffuseColor=t.diffuse||[0,0,0],i.shininess=t.shininess||0,t.textures&&(t.textures.diffuse&&(i.diffuseMapID=t.textures.diffuse.map_id),t.textures.normal&&(i.normalMapID=t.textures.normal.map_id)),i}function r(e,n){var u=o.mat4.create();if(e.model?o.mat4.multiply(u,n,e.model):o.mat4.copy(u,n),e.children.length>0&&e.children.forEach((function(e){r(e,u)})),e.mesh){var s={};s.modelMatrix=u,s.mesh=i[e.mesh],s.id=e.id,s.name=e.name,s.material=t(e.material),a.push(s)}}var n=e.materials,i=e.meshes,a=[];for(var u in i){var s=i[u];s.vertices,s.normals,s.coords,s.triangles}var l=o.mat4.create();return r(e.root,l),a},s=function(e){var t=a.default.parse(e);return u(t)},l={load:function(e,t){a.default.load(e,(function(e){t(u(e))}))},parse:s};t.default=l,e.exports=t.default},function(e,t,r){(function(n){function i(e,t){var r=new XMLHttpRequest;r.onload=function(){this.response,200==this.status&&t&&t(this.response)},r.open("get",e,!0),r.send()}Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),o=void 0===n.document,u=2*Math.PI/360,s={libsPath:"./",workerPath:"./",no_flip:!0,use_transferables:!0,onerror:null,verbose:!1,config:{forceParser:!1},init:function(e){for(var t in e=e||{})this[t]=e[t];if(this.config=e,o)try{importScripts(this.libsPath+"gl-matrix-min.js",this.libsPath+"tinyxml.js")}catch(e){s.throwException(s.LIBMISSING_ERROR)}a.mat4.create(),vec3.create(),vec3.create(),vec3.create(),a.quat.create(),o&&console.log("Collada worker ready")},load:function(e,t){i(e,(function(e){t(e?s.parse(e):null)}))},_xmlroot:null,_nodes_by_id:null,_transferables:null,_controllers_found:null,_geometries_found:null,safeString:function(e){return e?this.convertID?this.convertID(e):e.replace(/ /g,"_"):""},LIBMISSING_ERROR:"Libraries loading error, when using workers remember to pass the URL to the tinyxml.js in the options.libsPath",NOXMLPARSER_ERROR:"TinyXML not found, when using workers remember to pass the URL to the tinyxml.js in the options.libsPath (Workers do not allow to access the native XML DOMParser)",throwException:function(e){throw o?self.postMessage({action:"exception",msg:e}):s.onerror&&s.onerror(e),e},getFilename:function(e){var t=e.lastIndexOf("\\");return-1!=t&&(e=e.substr(t+1)),-1!=(t=e.lastIndexOf("/"))&&(e=e.substr(t+1)),e},last_name:0,generateName:function(e){var t=(e=e||"name_")+this.last_name;return this.last_name++,t},parse:function(e,t,r){r=r||"_dae_"+Date.now()+".dae";var i=null,a=null;if(this._transferables=[],this.verbose&&console.log(" - XML parsing..."),n.DOMParser&&!this.config.forceParser)a=(i=new DOMParser).parseFromString(e,"text/xml"),this.verbose&&console.log(" - XML parsed");else{if(!n.DOMImplementation)return s.throwException(s.NOXMLPARSER_ERROR);try{i=new DOMImplementation}catch(e){return s.throwException(s.NOXMLPARSER_ERROR)}a=i.loadXML(e),this.verbose&&console.log(" - XML parsed");for(var o=a._nodes_by_id={},u=0,l=a.all.length;u<l;++u)o[(p=a.all[u]).id]=p,p.getAttribute("sid")&&(o[p.getAttribute("sid")]=p);this.extra_functions||(this.extra_functions=!0,DOMDocument.prototype.querySelector=DOMElement.prototype.querySelector=function(e){for(var t=e.split(" "),r=this;t.length;){var n=t.shift().split("#"),i=n[0],a=n[1],o=i?r.getElementsByTagName(i):r.childNodes;if(a){for(var u=0;u<o.length;u++)if(o.item(u).getAttribute("id")==a){if(0==t.length)return o.item(u);r=o.item(u);break}}else{if(0==t.length)return o.item(0);r=o.item(0)}}return null},DOMDocument.prototype.querySelectorAll=DOMElement.prototype.querySelectorAll=function(e){function t(e,r){if(r){var i=r.shift(),a=e.getElementsByTagName(i);if(0!=r.length)for(var o=0;o<a.length;o++)t(a.item(o),r.concat());else for(o=0;o<a.length;o++)n.push(a.item(o))}}var r=e.split(" ");if(1==r.length)return this.getElementsByTagName(e);var n=[];t(this,r);var i=new DOMNodeList(this.documentElement);return i._nodes=n,i.length=n.length,i},Object.defineProperty(DOMElement.prototype,"textContent",{get:function(){return this.getChildNodes().item(0).toString()},set:function(){}}))}this._xmlroot=a;var f=a.querySelector("COLLADA");f&&(this._current_DAE_version=f.getAttribute("version"),console.log("DAE Version:"+this._current_DAE_version));var c=a.getElementsByTagName("visual_scene").item(0);if(!c)throw"visual_scene XML node not found in DAE";this._nodes_by_id={},this._controllers_found={},this._geometries_found={};var h={object_type:"SceneTree",light:null,materials:{},meshes:{},resources:{},root:{children:[]},external_files:{}},d=a.getElementsByTagName("asset")[0];d&&(h.metadata=this.readAsset(d));var v=c.childNodes;for(u=0;u<v.length;u++)if("node"==v.item(u).localName){var p;(p=this.readNodeTree(v.item(u),h,0,!1))&&h.root.children.push(p)}for(u=0;u<v.length;u++)"node"==v.item(u).localName&&this.readNodeInfo(v.item(u),h,0,!1);this.readLibraryControllers(h);var _=this.readAnimations(a,h);if(_){var m="#animations_"+r.substr(0,r.indexOf("."));h.resources[m]=_,h.root.animations=m}return h.images=this.readImages(a),this._nodes_by_id={},this._controllers_found={},this._geometries_found={},this._xmlroot=null,h},readAsset:function(e){for(var t={},r=0;r<e.childNodes.length;r++){var n=e.childNodes.item(r);if(1==n.nodeType)switch(n.localName){case"contributor":var i=n.querySelector("authoring_tool");i&&(t.authoring_tool=i.textContext);break;case"unit":t.unit=n.getAttribute("name");break;default:t[n.localName]=n.textContent}}return t},readNodeTree:function(e,t,r,n){var i=this.safeString(e.getAttribute("id")),a=this.safeString(e.getAttribute("sid"));if(!i&&!a)return null;var o={id:a||i,children:[],_depth:r},u=e.getAttribute("type");u&&(o.type=u);var s=e.getAttribute("name");s&&(o.name=s),this._nodes_by_id[o.id]=o,i&&(this._nodes_by_id[i]=o),a&&(this._nodes_by_id[a]=o),o.model=this.readTransform(e,r,n);for(var l=0;l<e.childNodes.length;l++){var f=e.childNodes.item(l);if(1==f.nodeType)if("node"!=f.localName);else{var c=this.readNodeTree(f,t,r+1,n);c&&o.children.push(c)}}return o},readNodeInfo:function(e,t,r,n,i){var a,o=this.safeString(e.getAttribute("id")),u=this.safeString(e.getAttribute("sid"));if(o||u)a=this._nodes_by_id[o||u];else{if(!i)return null;a=this._nodes_by_id[i.id||i.sid]}if(!a)return console.warn("Collada: Node not found by id: "+(o||u)),null;for(var s=0;s<e.childNodes.length;s++){var l=e.childNodes.item(s);if(1==l.nodeType)if("node"!=l.localName){if("instance_geometry"==l.localName){var f=(p=l.getAttribute("url")).toString().substr(1);a.mesh=f,t.meshes[p]||(m=this.readGeometry(p,n))&&(m.name=f,t.meshes[f]=m);var c=l.querySelectorAll("instance_material");if(c)for(var h=0;h<c.length;++h){var d=c.item(h);if(d){var v=d.getAttribute("target").toString().substr(1);t.materials[v]||(M=this.readMaterial(v))&&(M.id=v,t.materials[M.id]=M),0==h?a.material=v:(a.materials||(a.materials=[]),a.materials.push(v))}else console.warn("instance_material not found: "+s)}}if("instance_controller"==l.localName){var p=l.getAttribute("url"),_=this._xmlroot.querySelector("controller"+p);if(_){var m=this.readController(_,n,t),b=l.querySelector("bind_material");if(b)for(var g=b.querySelectorAll("technique_common"),y=0;y<g.length;y++){var E=g.item(y).querySelectorAll("instance_material");for(h=0;h<E.length;h++){var M,T=E.item(h);T?(v=T.getAttribute("target").toString().substr(1),t.materials[v]||(M=this.readMaterial(v))&&(M.id=v,t.materials[M.id]=M),0==h?a.material=v:(a.materials||(a.materials=[]),a.materials.push(v))):console.warn("instance_material for controller not found: "+T)}}if(m){var x=m;"morph"==m.type&&(x=m.mesh,a.morph_targets=m.morph_targets),x.name=p.toString(),a.mesh=p.toString(),t.meshes[p]=x}}}"instance_light"==l.localName&&(p=l.getAttribute("url"),this.readLight(a,p)),"instance_camera"==l.localName&&(p=l.getAttribute("url"),this.readCamera(a,p))}else this.readNodeInfo(l,t,r+1,n,e)}},material_translate_table:{},light_translate_table:{point:"omni",directional:"directional",spot:"spot"},camera_translate_table:{xfov:"fov",aspect_ratio:"aspect",znear:"near",zfar:"far"},querySelectorAndId:function(e,t,r){for(var n=e.querySelectorAll(t),i=0;i<n.length;i++){var a=n.item(i).getAttribute("id");if(a&&(a=a.toString())==r)return n.item(i)}return null},getFirstChildElement:function(e,t){for(var r=e.childNodes,n=0;n<r.length;++n){var i=r.item(n);if(i.localName&&!t||t&&t==i.localName)return i}return null},readMaterial:function(e){var t=this.querySelectorAndId(this._xmlroot,"library_materials material",e);if(!t)return null;var r=t.querySelector("instance_effect");if(!r)return null;var n=r.getAttribute("url").substr(1),i=this.querySelectorAndId(this._xmlroot,"library_effects effect",n);if(!i)return null;var a=i.querySelector("technique");if(!a)return null;for(var o=i.querySelectorAll("newparam"),u={},s=0;s<o.length;s++){var l,f=o[s].querySelector("init_from");l=f?f.innerHTML:o[s].querySelector("source").innerHTML,u[o[s].getAttribute("sid")]={parent:l}}var c={},h=this.readImages(this._xmlroot),d=a.querySelector("phong");if(d||(d=a.querySelector("blinn")),d||(d=a.querySelector("lambert")),!d)return null;for(s=0;s<d.childNodes.length;++s){var v=d.childNodes.item(s);if(v.localName){var p=v.localName.toString();this.material_translate_table[p]&&(p=this.material_translate_table[p]);var _=this.getFirstChildElement(v);if(_)if("color"!=_.localName.toString())if("float"!=_.localName.toString()){if("texture"==_.localName.toString()){c.textures||(c.textures={});var m=_.getAttribute("texture");if(!m)continue;-1===m.indexOf(".")&&h[m=this.getParentParam(u,m)]&&(m=h[m].path);var b={map_id:m},g=_.getAttribute("texcoord");b.uvs=g,c.textures[p]=b}}else c[p]=this.readContentAsFloats(_)[0];else{var y=this.readContentAsFloats(_);"RGB_ZERO"==v.getAttribute("opaque")?c[p]=y.subarray(0,4):c[p]=y.subarray(0,3)}}}return c.object_type="Material",c},getParentParam:function(e,t){return e[t]&&e[t].parent?this.getParentParam(e,e[t].parent):t},readLight:function(e,t){function r(e,t){for(var r=0;r<t.childNodes.length;r++){var n=t.childNodes.item(r);if(n&&1==n.nodeType)switch(n.localName){case"color":e.color=s.readContentAsFloats(n);break;case"falloff_angle":e.angle_end=s.readContentAsFloats(n)[0],e.angle=e.angle_end-10}}}var n={},i=null;if(t.length>1)i=this._xmlroot.querySelector("library_lights "+t);else{var a=this._xmlroot.querySelector("library_lights");i=this.getFirstChildElement(a,"light")}if(!i)return null;var o=[];if(h=i.querySelector("technique_common"))for(var u=0;u<h.childNodes.length;u++)1==h.childNodes.item(u).nodeType&&o.push(h.childNodes.item(u));var l=i.querySelectorAll("technique");for(u=0;u<l.length;u++)for(var f=l.item(u),c=0;c<f.childNodes.length;c++)1==f.childNodes.item(c).nodeType&&o.push(f.childNodes.item(c));for(u=0;u<o.length;u++){var h;switch((h=o[u]).localName){case"point":case"directional":case"spot":n.type=this.light_translate_table[h.localName],r(n,h);break;case"intensity":n.intensity=this.readContentAsFloats(h)[0]}}if(e.model){n.position=[e.model[12],e.model[13],e.model[14]];var d=[-e.model[8],-e.model[9],-e.model[10]];n.target=[n.position[0]+d[0],n.position[1]+d[1],n.position[2]+d[2]]}else console.warn("Could not read light position for light: "+e.name+". Setting defaults."),n.position=[0,0,0],n.target=[0,-1,0];e.light=n},readCamera:function(e,t){var r={},n=this._xmlroot.querySelector("library_cameras "+t);if(!n)return null;var i=[],a=n.querySelector("technique_common");if(a)for(var o=0;o<a.childNodes.length;o++)1==a.childNodes.item(o).nodeType&&i.push(a.childNodes.item(o));for(o=0;o<i.length;o++)!function(e,t){for(var r=0;r<t.childNodes.length;r++){var n=t.childNodes.item(r);n&&1==n.nodeType&&(e[s.camera_translate_table[n.localName]||n.localName]=parseFloat(n.textContent))}}(r,i[o]);r.yfov&&!r.fov&&(r.aspect?r.fov=r.yfov*r.aspect:console.warn("Could not convert camera yfov to xfov because aspect ratio not set")),e.camera=r},readTransform:function(e,t,r){for(var n=a.mat4.create(),i=a.mat4.create(),o=a.quat.create(),s=0;s<e.childNodes.length;s++){var l=e.childNodes.item(s);if(l&&1==l.nodeType){if("matrix"==l.localName)return n=this.readContentAsFloats(l),this.transformMatrix(n,0==t),n;if("translate"!=l.localName)if("rotate"!=l.localName){if("scale"==l.localName){var f=this.readContentAsFloats(l);if(r){var c=f[1];f[1]=f[2],f[2]=-c}a.mat4.scale(n,n,f)}}else 4==(f=this.readContentAsFloats(l)).length&&("jointOrientX"==l.getAttribute("sid")&&(f[3]+=90),r&&(c=f[1],f[1]=f[2],f[2]=-c),0!=f[3]&&(a.quat.setAxisAngle(o,f.subarray(0,3),f[3]*u),a.mat4.fromQuat(i,o),a.mat4.multiply(n,n,i)));else f=this.readContentAsFloats(l),r&&t>0&&(c=f[1],f[1]=f[2],f[2]=-c),a.mat4.translate(n,n,f)}}return n},readTransform2:function(e,t,r){for(var n=a.mat4.create(),i=a.quat.create(),o=a.mat4.create(),s=a.quat.create(),l=vec3.create(),f=vec3.fromValues(1,1,1),c=0;c<e.childNodes.length;c++){var h=e.childNodes.item(c);if("matrix"==h.localName)return n=this.readContentAsFloats(h),this.transformMatrix(n,0==t),n;if("translate"!=h.localName)if("rotate"!=h.localName){if("scale"==h.localName){var d=this.readContentAsFloats(h);if(r){var v=d[1];d[1]=d[2],d[2]=-v}f.set(d)}}else 4==(d=this.readContentAsFloats(h)).length&&("jointOrientX"==h.getAttribute("sid")&&(d[3]+=90),r&&(v=d[1],d[1]=d[2],d[2]=-v),0!=d[3]&&(a.quat.setAxisAngle(s,d.subarray(0,3),d[3]*u),a.quat.multiply(i,i,s)));else d=this.readContentAsFloats(h),l.set(d)}return r&&t>0&&(v=l[1],l[1]=l[2],l[2]=-v),a.mat4.translate(n,n,l),a.mat4.fromQuat(o,i),a.mat4.multiply(n,n,o),a.mat4.scale(n,n,f),n},readGeometry:function(e,t,r){if(void 0!==this._geometries_found[e])return this._geometries_found[e];var n=this._xmlroot.getElementById(e.substr(1));if(!n)return console.warn("readGeometry: geometry not found: "+e),this._geometries_found[e]=null,null;if("controller"==n.localName){var i=this.readController(n,t,r);return this._geometries_found[e]=i,i}if("geometry"!=n.localName)return console.warn("readGeometry: tag should be geometry, instead it was found: "+n.localName),this._geometries_found[e]=null,null;var a=n.querySelector("mesh");if(!a)return console.warn("readGeometry: mesh not found in geometry: "+e),this._geometries_found[e]=null,null;for(var u={},s=a.querySelectorAll("source"),l=0;l<s.length;l++){var f=s.item(l);if(f.querySelector){var c=f.querySelector("float_array");if(c){var h=this.readContentAsFloats(c),d=f.querySelector("accessor"),v=parseInt(d.getAttribute("stride"));u[f.getAttribute("id")]={stride:v,data:h}}}}var p=u[a.querySelector("vertices input").getAttribute("source").substr(1)];u[a.querySelector("vertices").getAttribute("id")]=p;var _=null,m=a.querySelector("polygons");if(m&&(_=this.readTriangles(m,u)),!_){var b=a.querySelectorAll("triangles");b&&b.length&&(_=this.readTriangles(b,u))}if(!_){var g=a.querySelector("polylist");g&&(_=this.readPolylist(g,u))}if(!_){var y=a.querySelector("linestrips");y&&(_=this.readLineStrip(u,y))}if(!_)return console.log("no polygons or triangles in mesh: "+e),this._geometries_found[e]=null,null;if(t&&!this.no_flip){for(var E=0,M=_.vertices,T=(l=0,M.length);l<T;l+=3)E=M[l+1],M[l+1]=M[l+2],M[l+2]=-E;for(l=0,T=(M=_.normals).length;l<T;l+=3)E=M[l+1],M[l+1]=M[l+2],M[l+2]=-E}if(o&&this.use_transferables)for(var l in _){var x=_[l];x&&x.buffer&&x.length>100&&this._transferables.push(x.buffer)}return _.filename=e,_.object_type="Mesh",this._geometries_found[e]=_,_},readTriangles:function(e,t){for(var r=[],n=[],i=0,a={},o=[],u=[],s=0,l="",f=0;f<e.length;f++){var c=e.item(f),h="triangles"==c.localName;l=c.getAttribute("material"),0==f&&(n=this.readShapeInputs(c,t));for(var d=c.querySelectorAll("p"),v=(n.length,0);v<d.length;v++){var p=d.item(v);if(!p||!p.textContent)break;var _=p.textContent.trim().split(" "),m=-1,b=-1,g=-1,y=1;for(var E in n)y=Math.max(y,n[E][4]+1);for(var M=0,T=_.length;M<T;M+=y){var x=_.slice(M,M+y).join(" ");if(g=b,a.hasOwnProperty(x))b=a[x];else{for(var w=0;w<n.length;++w){var A=n[w],R=A[1],P=A[3],O=parseInt(_[M+A[4]]);0==w&&(o[R.length/A[2]]=O),O*=A[2];for(var S=0;S<A[2];++S){if(void 0===P[O+S])throw"UNDEFINED!";R.push(P[O+S])}}b=i,i+=1,a[x]=b}h||(0==M&&(m=b),M>2&&(u.push(m),u.push(g))),u.push(b)}}var L={name:"group"+f,start:s,length:u.length-s,material:l||""};s=u.length,r.push(L)}var N={vertices:new Float32Array(n[0][1]),info:{groups:r},_remap:new Uint32Array(o)};return this.transformMeshInfo(N,n,u),N},readPolylist:function(e,t){var r=[],n=0,i={},a=[],o=[];e.getAttribute("material"),r=this.readShapeInputs(e,t);for(var u=e.querySelector("vcount"),s=this.readContentAsUInt32(u),l=e.querySelector("p"),f=this.readContentAsUInt32(l),c=r.length,h=0,d=0,v=s.length;d<v;++d)for(var p=s[d],_=-1,m=-1,b=-1,g=0;g<p;++g){var y=f.subarray(h,h+c).join(" ");if(b=m,i.hasOwnProperty(y))m=i[y];else{for(var E=0;E<r.length;++E){var M=r[E],T=parseInt(f[h+E]),x=M[1],w=M[3];0==E&&(a[x.length/c]=T),T*=M[2];for(var A=0;A<M[2];++A)x.push(w[T+A])}m=n,n+=1,i[y]=m}p>3&&(0==g&&(_=m),g>2&&(o.push(_),o.push(b))),o.push(m),h+=c}var R={vertices:new Float32Array(r[0][1]),info:{},_remap:new Uint32Array(a)};return this.transformMeshInfo(R,r,o),R},readShapeInputs:function(e,t){for(var r=[],n=e.querySelectorAll("input"),i=0;i<n.length;i++){var a=n.item(i);if(a.getAttribute){var o=a.getAttribute("semantic").toUpperCase(),u=t[a.getAttribute("source").substr(1)],s=parseInt(a.getAttribute("offset")),l=0;a.getAttribute("set")&&(l=parseInt(a.getAttribute("set"))),r.push([o,[],u.stride,u.data,s,l])}}return r},transformMeshInfo:function(e,t,r){for(var n={normal:"normals",texcoord:"coords"},i=1;i<t.length;++i){var a=t[i][0].toLowerCase(),o=t[i][1];o.length&&(n[a]&&(a=n[a]),e[a]&&(a+=t[i][5]),e[a]=new Float32Array(o))}return r&&r.length&&(e.vertices.length>65536?e.triangles=new Uint32Array(r):e.triangles=new Uint16Array(r)),e},readLineStrip:function(e,t){for(var r=[],n=0,i={},a=[],o=[],u=t.querySelectorAll("input"),s=0;s<u.length;s++){var l=u.item(s);if(l.getAttribute){var f=l.getAttribute("semantic").toUpperCase(),c=e[l.getAttribute("source").substr(1)],h=parseInt(l.getAttribute("offset")),d=0;l.getAttribute("set")&&(d=parseInt(l.getAttribute("set"))),r.push([f,[],c.stride,c.data,h,d])}}var v=t.querySelectorAll("p"),p=r.length;for(s=0;s<v.length;s++){var _=v.item(s);if(!_||!_.textContent)break;for(var m=_.textContent.trim().split(" "),b=-1,g=0,y=m.length;g<y;g+=p){var E=m.slice(g,g+p).join(" ");if(i.hasOwnProperty(E))b=i[E];else{for(var M=0;M<r.length;++M){var T=r[M],x=parseInt(m[g+M]),w=T[1],A=T[3];0==M&&(a[w.length/p]=x),x*=T[2];for(var R=0;R<T[2];++R)w.push(A[x+R])}b=n,n+=1,i[E]=b}o.push(b)}}var P={primitive:"line_strip",vertices:new Float32Array(r[0][1]),info:{}};return this.transformMeshInfo(P,r,o)},findXMLNodeById:function(e,t,r){var n;if(this._xmlroot._nodes_by_id){if((n=this._xmlroot._nodes_by_id[r])&&n.localName==t)return n}else if(n=this._xmlroot.getElementById(r))return n;for(var i=e.childNodes,a=0;a<i.length;++a){var o=i.item(a);if(1==o.nodeType&&o.localName==t&&o.getAttribute("id")==r)return o}return null},readImages:function(e){var t=e.querySelector("library_images");if(!t)return null;for(var r={},n=t.childNodes,i=0;i<n.length;++i){var a=n.item(i);if(1==a.nodeType){var o=a.querySelector("init_from");if(o&&o.textContent){var u=this.getFilename(o.textContent),s=a.getAttribute("id");r[s]={filename:u,map:s,name:a.getAttribute("name"),path:o.textContent}}}}return r},readAnimations:function(e,t){var r=e.querySelector("library_animations");if(!r)return null;for(var n=r.childNodes,i={object_type:"Animation",takes:{}},a={tracks:[]},o=a.tracks,u=0;u<n.length;++u){var s=n.item(u);if(1==s.nodeType&&"animation"==s.localName)if(s.getAttribute("id"))this.readAnimation(s,o);else{var l=s.querySelectorAll("animation");if(l.length)for(var f=0;f<l.length;++f){var c=l.item(f);this.readAnimation(c,o)}else this.readAnimation(s,o)}}if(!o.length)return null;var h=0;for(u=0;u<o.length;++u)h<o[u].duration&&(h=o[u].duration);return a.name="default",a.duration=h,i.takes[a.name]=a,i},readAnimation:function(e,t){if("animation"!=e.localName)return null;var r=(e.getAttribute("id"),e.querySelectorAll("channel"));if(!r.length)return null;for(var n=t||[],i=0;i<r.length;++i){var a=this.readChannel(r.item(i),e);a&&n.push(a)}return n},readChannel:function(e,t){if("channel"!=e.localName||"animation"!=t.localName)return null;var r=e.getAttribute("source"),n=e.getAttribute("target"),i=this.findXMLNodeById(t,"sampler",r.substr(1));if(!i)return console.error("Error DAE: Sampler not found in "+r),null;for(var a={},u={},s={},l=i.querySelectorAll("input"),f=null,c=0;c<l.length;c++){var h=l.item(c),d=h.getAttribute("source"),v=h.getAttribute("semantic"),p=this.findXMLNodeById(t,"source",d.substr(1));if(p){var _=p.querySelector("param");if(_){var m=_.getAttribute("type");a[v]={source:d,type:m};var b=null;if("float"==m||"float4x4"==m){var g=p.querySelector("float_array"),y=this.readContentAsFloats(g);s[d]=y,b=y;var E=_.getAttribute("name");"TIME"==E&&(f=b),"OUTPUT"==v&&(E=v),E?u[E]=m:console.warn("Collada: <param> without name attribute in <animation>")}}}}if(!f)return console.error("Error DAE: no TIME info found in <channel>: "+e.getAttribute("source")),null;var M=n.split("/"),T={},x=M[0],w=this._nodes_by_id[x],A=w.id+"/"+M[1];T.name=M[1],T.property=A,m="number";var R=1,P=u.OUTPUT;switch(P){case"float":R=1;break;case"float3x3":R=9,m="mat3";break;case"float4x4":R=16,m="mat4"}T.type=m,T.value_size=R,T.duration=f[f.length-1];var O=s[a.OUTPUT.source];if(!O)return null;var S=f.length,L=R+1,N=new Float32Array(S*L);for(c=0;c<f.length;++c){N[c*L]=f[c];var I=O.subarray(c*R,(c+1)*R);"float4x4"==P&&this.transformMatrix(I,w?0==w._depth:0),N.set(I,c*L+1)}if(o&&this.use_transferables){var k=N;k&&k.buffer&&k.length>100&&this._transferables.push(k.buffer)}return T.data=N,T},findNode:function(e,t){if(e.id==t)return e;if(e.children)for(var r in e.children){var n=this.findNode(e.children[r],t);if(n)return n}return null},readLibraryControllers:function(e){var t=this._xmlroot.querySelector("library_controllers");if(!t)return null;for(var r=t.childNodes,n=0;n<r.length;++n){var i=r.item(n);if(1==i.nodeType&&"controller"==i.localName){var a=i.getAttribute("id");this._controllers_found[a]||this.readController(i,null,e)}}},readController:function(e,t,r){if("controller"==!e.localName)return console.warn("readController: not a controller: "+e.localName),null;var n=e.getAttribute("id");if(this._controllers_found[n])return this._controllers_found[n];var i=null,a=e.querySelector("skin");a&&(i=this.readSkinController(a,t,r));var o=e.querySelector("morph");return o&&(i=this.readMorphController(o,t,r,i)),this._controllers_found[n]?n+="_1blah":this._controllers_found[n]=i,i},readSkinController:function(e,t,r){var n=e.getAttribute("source"),i=this.readGeometry(n,t,r);if(!i)return null;var o=this.readSources(e,t);if(!o)return null;var u=null,s=e.querySelector("bind_shape_matrix");s?(u=this.readContentAsFloats(s),this.transformMatrix(u,!0,!0)):u=a.mat4.create();var l=[],f=e.querySelector("joints");if(f){for(var c=null,h=null,d=f.querySelectorAll("input"),v=0;v<d.length;v++){var p=d[v],_=p.getAttribute("semantic").toUpperCase(),m=o[p.getAttribute("source").substr(1)];"JOINT"==_?c=m:"INV_BIND_MATRIX"==_&&(h=m)}if(!h||!c)return console.error("Error DAE: no joints or inv_bind sources found"),null;for(var v in c){var b=h.subarray(16*v,16*v+16),g=c[v],y=this._nodes_by_id[g];y?(this.transformMatrix(b,0==y._depth,!0),l.push([g,b])):console.warn("Node "+g+" not found")}}var E=e.querySelector("vertex_weights");if(E){var M=null;for(d=E.querySelectorAll("input"),v=0;v<d.length;v++)"WEIGHT"==d[v].getAttribute("semantic").toUpperCase()&&(M=o[d.item(v).getAttribute("source").substr(1)]);if(!M)throw"no weights found";for(var T=E.querySelector("vcount"),x=this.readContentAsUInt32(T),w=E.querySelector("v"),A=this.readContentAsUInt32(w),R=i.vertices.length/3,P=new Float32Array(4*R),O=new Uint8Array(4*R),S=0,L=i._remap,N=0,I=(v=0,x.length);v<I;++v){for(var k=x[v],F=S,C=O.subarray(4*v,4*v+4),D=P.subarray(4*v,4*v+4),B=0,j=0;j<k&&j<4;++j)C[j]=A[F+2*j],C[j]>N&&(N=C[j]),D[j]=M[A[F+2*j+1]],B+=D[j];if(k>4&&B<1){var U=1/B;for(j=0;j<4;++j)D[j]*=U}S+=2*k}var q=new Float32Array(4*R),X=new Uint8Array(4*R),V=[];for(v=0;v<R;++v){for(var G=4*L[v],Y=(D=P.subarray(G,G+4),C=O.subarray(G,G+4),0);Y<3;++Y){var H=Y,W=D[Y];for(j=Y+1;j<4;++j)D[j]<=W||(H=j,W=D[j]);if(H!=Y){var z=D[Y];D[Y]=D[H],D[H]=z,z=C[Y],C[Y]=C[H],C[H]=z}}q.set(D,4*v),X.set(C,4*v),D[0]&&(V[C[0]]=!0),D[1]&&(V[C[1]]=!0),D[2]&&(V[C[2]]=!0),D[3]&&(V[C[3]]=!0)}N>=l.length&&console.warn("Mesh uses higher bone index than bones found");var Z=[],Q={};for(v=0;v<V.length;++v)V[v]&&(Q[v]=Z.length,Z.push(l[v]));if(Z.length<l.length){for(v=0;v<X.length;v++)X[v]=Q[X[v]];l=Z}i.weights=q,i.bone_indices=X,i.bones=l,i.bind_matrix=u}return i},readMorphController:function(e,t,r,n){var i=e.getAttribute("source"),a=this.readGeometry(i,t,r);if(!a)return null;var o=this.readSources(e,t),u=[],s=e.querySelector("targets");if(!s)return null;for(var l=s.querySelectorAll("input"),f=null,c=null,h=0;h<l.length;h++){var d=l.item(h),v=d.getAttribute("semantic").toUpperCase(),p=o[d.getAttribute("source").substr(1)];"MORPH_TARGET"==v?f=p:"MORPH_WEIGHT"==v&&(c=p)}if(!f||!c)return console.warn("Morph controller without targets or weights. Skipping it."),null;for(var h in f){var _="#"+f[h],m=this.readGeometry(_,t,r);r.meshes[_]=m,u.push({mesh:_,weight:c[h]})}return a.morph_targets=u,a},readBindMaterials:function(e,t){for(var r=[],n=e.querySelectorAll("technique_common"),i=0;i<n.length;i++)for(var a=n.item(i).querySelectorAll("instance_material"),o=0;o<a.length;o++){var u=a.item(o);u&&r.push(u.getAttribute("symbol"))}return r},readSources:function(e,t){for(var r={},n=e.querySelectorAll("source"),i=0;i<n.length;i++){var a=n.item(i);if(a.querySelector)if(a.querySelector("float_array")){var o=this.readContentAsFloats(a);r[a.getAttribute("id")]=o}else{var u=a.querySelector("Name_array");if(u){if(!(l=this.readContentAsStringsArray(u)))continue;r[a.getAttribute("id")]=l}else{var s=a.querySelector("IDREF_array");if(s){var l;if(!(l=this.readContentAsStringsArray(s)))continue;r[a.getAttribute("id")]=l}}}}return r},readContentAsUInt32:function(e){if(!e)return null;var t=e.textContent;if(0==(t=(t=t.replace(/\n/gi," ")).trim()).length)return null;for(var r=t.split(" "),n=new Uint32Array(r.length),i=0;i<r.length;i++)n[i]=parseInt(r[i]);return n},readContentAsFloats:function(e){if(!e)return null;for(var t=e.textContent,r=(t=(t=(t=(t=t.replace(/\n/gi," ")).replace(/\s\s+/gi," ")).replace(/\t/gi,"")).trim()).split(" "),n=e.getAttribute("count"),i=n?parseInt(n):r.length,a=new Float32Array(i),o=0;o<r.length;o++)a[o]=parseFloat(r[o]);return a},readContentAsStringsArray:function(e){if(!e)return null;for(var t=e.textContent,r=(t=(t=(t=t.replace(/\n/gi," ")).replace(/\s\s/gi," ")).trim()).split(" "),n=0;n<r.length;n++)r[n]=r[n].trim();if(e.getAttribute("count")&&parseInt(e.getAttribute("count"))!=r.length){var i=[],a="";for(var o in r)a?a+=" "+r[o]:a=r[o],this._nodes_by_id[this.safeString(a)]&&(i.push(this.safeString(a)),a="");var u=parseInt(e.getAttribute("count"));return i.length==u?i:(console.error("Error: bone names have spaces, avoid using spaces in names"),null)}return r},max3d_matrix_0:new Float32Array([0,-1,0,0,0,0,-1,0,1,0,0,-0,0,0,0,1]),transformMatrix:function(e,t,r){if(a.mat4.transpose(e,e),this.no_flip)return e;if(t){var n=new Float32Array(e.subarray(4,8));e.set(e.subarray(8,12),4),e.set(n,8),n=e.subarray(8,12),vec4.scale(n,n,-1)}else{var i=a.mat4.create(),o=e;i.set([o[0],o[2],-o[1]],0),i.set([o[8],o[10],-o[9]],4),i.set([-o[4],-o[6],o[5]],8),i.set([o[12],o[14],-o[13]],12),o.set(i)}return e}};t.default=s,e.exports=t.default}).call(t,r(66))},function(e,t,r){var n,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":i(window))&&(n=window)}e.exports=n},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=(n(r(8)),r(0)),u=n(o),s=n(r(6)),l=n(r(12)),f=function(){function e(t,r){i(this,e),this._width=t||u.default.width,this._height=r||u.default.height,this._params={},this.setSize(t,r),this._mesh=s.default.bigTriangle(),this._passes=[],this._returnTexture}return a(e,[{key:"addPass",value:function(e){if(e.passes)this.addPass(e.passes);else if(e.length)for(var t=0;t<e.length;t++)this._passes.push(e[t]);else this._passes.push(e)}},{key:"render",value:function(e){var t=this,r=e,n=void 0;return this._passes.forEach((function(e){(n=e.hasFbo?e.fbo:t._fboTarget).bind(),u.default.clear(0,0,0,0),e.render(r),u.default.draw(t._mesh),n.unbind(),e.hasFbo?r=e.fbo.getTexture():(t._swap(),r=t._fboCurrent.getTexture())})),this._returnTexture=r,r}},{key:"_swap",value:function(){var e=this._fboCurrent;this._fboCurrent=this._fboTarget,this._fboTarget=e,this._current=this._fboCurrent,this._target=this._fboTarget}},{key:"setSize",value:function(e,t){this._width=e,this._height=t,this._fboCurrent=new l.default(this._width,this._height,this._params),this._fboTarget=new l.default(this._width,this._height,this._params)}},{key:"getTexture",value:function(){return this._returnTexture}},{key:"passes",get:function(){return this._passes}}]),e}();t.default=f},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(34)),s=n(r(36)),l=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:9,r=arguments[1],n=arguments[2],o=arguments[3];i(this,t);var l=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),f=new u.default(e,r,n,o),c=new s.default(e,r,n,o);return l.addPass(f),l.addPass(c),l}return o(t,e),t}(n(r(33)).default);t.default=l},function(e,t){e.exports="// blur5.frag\n// source  : https://github.com/Jam3/glsl-fast-gaussian-blur\n\n#define SHADER_NAME BLUR_5\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform vec2 uDirection;\nuniform vec2 uResolution;\n\nvec4 blur5(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n\tvec4 color = vec4(0.0);\n\tvec2 off1 = vec2(1.3333333333333333) * direction;\n\tcolor += texture2D(image, uv) * 0.29411764705882354;\n\tcolor += texture2D(image, uv + (off1 / resolution)) * 0.35294117647058826;\n\tcolor += texture2D(image, uv - (off1 / resolution)) * 0.35294117647058826;\n\treturn color; \n}\n\n\nvoid main(void) {\n    gl_FragColor = blur5(texture, vTextureCoord, uResolution, uDirection);\n}"},function(e,t){e.exports="// blur9.frag\n// source  : https://github.com/Jam3/glsl-fast-gaussian-blur\n\n#define SHADER_NAME BLUR_9\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform vec2 uDirection;\nuniform vec2 uResolution;\n\nvec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n\tvec4 color = vec4(0.0);\n\tvec2 off1 = vec2(1.3846153846) * direction;\n\tvec2 off2 = vec2(3.2307692308) * direction;\n\tcolor += texture2D(image, uv) * 0.2270270270;\n\tcolor += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;\n\tcolor += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;\n\tcolor += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;\n\tcolor += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;\n\treturn color;\n}\n\n\nvoid main(void) {\n    gl_FragColor = blur9(texture, vTextureCoord, uResolution, uDirection);\n}"},function(e,t){e.exports="// blur13.frag\n// source  : https://github.com/Jam3/glsl-fast-gaussian-blur\n\n#define SHADER_NAME BLUR_13\n\nprecision highp float;\n#define GLSLIFY 1\nvarying vec2 vTextureCoord;\nuniform sampler2D texture;\nuniform vec2 uDirection;\nuniform vec2 uResolution;\n\nvec4 blur13(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {\n\tvec4 color = vec4(0.0);\n\tvec2 off1 = vec2(1.411764705882353) * direction;\n\tvec2 off2 = vec2(3.2941176470588234) * direction;\n\tvec2 off3 = vec2(5.176470588235294) * direction;\n\tcolor += texture2D(image, uv) * 0.1964825501511404;\n\tcolor += texture2D(image, uv + (off1 / resolution)) * 0.2969069646728344;\n\tcolor += texture2D(image, uv - (off1 / resolution)) * 0.2969069646728344;\n\tcolor += texture2D(image, uv + (off2 / resolution)) * 0.09447039785044732;\n\tcolor += texture2D(image, uv - (off2 / resolution)) * 0.09447039785044732;\n\tcolor += texture2D(image, uv + (off3 / resolution)) * 0.010381362401148057;\n\tcolor += texture2D(image, uv - (off3 / resolution)) * 0.010381362401148057;\n\treturn color;\n}\n\n\nvoid main(void) {\n    gl_FragColor = blur13(texture, vTextureCoord, uResolution, uDirection);\n}"},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(0)),s=n(r(8)),l=n(r(37)),f=function(e){function t(){i(this,t);var e=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,l.default));return e.uniform("uResolution",[1/u.default.width,1/u.default.height]),e}return o(t,e),t}(s.default);t.default=f},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(6)),f=n(r(2)),c=n(r(4)),h=r(18),d=r(19),v=function(e){function t(){i(this,t);var e=l.default.bigTriangle(),r=new f.default(h,d),n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return r.bind(),r.uniform("texture","uniform1i",0),n}return o(t,e),u(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(c.default);t.default=v},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=n(r(0)),s=n(r(5)),l=n(r(2)),f=n(r(4)),c=r(75),h=r(76),d=function(e){function t(){i(this,t);var e=[],r=[],n=[0,1,2,3,4,5],o=9999;e.push([-o,0,0]),e.push([o,0,0]),e.push([0,-o,0]),e.push([0,o,0]),e.push([0,0,-o]),e.push([0,0,o]),r.push([1,0,0]),r.push([1,0,0]),r.push([0,1,0]),r.push([0,1,0]),r.push([0,0,1]),r.push([0,0,1]);var f=new s.default(u.default.LINES);f.bufferVertex(e),f.bufferIndex(n),f.bufferData(r,"aColor",3);var d=new l.default(c,h);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,f,d))}return o(t,e),t}(f.default);t.default=d},function(e,t){e.exports="// axis.vert\n\n#define SHADER_NAME BASIC_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec3 aColor;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec3 vColor;\nvarying vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vColor = aColor;\n    vNormal = aNormal;\n}"},function(e,t){e.exports="// axis.frag\n\n#define SHADER_NAME SIMPLE_TEXTURE\n\nprecision lowp float;\n#define GLSLIFY 1\nvarying vec3 vColor;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\t// vec3 color = vNormal;\n\tvec3 color = vColor + vNormal * 0.0001;\n    gl_FragColor = vec4(color, 1.0);\n}"},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(6)),f=n(r(2)),c=n(r(4)),h=r(30),d=r(9),v=function(e){function t(){i(this,t);var e=l.default.sphere(1,24),r=new f.default(h,d);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return o(t,e),u(t,[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.shader.bind(),this.shader.uniform("position","uniform3fv",e),this.shader.uniform("scale","uniform3fv",r),this.shader.uniform("color","uniform3fv",n),this.shader.uniform("opacity","uniform1f",i),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(c.default);t.default=v},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(0)),f=n(r(5)),c=n(r(2)),h=n(r(4)),d=r(79),v=r(9),p=function(e){function t(){i(this,t);var e=[],r=[],n=0,o=void 0,u=void 0;for(o=-100;o<100;o+=1)for(u=-100;u<100;u+=1)e.push([o,u,0]),r.push(n),n++,e.push([o,0,u]),r.push(n),n++;var s=new f.default(l.default.POINTS);s.bufferVertex(e),s.bufferIndex(r);var h=new c.default(d,v),p=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,s,h));return p.color=[1,1,1],p.opacity=.5,p}return o(t,e),u(t,[{key:"draw",value:function(){this.shader.bind(),this.shader.uniform("color","uniform3fv",this.color),this.shader.uniform("opacity","uniform1f",this.opacity),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(h.default);t.default=p},function(e,t){e.exports="// basic.vert\n\n#define SHADER_NAME DOTS_PLANE_VERTEX\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = uProjectionMatrix * uViewMatrix * uModelMatrix * vec4(aVertexPosition + aNormal * 0.000001, 1.0);\n    gl_PointSize = 1.0;\n    vNormal = aNormal;\n}"},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(0)),f=n(r(5)),c=n(r(2)),h=n(r(4)),d=r(10),v=r(9),p=function(e){function t(){i(this,t);var e=[],r=[0,1],n=[[0,0],[1,1]];e.push([0,0,0]),e.push([0,0,0]);var o=new f.default(l.default.LINES);o.bufferVertex(e),o.bufferTexCoord(n),o.bufferIndex(r);var u=new c.default(d,v);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o,u))}return o(t,e),u(t,[{key:"draw",value:function(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this._mesh.bufferVertex([e,r]),this._shader.bind(),this._shader.uniform("color","vec3",n),this._shader.uniform("opacity","float",i),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(h.default);t.default=p},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(6)),f=n(r(2)),c=n(r(4)),h=r(31),d=r(32),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;i(this,t);var r=l.default.skybox(e),n=new f.default(h,d);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,n))}return o(t,e),u(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(c.default);t.default=v},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(6)),f=n(r(2)),c=n(r(4)),h=r(83),d=r(19),v=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24;i(this,t);var n=l.default.sphere(e,r,!0),o=new f.default(h,d);return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,n,o))}return o(t,e),u(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(c.default);t.default=v},function(e,t){e.exports="// sky.vert\n\nprecision highp float;\n#define GLSLIFY 1\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec3 aNormal;\n\nuniform mat4 uModelMatrix;\nuniform mat4 uViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec3 vNormal;\n\nvoid main(void) {\n\tmat4 matView = uViewMatrix;\n\tmatView[3][0] = 0.0;\n\tmatView[3][1] = 0.0;\n\tmatView[3][2] = 0.0;\n\t\n    gl_Position = uProjectionMatrix * matView * uModelMatrix * vec4(aVertexPosition, 1.0);\n    vTextureCoord = aTextureCoord;\n    vNormal = aNormal;\n}"},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,r,n)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(n):void 0},l=n(r(0)),f=n(r(6)),c=n(r(2)),h=n(r(4)),d=r(18),v=r(37),p=function(e){function t(){i(this,t);var e=f.default.bigTriangle(),r=new c.default(d,v),n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return r.bind(),r.uniform("texture","uniform1i",0),n}return o(t,e),u(t,[{key:"draw",value:function(e){this.shader.bind(),e.bind(0),this.shader.uniform("uResolution","vec2",[1/l.default.width,1/l.default.height]),s(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"draw",this).call(this)}}]),t}(h.default);t.default=p},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=n(r(7)),u=n(r(0)),s=n(r(16)),l=n(r(27)),f=n(r(26)),c=function(){function e(){var t=this;i(this,e),this._children=[],this._matrixIdentity=mat4.create(),u.default.enableAlphaBlending(),this._init(),this._initTextures(),this._initViews(),this._efIndex=o.default.addEF((function(){return t._loop()})),window.addEventListener("resize",(function(){return t.resize()}))}return a(e,[{key:"update",value:function(){}},{key:"render",value:function(){}},{key:"stop",value:function(){-1!==this._efIndex&&(this._efIndex=o.default.removeEF(this._efIndex))}},{key:"start",value:function(){var e=this;-1===this._efIndex&&(this._efIndex=o.default.addEF((function(){return e._loop()})))}},{key:"resize",value:function(){u.default.setSize(window.innerWidth,window.innerHeight),this.camera.setAspectRatio(u.default.aspectRatio)}},{key:"addChild",value:function(e){this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);-1!=t?this._children.splice(t,1):console.warn("Child no exist")}},{key:"_initTextures",value:function(){}},{key:"_initViews",value:function(){}},{key:"_renderChildren",value:function(){for(var e=0;e<this._children.length;e++)this._children[e].toRender();u.default.rotate(this._matrixIdentity)}},{key:"_init",value:function(){this.camera=new s.default,this.camera.setPerspective(45*Math.PI/180,u.default.aspectRatio,.1,100),this.orbitalControl=new f.default(this.camera,window,15),this.orbitalControl.radius.value=10,this.cameraOrtho=new l.default}},{key:"_loop",value:function(){u.default.viewport(0,0,u.default.width,u.default.height),u.default.setMatrices(this.camera),this.update(),this._renderChildren(),this.render()}}]),e}();t.default=c},function(e,t,r){function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(2),u=(i=o)&&i.__esModule?i:{default:i},s=function(){function e(t,r){n(this,e),this.shader=new u.default(t,r),this._init()}return a(e,[{key:"_init",value:function(){}},{key:"render",value:function(){}}]),e}();t.default=s},function(e,t,r){function n(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=n(r(28)),l=n(r(2)),f=n(r(0)),c=function(e){function t(e,r){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n._children=[],n.shader=new l.default(e,r),n._init(),n._matrixTemp=mat4.create(),n}return o(t,e),u(t,[{key:"_init",value:function(){}},{key:"addChild",value:function(e){this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);-1!=t?this._children.splice(t,1):console.warn("Child no exist")}},{key:"toRender",value:function(e){void 0===e&&(e=mat4.create()),mat4.mul(this._matrixTemp,e,this.matrix),f.default.rotate(this._matrixTemp),this.render();for(var t=0;t<this._children.length;t++)this._children[t].toRender(this.matrix)}},{key:"render",value:function(){}}]),t}(s.default);t.default=c}]);let f=window,c=60,h=performance.now(),d=0,v=0,p=h;const _=[],m=[],b=[],g=[];let y=[],E=[],M=-1,T=0;function x(){!function(){let e,t=0,r=1e3/c,n=0;for(t=0;t<_.length;t++)e=_[t],null!=e&&e.func(e.args);for(;y.length>0;)e=y.pop(),e.func(e.args);let i=performance.now();for(v=(i-h)/1e3,d=i-p,t=0;t<m.length;t++)e=m[t],i-e.time>e.delay&&(e.func(e.args),m.splice(t,1));for(i=performance.now();b.length>0;){if(e=b.shift(),n=performance.now(),!(n-i<r)){b.unshift(e);break}e.func(e.args)}for(i=performance.now();g.length>0;)e=g.shift(),n=performance.now(),n-i<r&&e.func(e.args);p=i,y=y.concat(E),E=[]}(),M=f.requestAnimationFrame(x)}x();var w=function(e,t){const r=++T;return _[r]={func:e,args:t},r},A=function(e){return void 0!==_[e]&&(_[e]=null),-1},R=function(){return v},P=6;let O;const S=e=>{O=e.map((({id:e,file:t,type:r})=>{const n=t;let i;switch(r){case"jpg":case"png":i=new l.exports.GLTexture(t);break;case"text":i=l.exports.parseObj(t)}return{id:e,source:n,type:r,file:i}})),console.table(O)},L=e=>{const t=O.find((t=>t.id===e));return t?t.file:null},N=[{id:"wensday",url:"assets/wensday.jpg",type:"jpg"},{id:"wensdayBig",url:"assets/wensdayBig.jpg",type:"jpg"}];var I=e.EventEmitter;function k(){I.call(this),this.setMaxListeners(20)}k.prototype=Object.create(I.prototype),k.prototype.constructor=k,k.prototype.off=function(e,t){return t?this.removeListener(e,t):e?this.removeAllListeners(e):this.removeAllListeners()};var F=k,C=function(){try{return!!new Blob}catch(e){return!1}}(),D={mbs:0,secs:0,update:function(e,t,r,n){var i,a=e.getAllResponseHeaders();if(a){var o=a.match(/content-length: (\d+)/i);o&&o.length&&(i=o[1])}if(i){var u=(i=parseInt(i,10))/1024/1024,s=(Date.now()-t)/1e3;this.secs+=s,this.mbs+=u,n&&this.log(r,u,s)}else n&&console.warn.call(console,"Can't get Content-Length:",r)},log:function(e,t,r){if(e){var n="File loaded: "+e.substr(e.lastIndexOf("/")+1)+" size:"+t.toFixed(2)+"mb time:"+r.toFixed(2)+"s speed:"+(t/r).toFixed(2)+"mbps";console.log.call(console,n)}var i="Total loaded: "+this.mbs.toFixed(2)+"mb time:"+this.secs.toFixed(2)+"s speed:"+this.getMbps().toFixed(2)+"mbps";console.log.call(console,i)},getMbps:function(){return this.mbs/this.secs}},B=F,j=C,U=D,q=F,X=function(e){var t,r,n,i,a,o,u=e.id,s=e.basePath||"",l=e.url,f=e.type,c=e.crossOrigin,h=e.isTouchLocked,d=e.blob&&j,v=e.webAudioContext,p=e.log,_=function(e){e&&(o={id:u,file:e,type:f},t.emit("progress",1),t.emit("complete",o,u,f),N())},m=function(e,t){r=t||g,(n=new XMLHttpRequest).open("GET",s+l,!0),n.responseType=e,n.addEventListener("progress",b),n.addEventListener("load",r),n.addEventListener("error",L),n.send()},b=function(e){e.lengthComputable&&t.emit("progress",e.loaded/e.total)},g=function(){y()&&_(n.response)},y=function(){return n&&n.status<400?(U.update(n,i,l,p),!0):(L(n&&n.statusText),!1)},E=function(){m("json",(function(){if(y()){var e=n.response;"string"==typeof e&&(e=JSON.parse(e)),_(e)}}))},M=function(){d?w():T()},T=function(){n=new Image,c&&(n.crossOrigin="anonymous"),n.addEventListener("error",L,!1),n.addEventListener("load",x,!1),n.src=s+l},x=function(e){window.clearTimeout(a),e||!n.error&&n.readyState?_(n):L()},w=function(){m("blob",(function(){y()&&((n=new Image).addEventListener("error",L,!1),n.addEventListener("load",A,!1),n.src=window.URL.createObjectURL(n.response))}))},A=function(){window.URL.revokeObjectURL(n.src),_(n)},R=function(){v?O():S("audio")},P=function(){d?m("blob"):S("video")},O=function(){m("arraybuffer",(function(){y()&&v.decodeAudioData(n.response,(function(e){n=null,_(e)}),(function(e){L(e)}))}))},S=function(e){n=document.createElement(e),h||(window.clearTimeout(a),a=window.setTimeout(x,2e3),n.addEventListener("canplaythrough",x,!1)),n.addEventListener("error",L,!1),n.preload="auto",n.src=s+l,n.load(),h&&_(n)},L=function(e){window.clearTimeout(a);var r=e;if(n&&n.tagName&&n.error){r="MediaError: "+["","ABORTED","NETWORK","DECODE","SRC_NOT_SUPPORTED"][n.error.code]+" "+n.src}else n&&n.statusText?r=n.statusText:e&&e.message?r=e.message:e&&e.type&&(r=e.type);t.emit("error",'Error loading "'+s+l+'" '+r),I()},N=function(){t.off("error"),t.off("progress"),t.off("complete"),n&&(n.removeEventListener("progress",b),n.removeEventListener("load",r),n.removeEventListener("error",L),n.removeEventListener("load",x),n.removeEventListener("canplaythrough",x),n.removeEventListener("load",A))},I=function(){N(),n&&n.abort&&n.readyState<4&&n.abort(),n=null,v=null,o=null,window.clearTimeout(a),t.emit("destroy",u)};return t=Object.create(B.prototype,{_events:{value:{}},id:{value:e.id},start:{value:function(){switch(i=Date.now(),f){case"json":E();break;case"jpg":case"png":case"gif":case"webp":case"svg":M();break;case"mp3":case"ogg":case"opus":case"wav":case"m4a":R();break;case"ogv":case"mp4":case"webm":case"hls":P();break;case"bin":case"binary":m("arraybuffer");break;case"txt":case"text":m("text");break;default:throw"AssetsLoader ERROR: Unknown type for file with URL: "+s+l+" ("+f+")"}}},loaded:{get:function(){return!!o}},file:{get:function(){return o}},destroy:{value:I}})},V=0,G=function e(t){var r,n={},i=[],a=[],o=0,u=0,s={},l=function(n){return Array.isArray(n)?(n.forEach(l),r):((i=!!n.assets&&Array.isArray(n.assets)?e(c(n,t)):X(c(n,t))).once("destroy",p),a.push(i),s[i.id]=i,r);var i},f=function(e){return arguments.length?n[e]?n[e]:s[e]:i},c=function(e,t){"string"==typeof e&&(e={url:e});return void 0===e.isTouchLocked&&(e.isTouchLocked=t.isTouchLocked),void 0===e.blob&&(e.blob=t.blob),void 0===e.basePath&&(e.basePath=t.basePath),e.id=e.id||e.url||String(++V),e.type=e.type||function(e){return e&&e.split("?")[0].split(".").pop().toLowerCase()}(e.url),e.crossOrigin=e.crossOrigin||t.crossOrigin,e.webAudioContext=e.webAudioContext||t.webAudioContext,e.log=t.log,e},h=function(e){var t=o+e;r.emit("progress",t/u)},d=function(e,t,a){Array.isArray(e)&&(e={id:t,file:e,type:a}),o++,r.emit("progress",o/u),n[e.id]=e.file,i.push(e),r.emit("childcomplete",e),_()},v=function(e){u--,r.listeners("error").length?r.emit("error",e):console.error(e),_()},p=function(e){s[e]=null,delete s[e],n[e]=null,delete n[e],i.some((function(t,r){if(t.id===e)return i.splice(r,1),!0}))},_=function(){o>=u&&r.emit("complete",i,n,t.id,"group")};return r=Object.create(q.prototype,{_events:{value:{}},id:{get:function(){return t.id}},add:{value:l},start:{value:function(){return u=a.length,a.forEach((function(e){e.on("progress",h).once("complete",d).once("error",v).start()})),a=[],r}},get:{value:f},find:{value:function(e){if(f(e))return f(e);var t=null;return Object.keys(s).some((function(r){return!!(t=s[r].find&&s[r].find(e))})),t}},getLoader:{value:function(e){return s[e]}},loaded:{get:function(){return o>=u}},file:{get:function(){return i}},destroy:{value:function(){for(;a.length;)a.pop().destroy();return r.off("error"),r.off("progress"),r.off("complete"),i=[],n={},t.webAudioContext=null,u=0,o=0,Object.keys(s).forEach((function(e){s[e].destroy()})),s={},r.emit("destroy",r.id),r}}}),t=c(t||{},{basePath:"",blob:!1,touchLocked:!1,crossOrigin:null,webAudioContext:null,log:!1}),Array.isArray(t.assets)&&l(t.assets),r};G.stats=D;var Y=G;const H=e=>{console.error(e)},W=(e,t)=>void 0===e?fxrand():void 0===t?fxrand()*e:e+(t-e)*fxrand(),z=Math.PI/180;class Z{constructor(){this._center=[0,0];const e=.015;this._waveFront=new l.exports.EaseNumber(0,.0075),this._waveHeight=new l.exports.EaseNumber(0,e),this._waveLength=new l.exports.EaseNumber(0,e)}reset(){const e=.25;this._center=[W(e,1-e),W(e,1-e)],this._waveFront.setTo(0),this._waveHeight.setTo(W(1,1.5)),this._waveLength.setTo(W(1,1.5)),this._waveFront.value=W(.5,1),this._waveHeight.value=0,this._waveLength.value=0,setTimeout((()=>this.reset()),W(8e3,4e3))}get center(){return this._center}get wave(){return[this._waveFront.value,this._waveHeight.value,this._waveLength.value]}get waveFront(){return this._waveFront.value}get waveHeight(){return this._waveHeight.value}get waveLength(){return this._waveLength.value}}let Q,K,J,$;const ee=W();class te extends l.exports.Draw{constructor(){super();const e=l.exports.Geom.plane(12,12,200,"xz");this.setMesh(e).useProgram(n,i)}}const re="loaded";class ne extends e{constructor(){var e;super(),this.canvas=document.createElement("canvas"),l.exports.GL.init(this.canvas,{alpha:!0,preserveDrawingBuffer:!0}),this._isPlaying=!1,this._efIndex=w((()=>this._loop())),new Promise(((t,r)=>{const n=document.body.querySelector(".Loading-Bar");console.log("Load Assets",N),N.length>0?(document.body.classList.add("isLoading"),new Y({assets:N}).on("error",(e=>{console.log("Error :",e)})).on("progress",(e=>{n&&(n.style.width=100*e+"%")})).on("complete",(r=>{n&&(n.style.width="100%"),S(r),setTimeout((()=>{document.body.classList.remove("isLoading"),t(e)}),500)})).start()):t(e)})).then((()=>this._onAssetsLoaded()),H)}_onAssetsLoaded(){console.log("Assets loaded"),this._initWorld(),this.emit("loaded")}_initWorld(){this._camera=new l.exports.CameraPerspective,this._camera.setPerspective(70*z,l.exports.GL.aspectRatio,.1,50),this._orbitalControl=new l.exports.OrbitalControl(this._camera,window,4),this._orbitalControl.rx.value=Math.PI/2,this._orbitalControl.lock(),this._dCopy=new l.exports.DrawCopy,this._dAxis=new l.exports.DrawAxis,this._dPlane=new te,this._textureText=L("wensday");let e=P;for(this._ripples=[];e--;){const e=new Z;setTimeout((()=>{e.reset()}),W(5e3)),this._ripples.push(e)}this._isPlaying=!0}play(){this._isPlaying=!0}pause(){this._isPlaying=!1}_loop(){this._isPlaying&&(this._update(),this._render())}_update(){const{heightMap:e,normalMap:n}=(e=>{if(!Q){const e=t.replace("${NUM}",P),n=l.exports.GL.FLOAT;Q=new l.exports.FrameBuffer(2048,2048,{type:n}),K=new l.exports.FrameBuffer(2048,2048,{type:n}),J=(new l.exports.Draw).setMesh(l.exports.Geom.bigTriangle()).useProgram(l.exports.ShaderLibs.bigTriangleVert,e).setClearColor(0,0,0,1).bindFrameBuffer(Q).uniform("uSeed",ee).draw(),$=(new l.exports.Draw).setMesh(l.exports.Geom.bigTriangle()).useProgram(l.exports.ShaderLibs.bigTriangleVert,r).setClearColor(0,0,0,1).bindFrameBuffer(K).bindTexture("texture",Q.texture,0).uniform("uHeight",.15)}let n=[],i=[];return e.forEach((({center:e,wave:t})=>{n=n.concat(e),i=i.concat(t)})),J.uniform("uCenter","vec2",n).uniform("uWave","vec3",i).uniform("uTime",.1*R()).bindFrameBuffer(Q).draw(),$.bindTexture("texture",Q.texture,0).draw(),{heightMap:Q.texture,normalMap:K.texture}})(this._ripples);this._textureHeight=e,this._textureNormal=n}_render(){let e=245/255;l.exports.GL.viewport(0,0,l.exports.GL.width,l.exports.GL.height),l.exports.GL.clear(e,e,e,1),l.exports.GL.setMatrices(this._camera),this._dPlane.bindTexture("uHeightMap",this._textureHeight,0).bindTexture("uNormalMap",this._textureNormal,1).bindTexture("uTextMap",this._textureText,2).draw()}resize(e,t){l.exports.GL.setSize(e,t),this._camera&&this._camera.setPerspective(70*z,l.exports.GL.aspectRatio,.1,50)}destroy(){A(this._efIndex)}}export{re as LOADED,ne as default};
